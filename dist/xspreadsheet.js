!function(t){var e={};function r(n){if(e[n])return e[n].exports;var o=e[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}r.m=t,r.c=e,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)r.d(n,o,function(e){return t[e]}.bind(null,o));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=4)}([function(t,e){},function(t,e,r){(function(e){var r=void 0!==e&&e.pid?e.pid.toString(36):"";function n(){var t=Date.now(),e=n.last||t;return n.last=t>e?t:e+1}t.exports=t.exports.default=function(t,e){return(t||"")+""+r+n().toString(36)+(e||"")},t.exports.process=function(t,e){return(t||"")+r+n().toString(36)+(e||"")},t.exports.time=function(t,e){return(t||"")+n().toString(36)+(e||"")}}).call(this,r(2))},function(t,e){var r,n,o=t.exports={};function i(){throw new Error("setTimeout has not been defined")}function c(){throw new Error("clearTimeout has not been defined")}function a(t){if(r===setTimeout)return setTimeout(t,0);if((r===i||!r)&&setTimeout)return r=setTimeout,setTimeout(t,0);try{return r(t,0)}catch(e){try{return r.call(null,t,0)}catch(e){return r.call(this,t,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:i}catch(t){r=i}try{n="function"==typeof clearTimeout?clearTimeout:c}catch(t){n=c}}();var l,u=[],f=!1,s=-1;function h(){f&&l&&(f=!1,l.length?u=l.concat(u):s=-1,u.length&&p())}function p(){if(!f){var t=a(h);f=!0;for(var e=u.length;e;){for(l=u,u=[];++s<e;)l&&l[s].run();s=-1,e=u.length}l=null,f=!1,function(t){if(n===clearTimeout)return clearTimeout(t);if((n===c||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(t);try{n(t)}catch(e){try{return n.call(null,t)}catch(e){return n.call(this,t)}}}(t)}}function y(t,e){this.fun=t,this.array=e}function d(){}o.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)e[r-1]=arguments[r];u.push(new y(t,e)),1!==u.length||f||a(p)},y.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=d,o.addListener=d,o.once=d,o.off=d,o.removeListener=d,o.removeAllListeners=d,o.emit=d,o.prependListener=d,o.prependOnceListener=d,o.listeners=function(t){return[]},o.binding=function(t){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(t){throw new Error("process.chdir is not supported")},o.umask=function(){return 0}},function(t,e,r){},function(t,e,r){"use strict";function n(t){return function(t){if(Array.isArray(t))return t}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return o(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return o(t,e)}(t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function c(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}r.r(e),r.d(e,"spreadsheet",(function(){return zp}));var a=function(){function t(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";i(this,t),"string"==typeof e?(this.el=document.createElement(e),this.el.className=r):this.el=e,this.data={}}var e,r,o;return e=t,(r=[{key:"data",value:function(t,e){return void 0!==e?(this.data[t]=e,this):this.data[t]}},{key:"on",value:function(t,e){var r=n(t.split(".")),o=r[0],i=r.slice(1),c=o;return"mousewheel"===c&&/Firefox/i.test(window.navigator.userAgent)&&(c="DOMMouseScroll"),this.el.addEventListener(c,(function(t){e(t);for(var r=0;r<i.length;r+=1){var n=i[r];if("left"===n&&0!==t.button)return;if("right"===n&&2!==t.button)return;"stop"===n&&t.stopPropagation()}})),this}},{key:"offset",value:function(t){var e=this;if(void 0!==t)return Object.keys(t).forEach((function(r){e.css(r,"".concat(t[r],"px"))})),this;var r=this.el;return{top:r.offsetTop,left:r.offsetLeft,height:r.offsetHeight,width:r.offsetWidth}}},{key:"scroll",value:function(t){var e=this.el;return void 0!==t&&(void 0!==t.left&&(e.scrollLeft=t.left),void 0!==t.top&&(e.scrollTop=t.top)),{left:e.scrollLeft,top:e.scrollTop}}},{key:"box",value:function(){return this.el.getBoundingClientRect()}},{key:"parent",value:function(){return new t(this.el.parentNode)}},{key:"children",value:function(){for(var t=this,e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return 0===arguments.length?this.el.childNodes:(r.forEach((function(e){return t.child(e)})),this)}},{key:"removeChild",value:function(t){this.el.removeChild(t)}},{key:"child",value:function(e){var r=e;return"string"==typeof e?r=document.createTextNode(e):e instanceof t&&(r=e.el),this.el.appendChild(r),this}},{key:"contains",value:function(t){return this.el.contains(t)}},{key:"className",value:function(t){return void 0!==t?(this.el.className=t,this):this.el.className}},{key:"addClass",value:function(t){return this.el.classList.add(t),this}},{key:"hasClass",value:function(t){return this.el.classList.contains(t)}},{key:"removeClass",value:function(t){return this.el.classList.remove(t),this}},{key:"toggle",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"active";return this.toggleClass(t)}},{key:"toggleClass",value:function(t){return this.el.classList.toggle(t)}},{key:"active",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"active";return t?this.addClass(e):this.removeClass(e),this}},{key:"checked",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this.active(t,"checked"),this}},{key:"disabled",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return t?this.addClass("disabled"):this.removeClass("disabled"),this}},{key:"attr",value:function(t,e){var r=this;if(void 0!==e)this.el.setAttribute(t,e);else{if("string"==typeof t)return this.el.getAttribute(t);Object.keys(t).forEach((function(e){r.el.setAttribute(e,t[e])}))}return this}},{key:"removeAttr",value:function(t){return this.el.removeAttribute(t),this}},{key:"html",value:function(t){return void 0!==t?(this.el.innerHTML=t,this):this.el.innerHTML}},{key:"val",value:function(t){return void 0!==t?(this.el.value=t,this):this.el.value}},{key:"focus",value:function(){this.el.focus()}},{key:"cssRemoveKeys",value:function(){for(var t=this,e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return r.forEach((function(e){return t.el.style.removeProperty(e)})),this}},{key:"css",value:function(t,e){var r=this;return void 0===e&&"string"!=typeof t?(Object.keys(t).forEach((function(e){r.el.style[e]=t[e]})),this):void 0!==e?(this.el.style[t]=e,this):this.el.style[t]}},{key:"computedStyle",value:function(){return window.getComputedStyle(this.el,null)}},{key:"show",value:function(){return this.css("display","block"),this}},{key:"hide",value:function(){return this.css("display","none"),this}}])&&c(e.prototype,r),o&&c(e,o),Object.defineProperty(e,"prototype",{writable:!1}),t}(),l=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return new a(t,e)};r(0);function u(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null==r)return;var n,o,i=[],c=!0,a=!1;try{for(r=r.call(t);!(c=(n=r.next()).done)&&(i.push(n.value),!e||i.length!==e);c=!0);}catch(t){a=!0,o=t}finally{try{c||null==r.return||r.return()}finally{if(a)throw o}}return i}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return f(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return f(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function f(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}var s=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"];function h(t){for(var e="",r=t;r>=s.length;)r/=s.length,r-=1,e+=s[parseInt(r,10)%s.length];return e+=s[t%s.length]}function p(t){for(var e=0,r=0;r!==t.length;++r)e=26*e+t.charCodeAt(r)-64;return e-1}function y(t){for(var e="",r="",n=0;n<t.length;n+=1)t.charAt(n)>="0"&&t.charAt(n)<="9"?r+=t.charAt(n):e+=t.charAt(n);return[p(e),parseInt(r,10)-1]}function d(t,e){return"".concat(h(t)).concat(e+1)}function v(t,e,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(){return!0};if(0===e&&0===r)return t;var o=y(t),i=u(o,2),c=i[0],a=i[1];return n(c,a)?d(c+e,a+r):t}function b(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null==r)return;var n,o,i=[],c=!0,a=!1;try{for(r=r.call(t);!(c=(n=r.next()).done)&&(i.push(n.value),!e||i.length!==e);c=!0);}catch(t){a=!0,o=t}finally{try{c||null==r.return||r.return()}finally{if(a)throw o}}return i}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return m(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return m(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function m(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function g(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function w(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var O=function(){function t(e,r,n,o){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,c=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;g(this,t),this.sri=e,this.sci=r,this.eri=n,this.eci=o,this.w=i,this.h=c}var e,r,n;return e=t,n=[{key:"valueOf",value:function(e){var r=e.split(":"),n=b(y(r[0]),2),o=n[0],i=n[1],c=i,a=o;if(r.length>1){var l=b(y(r[1]),2);a=l[0],c=l[1]}return new t(i,o,c,a)}}],(r=[{key:"set",value:function(t,e,r,n){this.sri=t,this.sci=e,this.eri=r,this.eci=n}},{key:"multiple",value:function(){return this.eri-this.sri>0||this.eci-this.sci>0}},{key:"includes",value:function(){for(var t=0,e=0,r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];if(1===n.length){var i=y(n[0]),c=b(i,2);e=c[0],t=c[1]}else 2===n.length&&(t=n[0],e=n[1]);var a=this.sri,l=this.sci,u=this.eri,f=this.eci;return a<=t&&t<=u&&l<=e&&e<=f}},{key:"each",value:function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){return!0},r=this.sri,n=this.sci,o=this.eri,i=this.eci,c=r;c<=o;c+=1)if(e(c))for(var a=n;a<=i;a+=1)t(c,a)}},{key:"contains",value:function(t){return this.sri<=t.sri&&this.sci<=t.sci&&this.eri>=t.eri&&this.eci>=t.eci}},{key:"within",value:function(t){return this.sri>=t.sri&&this.sci>=t.sci&&this.eri<=t.eri&&this.eci<=t.eci}},{key:"disjoint",value:function(t){return this.sri>t.eri||this.sci>t.eci||t.sri>this.eri||t.sci>this.eci}},{key:"intersects",value:function(t){return this.sri<=t.eri&&this.sci<=t.eci&&t.sri<=this.eri&&t.sci<=this.eci}},{key:"union",value:function(e){var r=this.sri,n=this.sci,o=this.eri,i=this.eci;return new t(e.sri<r?e.sri:r,e.sci<n?e.sci:n,e.eri>o?e.eri:o,e.eci>i?e.eci:i)}},{key:"difference",value:function(e){var r=[],n=function(e,n,o,i){r.push(new t(e,n,o,i))},o=this.sri,i=this.sci,c=this.eri,a=this.eci,l=e.sri-o,u=e.sci-i,f=c-e.eri,s=a-e.eci;return l>0?(n(o,i,e.sri-1,a),f>0?(n(e.eri+1,i,c,a),u>0&&n(e.sri,i,e.eri,e.sci-1),s>0&&n(e.sri,e.eci+1,e.eri,a)):(u>0&&n(e.sri,i,c,e.sci-1),s>0&&n(e.sri,e.eci+1,c,a))):f>0&&(n(e.eri+1,i,c,a),u>0&&n(o,i,e.eri,e.sci-1),s>0&&n(o,e.eci+1,e.eri,a)),u>0?(n(o,i,c,e.sci-1),s>0?(n(o,e.eri+1,c,a),l>0&&n(o,e.sci,e.sri-1,e.eci),f>0&&n(e.sri+1,e.sci,c,e.eci)):(l>0&&n(o,e.sci,e.sri-1,a),f>0&&n(e.sri+1,e.sci,c,a))):s>0&&(n(c,e.eci+1,c,a),l>0&&n(o,i,e.sri-1,e.eci),f>0&&n(e.eri+1,i,c,e.eci)),r}},{key:"size",value:function(){return[this.eri-this.sri+1,this.eci-this.sci+1]}},{key:"toString",value:function(){var t=this.sri,e=this.sci,r=this.eri,n=this.eci,o=d(e,t);return this.multiple()&&(o="".concat(o,":").concat(d(n,r))),o}},{key:"clone",value:function(){return new t(this.sri,this.sci,this.eri,this.eci,this.w,this.h)}},{key:"equals",value:function(t){return this.eri===t.eri&&this.eci===t.eci&&this.sri===t.sri&&this.sci===t.sci}}])&&w(e.prototype,r),n&&w(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function k(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var j=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.range=new O(0,0,0,0),this.ri=0,this.ci=0}var e,r,n;return e=t,(r=[{key:"multiple",value:function(){return this.range.multiple()}},{key:"setIndexes",value:function(t,e){this.ri=t,this.ci=e}},{key:"size",value:function(){return this.range.size()}}])&&k(e.prototype,r),n&&k(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function S(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function x(t,e,r){return e&&S(t.prototype,e),r&&S(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}var E=x((function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.x=0,this.y=0,this.ri=0,this.ci=0}));function P(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var _=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.undoItems=[],this.redoItems=[]}var e,r,n;return e=t,(r=[{key:"add",value:function(t){this.undoItems.push(JSON.stringify(t)),this.redoItems=[]}},{key:"canUndo",value:function(){return this.undoItems.length>0}},{key:"canRedo",value:function(){return this.redoItems.length>0}},{key:"undo",value:function(t,e){var r=this.undoItems,n=this.redoItems;this.canUndo()&&(n.push(JSON.stringify(t)),e(JSON.parse(r.pop())))}},{key:"redo",value:function(t,e){var r=this.undoItems,n=this.redoItems;this.canRedo()&&(r.push(JSON.stringify(t)),e(JSON.parse(n.pop())))}}])&&P(e.prototype,r),n&&P(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function R(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var T=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.range=null,this.state="clear"}var e,r,n;return e=t,(r=[{key:"copy",value:function(t){return this.range=t,this.state="copy",this}},{key:"cut",value:function(t){return this.range=t,this.state="cut",this}},{key:"isCopy",value:function(){return"copy"===this.state}},{key:"isCut",value:function(){return"cut"===this.state}},{key:"isClear",value:function(){return"clear"===this.state}},{key:"clear",value:function(){this.range=null,this.state="clear"}}])&&R(e.prototype,r),n&&R(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function C(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function A(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function I(t,e,r){return e&&A(t.prototype,e),r&&A(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}var D=function(){function t(e,r,n){C(this,t),this.ci=e,this.operator=r,this.value=n}return I(t,[{key:"set",value:function(t,e){this.operator=t,this.value=e}},{key:"includes",value:function(t){var e=this.operator,r=this.value;return"all"===e||"in"===e&&r.includes(t)}},{key:"vlength",value:function(){var t=this.operator,e=this.value;return"in"===t?e.length:0}},{key:"getData",value:function(){return{ci:this.ci,operator:this.operator,value:this.value}}}]),t}(),B=function(){function t(e,r){C(this,t),this.ci=e,this.order=r}return I(t,[{key:"asc",value:function(){return"asc"===this.order}},{key:"desc",value:function(){return"desc"===this.order}}]),t}(),z=function(){function t(){C(this,t),this.ref=null,this.filters=[],this.sort=null}return I(t,[{key:"setData",value:function(t){var e=t.ref,r=t.filters,n=t.sort;null!=e&&(this.ref=e,this.filters=r.map((function(t){return new D(t.ci,t.operator,t.value)})),n&&(this.sort=new B(n.ci,n.order)))}},{key:"getData",value:function(){if(this.active()){var t=this.ref,e=this.filters,r=this.sort;return{ref:t,filters:e.map((function(t){return t.getData()})),sort:r}}return{}}},{key:"addFilter",value:function(t,e,r){var n=this.getFilter(t);null==n?this.filters.push(new D(t,e,r)):n.set(e,r)}},{key:"setSort",value:function(t,e){this.sort=e?new B(t,e):null}},{key:"includes",value:function(t,e){return!!this.active()&&this.hrange().includes(t,e)}},{key:"getSort",value:function(t){var e=this.sort;return e&&e.ci===t?e:null}},{key:"getFilter",value:function(t){for(var e=this.filters,r=0;r<e.length;r+=1)if(e[r].ci===t)return e[r];return null}},{key:"filteredRows",value:function(t){var e=new Set,r=new Set;if(this.active())for(var n=this.range(),o=n.sri,i=n.eri,c=this.filters,a=o+1;a<=i;a+=1)for(var l=0;l<c.length;l+=1){var u=c[l],f=t(a,u.ci),s=f?f.text:"";if(!u.includes(s)){e.add(a);break}r.add(a)}return{rset:e,fset:r}}},{key:"items",value:function(t,e){var r={};if(this.active())for(var n=this.range(),o=n.sri,i=n.eri,c=o+1;c<=i;c+=1){var a=e(c,t);if(null===a||/^\s*$/.test(a.text))r[""]=(r[""]||0)+1;else{var l=a.text,u=(r[l]||0)+1;r[l]=u}}return r}},{key:"range",value:function(){return O.valueOf(this.ref)}},{key:"hrange",value:function(){var t=this.range();return t.eri=t.sri,t}},{key:"clear",value:function(){this.ref=null,this.filters=[],this.sort=null}},{key:"active",value:function(){return null!==this.ref}}]),t}();function M(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function N(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var H=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];M(this,t),this._=e}var e,r,n;return e=t,(r=[{key:"forEach",value:function(t){this._.forEach(t)}},{key:"deleteWithin",value:function(t){this._=this._.filter((function(e){return!e.within(t)}))}},{key:"getFirstIncludes",value:function(t,e){for(var r=0;r<this._.length;r+=1){var n=this._[r];if(n.includes(t,e))return n}return null}},{key:"filterIntersects",value:function(e){return new t(this._.filter((function(t){return t.intersects(e)})))}},{key:"intersects",value:function(t){for(var e=0;e<this._.length;e+=1)if(this._[e].intersects(t))return!0;return!1}},{key:"union",value:function(t){var e=t;return this._.forEach((function(t){t.intersects(e)&&(e=t.union(e))})),e}},{key:"add",value:function(t){this.deleteWithin(t),this._.push(t)}},{key:"shift",value:function(t,e,r,n){this._.forEach((function(o){var i=o.sri,c=o.sci,a=o.eri,l=o.eci,u=o;"row"===t?i>=e?(u.sri+=r,u.eri+=r):i<e&&e<=a&&(u.eri+=r,n(i,c,r,0)):"column"===t&&(c>=e?(u.sci+=r,u.eci+=r):c<e&&e<=l&&(u.eci+=r,n(i,c,0,r)))}))}},{key:"move",value:function(t,e,r){this._.forEach((function(n){var o=n;o.within(t)&&(o.eri+=e,o.sri+=e,o.sci+=r,o.eci+=r)}))}},{key:"setData",value:function(t){return this._=t.map((function(t){return O.valueOf(t)})),this}},{key:"getData",value:function(){return this._.map((function(t){return t.toString()}))}}])&&N(e.prototype,r),n&&N(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();var F=function t(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length,n=new Array(r>1?r-1:0),o=1;o<r;o++)n[o-1]=arguments[o];return n.forEach((function(r){Object.keys(r).forEach((function(n){var o=r[n];"string"==typeof o||"number"==typeof o||"boolean"==typeof o?e[n]=o:"function"!=typeof o&&!Array.isArray(o)&&o instanceof Object?(e[n]=e[n]||{},t(e[n],o)):e[n]=o}))})),e};function W(t){for(var e="".concat(t),r=0,n=!1,o=0;o<e.length;o+=1)!0===n&&(r+=1),"."===e.charAt(o)&&(n=!0);return r}function V(t,e,r){if(Number.isNaN(e)||Number.isNaN(r))return e+t+r;var n=W(e),o=W(r),i=Number(e),c=Number(r),a=0;if("-"===t)a=i-c;else if("+"===t)a=i+c;else if("*"===t)a=i*c;else if("/"===t)return W(a=i/c)>5?a.toFixed(2):a;return a.toFixed(Math.max(n,o))}var U={cloneDeep:function(t){return JSON.parse(JSON.stringify(t))},merge:function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return F.apply(void 0,[{}].concat(e))},equals:function t(e,r){var n=Object.keys(e);if(n.length!==Object.keys(r).length)return!1;for(var o=0;o<n.length;o+=1){var i=n[o],c=e[i],a=r[i];if(void 0===a)return!1;if("string"==typeof c||"number"==typeof c||"boolean"==typeof c){if(c!==a)return!1}else if(Array.isArray(c)){if(c.length!==a.length)return!1;for(var l=0;l<c.length;l+=1)if(!t(c[l],a[l]))return!1}else if("function"!=typeof c&&!Array.isArray(c)&&c instanceof Object&&!t(c,a))return!1}return!0},arrayEquals:function(t,e){if(t.length!==e.length)return!1;for(var r=0;r<t.length;r+=1)if(t[r]!==e[r])return!1;return!0},sum:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(t){return t},r=0,n=0;return Object.keys(t).forEach((function(o){r+=e(t[o],o),n+=1})),[r,n]},rangeEach:function(t,e,r){for(var n=t;n<e;n+=1)r(n)},rangeSum:function(t,e,r){for(var n=0,o=t;o<e;o+=1)n+=r(o);return n},rangeReduceIf:function(t,e,r,n,o,i){for(var c=r,a=n,l=t;l<e&&!(c>o);l+=1)c+=a=i(l);return[l,c-a,a]},deleteProperty:function(t,e){var r=t["".concat(e)];return delete t["".concat(e)],r},numberCalc:V};function $(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null==r)return;var n,o,i=[],c=!0,a=!1;try{for(r=r.call(t);!(c=(n=r.next()).done)&&(i.push(n.value),!e||i.length!==e);c=!0);}catch(t){a=!0,o=t}finally{try{c||null==r.return||r.return()}finally{if(a)throw o}}return i}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return L(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return L(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function L(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function q(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var Y=function(){function t(e){var r=e.len,n=e.height;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._={},this.len=r,this.height=n}var e,r,n;return e=t,(r=[{key:"getHeight",value:function(t){if(this.isHide(t))return 0;var e=this.get(t);return e&&e.height?e.height:this.height}},{key:"setHeight",value:function(t,e){this.getOrNew(t).height=e}},{key:"unhide",value:function(t){for(var e=t;e>0&&(e-=1,this.isHide(e));)this.setHide(e,!1)}},{key:"isHide",value:function(t){var e=this.get(t);return e&&e.hide}},{key:"setHide",value:function(t,e){var r=this.getOrNew(t);!0===e?r.hide=!0:delete r.hide}},{key:"setStyle",value:function(t,e){this.getOrNew(t).style=e}},{key:"sumHeight",value:function(t,e,r){var n=this;return U.rangeSum(t,e,(function(t){return r&&r.has(t)?0:n.getHeight(t)}))}},{key:"totalHeight",value:function(){return this.sumHeight(0,this.len)}},{key:"get",value:function(t){return this._[t]}},{key:"getOrNew",value:function(t){return this._[t]=this._[t]||{cells:{}},this._[t]}},{key:"getCell",value:function(t,e){var r=this.get(t);return void 0!==r&&void 0!==r.cells&&void 0!==r.cells[e]?r.cells[e]:null}},{key:"getCellMerge",value:function(t,e){var r=this.getCell(t,e);return r&&r.merge?r.merge:[0,0]}},{key:"getCellOrNew",value:function(t,e){var r=this.getOrNew(t);return r.cells[e]=r.cells[e]||{},r.cells[e]}},{key:"setCell",value:function(t,e,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"all",o=this.getOrNew(t);"all"===n?o.cells[e]=r:"text"===n?(o.cells[e]=o.cells[e]||{},o.cells[e].text=r.text):"format"===n&&(o.cells[e]=o.cells[e]||{},o.cells[e].style=r.style,r.merge&&(o.cells[e].merge=r.merge))}},{key:"setCellText",value:function(t,e,r){var n=this.getCellOrNew(t,e);!1!==n.editable&&(n.text=r)}},{key:"copyPaste",value:function(t,e,r){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:function(){},i=t.sri,c=t.sci,a=t.eri,l=t.eci,u=e.sri,f=e.sci,s=e.eri,h=e.eci,p=t.size(),y=$(p,2),d=y[0],b=y[1],m=e.size(),g=$(m,2),w=g[0],O=g[1],k=!0,j=0;(s<i||h<c)&&(k=!1,j=s<i?w:O);for(var S=i;S<=a;S+=1)if(this._[S])for(var x=c;x<=l;x+=1)if(this._[S].cells&&this._[S].cells[x])for(var E=u;E<=s;E+=d)for(var P=f;P<=h;P+=b){var _=E+(S-i),R=P+(x-c),T=U.cloneDeep(this._[S].cells[x]);n&&T&&T.text&&T.text.length>0&&function(){var t=T.text,e=P-f+(E-u)+2;if(k||(e-=j+1),"="===t[0])T.text=t.replace(/[a-zA-Z]{1,3}\d+/g,(function(t){var r=0,n=0;return i===u?r=e-1:n=e-1,/^\d+$/.test(t)?t:v(t,r,n)}));else if(d<=1&&b>1&&(u>a||s<i)||b<=1&&d>1&&(f>l||h<c)||d<=1&&b<=1){var r=/[\\.\d]+$/.exec(t);if(null!==r){var n=Number(r[0])+e-1;T.text=t.substring(0,r.index)+n}}}(),this.setCell(_,R,T,r),o(_,R,T)}}},{key:"cutPaste",value:function(t,e){var r=this,n={};this.each((function(o){r.eachCells(o,(function(i){var c=parseInt(o,10),a=parseInt(i,10);t.includes(o,i)&&(c=e.sri+(c-t.sri),a=e.sci+(a-t.sci)),n[c]=n[c]||{cells:{}},n[c].cells[a]=r._[o].cells[i]}))})),this._=n}},{key:"paste",value:function(t,e){var r=this;if(!(t.length<=0)){var n=e.sri,o=e.sci;t.forEach((function(t,e){var i=n+e;t.forEach((function(t,e){var n=o+e;r.setCellText(i,n,t)}))}))}}},{key:"insert",value:function(t){var e=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n={};this.each((function(o,i){var c=parseInt(o,10);c>=t&&(c+=r,e.eachCells(o,(function(e,n){n.text&&"="===n.text[0]&&(n.text=n.text.replace(/[a-zA-Z]{1,3}\d+/g,(function(e){return v(e,0,r,(function(e,r){return r>=t}))})))}))),n[c]=i})),this._=n,this.len+=r}},{key:"delete",value:function(t,e){var r=this,n=e-t+1,o={};this.each((function(i,c){var a=parseInt(i,10);a<t?o[a]=c:i>e&&(o[a-n]=c,r.eachCells(i,(function(t,r){r.text&&"="===r.text[0]&&(r.text=r.text.replace(/[a-zA-Z]{1,3}\d+/g,(function(t){return v(t,0,-n,(function(t,r){return r>e}))})))})))})),this._=o,this.len-=n}},{key:"insertColumn",value:function(t){var e=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.each((function(n,o){var i={};e.eachCells(n,(function(e,n){var o=parseInt(e,10);o>=t&&(o+=r,n.text&&"="===n.text[0]&&(n.text=n.text.replace(/[a-zA-Z]{1,3}\d+/g,(function(e){return v(e,r,0,(function(e){return e>=t}))})))),i[o]=n})),o.cells=i}))}},{key:"deleteColumn",value:function(t,e){var r=this,n=e-t+1;this.each((function(o,i){var c={};r.eachCells(o,(function(r,o){var i=parseInt(r,10);i<t?c[i]=o:i>e&&(c[i-n]=o,o.text&&"="===o.text[0]&&(o.text=o.text.replace(/[a-zA-Z]{1,3}\d+/g,(function(t){return v(t,-n,0,(function(t){return t>e}))}))))})),i.cells=c}))}},{key:"deleteCells",value:function(t){var e=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"all";t.each((function(t,n){e.deleteCell(t,n,r)}))}},{key:"deleteCell",value:function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"all",n=this.get(t);if(null!==n){var o=this.getCell(t,e);null!==o&&!1!==o.editable&&("all"===r?delete n.cells[e]:"text"===r?(o.text&&delete o.text,o.value&&delete o.value):"format"===r?(void 0!==o.style&&delete o.style,o.merge&&delete o.merge):"merge"===r&&o.merge&&delete o.merge)}}},{key:"maxCell",value:function(){var t=Object.keys(this._),e=t[t.length-1],r=this._[e];if(r){var n=r.cells,o=Object.keys(n),i=o[o.length-1];return[parseInt(e,10),parseInt(i,10)]}return[0,0]}},{key:"each",value:function(t){Object.entries(this._).forEach((function(e){var r=$(e,2),n=r[0],o=r[1];t(n,o)}))}},{key:"eachCells",value:function(t,e){this._[t]&&this._[t].cells&&Object.entries(this._[t].cells).forEach((function(t){var r=$(t,2),n=r[0],o=r[1];e(n,o)}))}},{key:"setData",value:function(t){t.len&&(this.len=t.len,delete t.len),this._=t}},{key:"getData",value:function(){var t=this.len;return Object.assign({len:t},this._)}}])&&q(e.prototype,r),n&&q(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function X(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var K=function(){function t(e){var r=e.len,n=e.width,o=e.indexWidth,i=e.minWidth;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._={},this.len=r,this.width=n,this.indexWidth=o,this.minWidth=i}var e,r,n;return e=t,(r=[{key:"setData",value:function(t){t.len&&(this.len=t.len,delete t.len),this._=t}},{key:"getData",value:function(){var t=this.len;return Object.assign({len:t},this._)}},{key:"getWidth",value:function(t){if(this.isHide(t))return 0;var e=this._[t];return e&&e.width?e.width:this.width}},{key:"getOrNew",value:function(t){return this._[t]=this._[t]||{},this._[t]}},{key:"setWidth",value:function(t,e){this.getOrNew(t).width=e}},{key:"unhide",value:function(t){for(var e=t;e>0&&(e-=1,this.isHide(e));)this.setHide(e,!1)}},{key:"isHide",value:function(t){var e=this._[t];return e&&e.hide}},{key:"setHide",value:function(t,e){var r=this.getOrNew(t);!0===e?r.hide=!0:delete r.hide}},{key:"setStyle",value:function(t,e){this.getOrNew(t).style=e}},{key:"sumWidth",value:function(t,e){var r=this;return U.rangeSum(t,e,(function(t){return r.getWidth(t)}))}},{key:"totalWidth",value:function(){return this.sumWidth(0,this.len)}}])&&X(e.prototype,r),n&&X(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function Z(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=function(t,e){if(!t)return;if("string"==typeof t)return J(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return J(t,e)}(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,c=!0,a=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return c=t.done,t},e:function(t){a=!0,i=t},f:function(){try{c||null==r.return||r.return()}finally{if(a)throw i}}}}function J(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}var G=["cn"],Q={cn:{toolbar:{undo:"撤销",redo:"恢复",print:"打印设置",export:"导出",paintformat:"格式刷",clearformat:"清除格式",format:"数据格式",fontName:"字体",fontSize:"字号",fontBold:"加粗",fontItalic:"倾斜",underline:"下划线",strike:"删除线",color:"字体颜色",bgcolor:"填充颜色",border:"边框",merge:"合并单元格",align:"水平对齐",valign:"垂直对齐",textwrap:"自动换行",freeze:"冻结",autofilter:"自动筛选",formula:"函数",more:"更多",background:"插入图片"},contextmenu:{copy:"复制",cut:"剪切",paste:"粘贴",pasteValue:"粘贴数据",pasteFormat:"粘贴格式",hide:"隐藏",insertRow:"插入行",insertColumn:"插入列",deleteSheet:"删除",deleteRow:"删除行",deleteColumn:"删除列",deleteCell:"删除",deleteCellText:"删除数据",validation:"数据验证",cellprintable:"可打印",cellnonprintable:"不可打印",celleditable:"可编辑",cellnoneditable:"不可编辑"},print:{size:"纸张大小",orientation:"方向",orientations:["横向","纵向"]},format:{normal:"正常",text:"文本",number:"数值",percent:"百分比",rmb:"人民币",usd:"美元",eur:"欧元",date:"短日期",time:"时间",datetime:"长日期",duration:"持续时间"},formula:{sum:"求和",average:"求平均值",max:"求最大值",min:"求最小值",concat:"字符拼接",_if:"条件判断",and:"和",or:"或"},validation:{required:"此值必填",notMatch:"此值不匹配验证规则",between:"此值应在 {} 和 {} 之间",notBetween:"此值不应在 {} 和 {} 之间",notIn:"此值不在列表中",equal:"此值应该等于 {}",notEqual:"此值不应该等于 {}",lessThan:"此值应该小于 {}",lessThanEqual:"此值应该小于等于 {}",greaterThan:"此值应该大于 {}",greaterThanEqual:"此值应该大于等于 {}"},error:{pasteForMergedCell:"无法对合并的单元格执行此操作"},calendar:{weeks:["日","一","二","三","四","五","六"],months:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"]},button:{next:"下一步",cancel:"取消",remove:"删除",save:"保存",ok:"确认"},sort:{desc:"降序",asc:"升序"},filter:{empty:"空白"},dataValidation:{mode:"模式",range:"单元区间",criteria:"条件",modeType:{cell:"单元格",column:"列模式",row:"行模式"},type:{list:"列表",number:"数字",date:"日期",phone:"手机号",email:"电子邮件"},operator:{be:"在区间",nbe:"不在区间",lt:"小于",lte:"小于等于",gt:"大于",gte:"大于等于",eq:"等于",neq:"不等于"}}}};function tt(t,e){if(e){var r,n=Z(G);try{for(n.s();!(r=n.n()).done;){var o=r.value;if(!e[o])break;for(var i=e[o],c=t.match(/(?:\\.|[^.])+/g),a=0;a<c.length;a+=1){var l=i[c[a]];if(!l)break;if(a===c.length-1)return l;i=l}}}catch(t){n.e(t)}finally{n.f()}}}function et(t){var e=tt(t,Q);return!e&&window&&window.x_spreadsheet&&window.x_spreadsheet.$messages&&(e=tt(t,window.x_spreadsheet.$messages)),e||""}function rt(t){return function(){return et(t)}}function nt(t,e){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];r?G=[t]:G.unshift(t),e&&(Q[t]=e)}function ot(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null==r)return;var n,o,i=[],c=!0,a=!1;try{for(r=r.call(t);!(c=(n=r.next()).done)&&(i.push(n.value),!e||i.length!==e);c=!0);}catch(t){a=!0,o=t}finally{try{c||null==r.return||r.return()}finally{if(a)throw o}}return i}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return it(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return it(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function it(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function ct(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var at={phone:/^[1-9]\d{10}$/,email:/w+([-+.]w+)*@w+([-.]w+)*.w+([-.]w+)*/};function lt(t,e){var r="";if(!t){for(var n=arguments.length,o=new Array(n>2?n-2:0),i=2;i<n;i++)o[i-2]=arguments[i];r=et.apply(void 0,["validation.".concat(e)].concat(o))}return[t,r]}var ut=function(){function t(e,r,n,o){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.required=r,this.value=n,this.type=e,this.operator=o,this.message=""}var e,r,n;return e=t,(r=[{key:"parseValue",value:function(t){var e=this.type;return"date"===e?new Date(t):"number"===e?Number(t):t}},{key:"equals",value:function(t){var e=this.type===t.type&&this.required===t.required&&this.operator===t.operator;return e&&(e=Array.isArray(this.value)?U.arrayEquals(this.value,t.value):this.value===t.value),e}},{key:"values",value:function(){return this.value.split(",")}},{key:"validate",value:function(t){var e=this.required,r=this.operator,n=this.value,o=this.type;if(e&&/^\s*$/.test(t))return lt(!1,"required");if(/^\s*$/.test(t))return[!0];if(at[o]&&!at[o].test(t))return lt(!1,"notMatch");if("list"===o)return lt(this.values().includes(t),"notIn");if(r){var i=this.parseValue(t);if("be"===r){var c=ot(n,2),a=c[0],l=c[1];return lt(i>=this.parseValue(a)&&i<=this.parseValue(l),"between",a,l)}if("nbe"===r){var u=ot(n,2),f=u[0],s=u[1];return lt(i<this.parseValue(f)||i>this.parseValue(s),"notBetween",f,s)}if("eq"===r)return lt(i===this.parseValue(n),"equal",n);if("neq"===r)return lt(i!==this.parseValue(n),"notEqual",n);if("lt"===r)return lt(i<this.parseValue(n),"lessThan",n);if("lte"===r)return lt(i<=this.parseValue(n),"lessThanEqual",n);if("gt"===r)return lt(i>this.parseValue(n),"greaterThan",n);if("gte"===r)return lt(i>=this.parseValue(n),"greaterThanEqual",n)}return[!0]}}])&&ct(e.prototype,r),n&&ct(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function ft(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null==r)return;var n,o,i=[],c=!0,a=!1;try{for(r=r.call(t);!(c=(n=r.next()).done)&&(i.push(n.value),!e||i.length!==e);c=!0);}catch(t){a=!0,o=t}finally{try{c||null==r.return||r.return()}finally{if(a)throw o}}return i}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return st(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return st(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function st(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function ht(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function pt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function yt(t,e,r){return e&&pt(t.prototype,e),r&&pt(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}var dt=function(){function t(e,r,n){ht(this,t),this.refs=r,this.mode=e,this.validator=n}return yt(t,[{key:"includes",value:function(t,e){for(var r=this.refs,n=0;n<r.length;n+=1){if(O.valueOf(r[n]).includes(t,e))return!0}return!1}},{key:"addRef",value:function(t){this.remove(O.valueOf(t)),this.refs.push(t)}},{key:"remove",value:function(t){var e=[];this.refs.forEach((function(r){var n=O.valueOf(r);n.intersects(t)?n.difference(t).forEach((function(t){return e.push(t.toString())})):e.push(r)})),this.refs=e}},{key:"getData",value:function(){var t=this.refs,e=this.mode,r=this.validator;return{refs:t,mode:e,type:r.type,required:r.required,operator:r.operator,value:r.value}}}],[{key:"valueOf",value:function(e){var r=e.refs,n=e.mode,o=e.type,i=e.required,c=e.operator,a=e.value;return new t(n,r,new ut(o,i,a,c))}}]),t}(),vt=function(){function t(){ht(this,t),this._=[],this.errors=new Map}return yt(t,[{key:"getError",value:function(t,e){return this.errors.get("".concat(t,"_").concat(e))}},{key:"validate",value:function(t,e,r){var n=this.get(t,e),o="".concat(t,"_").concat(e),i=this.errors;if(null!==n){var c=ft(n.validator.validate(r),2),a=c[0],l=c[1];a?i.delete(o):i.set(o,l)}else i.delete(o);return!0}},{key:"add",value:function(t,e,r){var n=r.type,o=r.required,i=r.value,c=r.operator,a=new ut(n,o,i,c),l=this.getByValidator(a);null!==l?l.addRef(e):this._.push(new dt(t,[e],a))}},{key:"getByValidator",value:function(t){for(var e=0;e<this._.length;e+=1){var r=this._[e];if(r.validator.equals(t))return r}return null}},{key:"get",value:function(t,e){for(var r=0;r<this._.length;r+=1){var n=this._[r];if(n.includes(t,e))return n}return null}},{key:"remove",value:function(t){this.each((function(e){e.remove(t)}))}},{key:"each",value:function(t){this._.forEach((function(e){return t(e)}))}},{key:"getData",value:function(){return this._.filter((function(t){return t.refs.length>0})).map((function(t){return t.getData()}))}},{key:"setData",value:function(t){this._=t.map((function(t){return dt.valueOf(t)}))}}]),t}();function bt(t){return function(t){if(Array.isArray(t))return Ot(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||wt(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function mt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function gt(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null==r)return;var n,o,i=[],c=!0,a=!1;try{for(r=r.call(t);!(c=(n=r.next()).done)&&(i.push(n.value),!e||i.length!==e);c=!0);}catch(t){a=!0,o=t}finally{try{c||null==r.return||r.return()}finally{if(a)throw o}}return i}(t,e)||wt(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function wt(t,e){if(t){if("string"==typeof t)return Ot(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Ot(t,e):void 0}}function Ot(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}var kt={mode:"edit",view:{height:function(){return document.documentElement.clientHeight},width:function(){return document.documentElement.clientWidth}},showGrid:!0,showToolbar:!0,showContextmenu:!0,showBottomBar:!0,showVtoolbar:!1,row:{len:100,height:25},col:{len:26,width:100,indexWidth:60,minWidth:60},style:{bgcolor:"#ffffff",align:"left",valign:"middle",textwrap:!1,strike:!1,underline:!1,color:"#0a0a0a",font:{name:"Arial",size:10,bold:!1,italic:!1},format:"normal"}};function jt(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){},n=this.merges,o=e.clone(),i=t.size(),c=gt(i,2),a=c[0],l=c[1],u=e.size(),f=gt(u,2),s=f[0],h=f[1];return a>s&&(o.eri=e.sri+a-1),l>h&&(o.eci=e.sci+l-1),!n.intersects(o)||(r(et("error.pasteForMergedCell")),!1)}function St(t,e,r){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=this.rows,i=this.merges;"all"!==r&&"format"!==r||(o.deleteCells(e,r),i.deleteWithin(e)),o.copyPaste(t,e,r,n,(function(t,e,r){if(r&&r.merge){var n=gt(r.merge,2),o=n[0],c=n[1];if(o<=0&&c<=0)return;i.add(new O(t,e,t+o,e+c))}}))}function xt(t,e){var r=this.clipboard,n=this.rows,o=this.merges;n.cutPaste(t,e),o.move(t,e.sri-t.sri,e.sci-t.sci),r.clear()}function Et(t,e,r){var n=this.styles,o=this.rows.getCellOrNew(t,e),i={};void 0!==o.style&&(i=U.cloneDeep(n[o.style])),i=U.merge(i,{border:r}),o.style=this.addStyle(i)}function Pt(t){var e=this,r=t.mode,n=t.style,o=t.color,i=this.styles,c=this.selector,a=this.rows,l=c.range,u=l.sri,f=l.sci,s=l.eri,h=l.eci,p=!this.isSingleSelected();if(p||"inside"!==r&&"horizontal"!==r&&"vertical"!==r)if("outside"!==r||p){if("none"===r)c.range.each((function(t,r){var n=a.getCell(t,r);if(n&&void 0!==n.style){var o=U.cloneDeep(i[n.style]);delete o.border,n.style=e.addStyle(o)}}));else if("all"===r||"inside"===r||"outside"===r||"horizontal"===r||"vertical"===r)!function(){for(var t=[],i=u;i<=s;i+=1)for(var c=f;c<=h;c+=1){for(var l=[],y=0;y<t.length;y+=1){var d=gt(t[y],4),v=d[0],b=d[1],m=d[2],g=d[3];if(i===v+m+1&&l.push(y),v<=i&&i<=v+m&&c===b){c+=g+1;break}}if(l.forEach((function(e){return t.splice(e,1)})),c>h)break;var w=a.getCell(i,c),O=0,k=0;if(w&&w.merge){var j=gt(w.merge,2);O=j[0],k=j[1],t.push([i,c,O,k])}var S=O>0&&i+O===s,x=k>0&&c+k===h,E={};"all"===r?E={bottom:[n,o],top:[n,o],left:[n,o],right:[n,o]}:"inside"===r?(!x&&c<h&&(E.right=[n,o]),!S&&i<s&&(E.bottom=[n,o])):"horizontal"===r?!S&&i<s&&(E.bottom=[n,o]):"vertical"===r?!x&&c<h&&(E.right=[n,o]):"outside"===r&&p&&(u===i&&(E.top=[n,o]),(S||s===i)&&(E.bottom=[n,o]),f===c&&(E.left=[n,o]),(x||h===c)&&(E.right=[n,o])),Object.keys(E).length>0&&Et.call(e,i,c,E),c+=k}}();else if("top"===r||"bottom"===r)for(var y=f;y<=h;y+=1)"top"===r&&(Et.call(this,u,y,{top:[n,o]}),y+=a.getCellMerge(u,y)[1]),"bottom"===r&&(Et.call(this,s,y,{bottom:[n,o]}),y+=a.getCellMerge(s,y)[1]);else if("left"===r||"right"===r)for(var d=u;d<=s;d+=1)"left"===r&&(Et.call(this,d,f,{left:[n,o]}),d+=a.getCellMerge(d,f)[0]),"right"===r&&(Et.call(this,d,h,{right:[n,o]}),d+=a.getCellMerge(d,h)[0])}else Et.call(this,u,f,{top:[n,o],bottom:[n,o],left:[n,o],right:[n,o]})}function _t(t,e){var r=this.rows,n=this.freezeTotalHeight(),o=r.height;n+r.height<t&&(o-=e);for(var i=this.exceptRowSet,c=0,a=o,l=r.height;c<r.len&&!(a>t);c+=1)i.has(c)||(a+=l=r.getHeight(c));return(a-=l)<=0?{ri:-1,top:0,height:l}:{ri:c-1,top:a,height:l}}function Rt(t,e){var r=this.cols,n=this.freezeTotalWidth(),o=r.indexWidth;n+r.indexWidth<t&&(o-=e);var i=gt(U.rangeReduceIf(0,r.len,o,r.indexWidth,t,(function(t){return r.getWidth(t)})),3),c=i[0],a=i[1],l=i[2];return a<=0?{ci:-1,left:0,width:r.indexWidth}:{ci:c-1,left:a,width:l}}var Tt=function(){function t(e,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.settings=U.merge(kt,r||{}),this.name=e||"sheet",this.freeze=[0,0],this.styles=[],this.merges=new H,this.rows=new Y(this.settings.row),this.cols=new K(this.settings.col),this.validations=new vt,this.hyperlinks={},this.comments={},this.selector=new j,this.scroll=new E,this.history=new _,this.clipboard=new T,this.autoFilter=new z,this.change=function(){},this.exceptRowSet=new Set,this.sortedRowMap=new Map,this.unsortedRowMap=new Map,this.printConfig={paper:"A4",width:210,height:297,definition:1,isBackend:!1,marginX:10,marginY:10,layout:"portrait"}}var e,r,n;return e=t,(r=[{key:"addValidation",value:function(t,e,r){var n=this;this.changeData((function(){n.validations.add(t,e,r)}))}},{key:"removeValidation",value:function(){var t=this,e=this.selector.range;this.changeData((function(){t.validations.remove(e)}))}},{key:"getSelectedValidator",value:function(){var t=this.selector,e=t.ri,r=t.ci,n=this.validations.get(e,r);return n?n.validator:null}},{key:"getSelectedValidation",value:function(){var t=this.selector,e=t.ri,r=t.ci,n=t.range,o=this.validations.get(e,r),i={ref:n.toString()};return null!==o&&(i.mode=o.mode,i.validator=o.validator),i}},{key:"canUndo",value:function(){return this.history.canUndo()}},{key:"canRedo",value:function(){return this.history.canRedo()}},{key:"undo",value:function(){var t=this;this.history.undo(this.getData(),(function(e){t.setData(e)}))}},{key:"redo",value:function(){var t=this;this.history.redo(this.getData(),(function(e){t.setData(e)}))}},{key:"copy",value:function(){this.clipboard.copy(this.selector.range)}},{key:"copyToSystemClipboard",value:function(t){for(var e=[],r=this.selector.range,n=r.sri,o=r.eri,i=r.sci,c=r.eci,a=n;a<=o;a+=1){for(var l=[],u=i;u<=c;u+=1){var f=this.getCell(a,u);l.push(f&&f.text||"")}e.push(l)}e=e.map((function(t){return t.join("\t")})).join("\n"),t&&(t.clipboardData.clearData(),t.clipboardData.setData("text/plain",e),t.preventDefault()),navigator.clipboard&&navigator.clipboard.writeText(e).then((function(){}),(function(t){console.log("text copy to the system clipboard error  ",e,t)}))}},{key:"cut",value:function(){this.clipboard.cut(this.selector.range)}},{key:"paste",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"all",r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){},n=this.clipboard,o=this.selector;return!n.isClear()&&!!jt.call(this,n.range,o.range,r)&&(this.changeData((function(){n.isCopy()?St.call(t,n.range,o.range,e):n.isCut()&&xt.call(t,n.range,o.range)})),!0)}},{key:"pasteFromText",value:function(t){var e=[];if((e=/\r\n/.test(t)?t.split("\r\n").map((function(t){return t.replace(/"/g,"").split("\t")})):t.split("\n").map((function(t){return t.replace(/"/g,"").split("\t")}))).length){var r=this.rows,n=this.selector;this.changeData((function(){r.paste(e,n.range)}))}}},{key:"autofill",value:function(t,e){var r=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){},o=this.selector.range;return!!jt.call(this,o,t,n)&&(this.changeData((function(){St.call(r,o,t,e,!0)})),!0)}},{key:"clearClipboard",value:function(){this.clipboard.clear()}},{key:"calSelectedRangeByEnd",value:function(t,e){var r=this.selector,n=this.rows,o=this.cols,i=this.merges,c=r.range,a=c.sri,l=c.sci,u=c.eri,f=c.eci,s=r.ri,h=r.ci,p=t,y=e;return t<0&&(p=n.len-1),e<0&&(y=o.len-1),p>s?(a=s,u=p):(a=p,u=s),y>h?(l=h,f=y):(l=y,f=h),r.range=i.union(new O(a,l,u,f)),r.range=i.union(r.range),r.range}},{key:"calSelectedRangeByStart",value:function(t,e){var r=this.selector,n=this.rows,o=this.cols,i=this.merges.getFirstIncludes(t,e);return null===i&&(i=new O(t,e,t,e),-1===t&&(i.sri=0,i.eri=n.len-1),-1===e&&(i.sci=0,i.eci=o.len-1)),r.range=i,i}},{key:"setSelectedCellAttr",value:function(t,e){var r=this;this.changeData((function(){var n=r.selector,o=r.styles,i=r.rows;if("merge"===t)e?r.merge():r.unmerge();else if("border"===t)Pt.call(r,e);else if("formula"===t){var c=n.ri,a=n.ci,l=n.range;if(n.multiple()){var u=gt(n.size(),2),f=u[0],s=u[1],h=l.sri,p=l.sci,y=l.eri,v=l.eci;if(f>1)for(var b=p;b<=v;b+=1)i.getCellOrNew(y+1,b).text="=".concat(e,"(").concat(d(b,h),":").concat(d(b,y),")");else s>1&&(i.getCellOrNew(c,v+1).text="=".concat(e,"(").concat(d(p,c),":").concat(d(v,c),")"))}else i.getCellOrNew(c,a).text="=".concat(e,"()")}else n.range.each((function(n,c){var a=i.getCellOrNew(n,c),l={};if(void 0!==a.style&&(l=U.cloneDeep(o[a.style])),"format"===t)l.format=e,a.style=r.addStyle(l);else if("font-bold"===t||"font-italic"===t||"font-name"===t||"font-size"===t){var u={};u[t.split("-")[1]]=e,l.font=Object.assign(l.font||{},u),a.style=r.addStyle(l)}else"strike"===t||"textwrap"===t||"underline"===t||"align"===t||"valign"===t||"color"===t||"bgcolor"===t?(l[t]=e,a.style=r.addStyle(l)):a[t]=e}))}))}},{key:"setSelectedCellText",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"input",r=this.autoFilter,n=this.selector,o=this.rows,i=n.ri,c=n.ci,a=i;this.unsortedRowMap.has(i)&&(a=this.unsortedRowMap.get(i));var l=o.getCell(a,c),u=l?l.text:"";if(this.setCellText(a,c,t,e),r.active()){var f=r.getFilter(c);if(f){var s=f.value.findIndex((function(t){return t===u}));s>=0&&f.value.splice(s,1,t)}}}},{key:"getSelectedCell",value:function(){var t=this.selector,e=t.ri,r=t.ci,n=e;return this.unsortedRowMap.has(e)&&(n=this.unsortedRowMap.get(e)),this.rows.getCell(n,r)}},{key:"xyInSelectedRect",value:function(t,e){var r=this.getSelectedRect(),n=r.left,o=r.top,i=r.width,c=r.height,a=t-this.cols.indexWidth,l=e-this.rows.height;return a>n&&a<n+i&&l>o&&l<o+c}},{key:"getSelectedRect",value:function(){return this.getRect(this.selector.range)}},{key:"getClipboardRect",value:function(){var t=this.clipboard;return t.isClear()?{left:-100,top:-100}:this.getRect(t.range)}},{key:"getRect",value:function(t){var e=this.scroll,r=this.rows,n=this.cols,o=this.exceptRowSet,i=t.sri,c=t.sci,a=t.eri,l=t.eci;if(i<0&&c<0)return{left:0,l:0,top:0,t:0,scroll:e};var u=n.sumWidth(0,c),f=r.sumHeight(0,i,o),s=r.sumHeight(i,a+1,o),h=n.sumWidth(c,l+1),p=u-e.x,y=f-e.y,d=this.freezeTotalHeight(),v=this.freezeTotalWidth();return v>0&&v>u&&(p=u),d>0&&d>f&&(y=f),{l:u,t:f,left:p,top:y,height:s,width:h,scroll:e}}},{key:"getCellRectByXY",value:function(t,e){var r=this.scroll,n=this.merges,o=this.rows,i=this.cols,c=_t.call(this,e,r.y),a=c.ri,l=c.top,u=c.height,f=Rt.call(this,t,r.x),s=f.ci,h=f.left,p=f.width;if(-1===s&&(p=i.totalWidth()),-1===a&&(u=o.totalHeight()),a>=0||s>=0){var y=n.getFirstIncludes(a,s);if(y){a=y.sri,s=y.sci;var d=this.cellRect(a,s);h=d.left,l=d.top,p=d.width,u=d.height}}return{ri:a,ci:s,left:h,top:l,width:p,height:u}}},{key:"isSingleSelected",value:function(){var t=this.selector.range,e=t.sri,r=t.sci,n=t.eri,o=t.eci,i=this.getCell(e,r);if(i&&i.merge){var c=gt(i.merge,2),a=c[0],l=c[1];if(e+a===n&&r+l===o)return!0}return!this.selector.multiple()}},{key:"canUnmerge",value:function(){var t=this.selector.range,e=t.sri,r=t.sci,n=t.eri,o=t.eci,i=this.getCell(e,r);if(i&&i.merge){var c=gt(i.merge,2),a=c[0],l=c[1];if(e+a===n&&r+l===o)return!0}return!1}},{key:"merge",value:function(){var t=this,e=this.selector,r=this.rows;if(!this.isSingleSelected()){var n=gt(e.size(),2),o=n[0],i=n[1];if(o>1||i>1){var c=e.range,a=c.sri,l=c.sci;this.changeData((function(){var n=r.getCellOrNew(a,l);n.merge=[o-1,i-1],t.merges.add(e.range),t.rows.deleteCells(e.range),t.rows.setCell(a,l,n)}))}}}},{key:"unmerge",value:function(){var t=this,e=this.selector;if(this.isSingleSelected()){var r=e.range,n=r.sri,o=r.sci;this.changeData((function(){t.rows.deleteCell(n,o,"merge"),t.merges.deleteWithin(e.range)}))}}},{key:"canAutofilter",value:function(){return!this.autoFilter.active()}},{key:"autofilter",value:function(){var t=this,e=this.autoFilter,r=this.selector;this.changeData((function(){e.active()?(e.clear(),t.exceptRowSet=new Set,t.sortedRowMap=new Map,t.unsortedRowMap=new Map):e.ref=r.range.toString()}))}},{key:"setAutoFilter",value:function(t,e,r,n){var o=this.autoFilter;o.addFilter(t,r,n),o.setSort(t,e),this.resetAutoFilter()}},{key:"resetAutoFilter",value:function(){var t=this,e=this.autoFilter,r=this.rows;if(e.active()){var n=e.sort,o=e.filteredRows((function(t,e){return r.getCell(t,e)})),i=o.rset,c=o.fset,a=Array.from(c),l=Array.from(c);n&&a.sort((function(t,e){return"asc"===n.order?t-e:"desc"===n.order?e-t:0})),this.exceptRowSet=i,this.sortedRowMap=new Map,this.unsortedRowMap=new Map,a.forEach((function(e,r){t.sortedRowMap.set(l[r],e),t.unsortedRowMap.set(e,l[r])}))}}},{key:"deleteCell",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"all",r=this.selector;this.changeData((function(){t.rows.deleteCells(r.range,e),"all"!==e&&"format"!==e||t.merges.deleteWithin(r.range)}))}},{key:"insert",value:function(t){var e=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.changeData((function(){var n=e.selector.range,o=n.sri,i=n.sci,c=e.rows,a=e.merges,l=e.cols,u=o;"row"===t?c.insert(o,r):"column"===t&&(c.insertColumn(i,r),u=i,l.len+=1),a.shift(t,u,r,(function(t,e,r,n){var o=c.getCell(t,e);o.merge[0]+=r,o.merge[1]+=n}))}))}},{key:"delete",value:function(t){var e=this;this.changeData((function(){var r=e.rows,n=e.merges,o=e.selector,i=e.cols,c=o.range,a=o.range,l=a.sri,u=a.sci,f=a.eri,s=a.eci,h=gt(o.range.size(),2),p=h[0],y=h[1],d=l,v=p;"row"===t?r.delete(l,f):"column"===t&&(r.deleteColumn(u,s),d=c.sci,v=y,i.len-=s-u+1),n.shift(t,d,-v,(function(t,e,n,o){var i=r.getCell(t,e);i.merge[0]+=n,i.merge[1]+=o,0===i.merge[0]&&0===i.merge[1]&&delete i.merge}))}))}},{key:"scrollx",value:function(t,e){var r=this.scroll,n=this.freeze,o=this.cols,i=gt(n,2)[1],c=gt(U.rangeReduceIf(i,o.len,0,0,t,(function(t){return o.getWidth(t)})),3),a=c[0],l=c[1],u=c[2],f=l;t>0&&(f+=u),r.x!==f&&(r.ci=t>0?a:0,r.x=f,e())}},{key:"scrolly",value:function(t,e){var r=this.scroll,n=this.freeze,o=this.rows,i=gt(n,1)[0],c=gt(U.rangeReduceIf(i,o.len,0,0,t,(function(t){return o.getHeight(t)})),3),a=c[0],l=c[1],u=c[2],f=l;t>0&&(f+=u),r.y!==f&&(r.ri=t>0?a:0,r.y=f,e())}},{key:"cellRect",value:function(t,e){var r=this.rows,n=this.cols,o=n.sumWidth(0,e),i=r.sumHeight(0,t),c=r.getCell(t,e),a=n.getWidth(e),l=r.getHeight(t);if(null!==c&&c.merge){var u=gt(c.merge,2),f=u[0],s=u[1];if(f>0)for(var h=1;h<=f;h+=1)l+=r.getHeight(t+h);if(s>0)for(var p=1;p<=s;p+=1)a+=n.getWidth(e+p)}return{left:o,top:i,width:a,height:l,cell:c}}},{key:"getCell",value:function(t,e){return this.rows.getCell(t,e)}},{key:"getCellTextOrDefault",value:function(t,e){var r=this.getCell(t,e);return r&&r.text?r.text:""}},{key:"getCellStyle",value:function(t,e){var r=this.getCell(t,e);return r&&void 0!==r.style?this.styles[r.style]:null}},{key:"getCellStyleOrDefault",value:function(t,e){var r=this.styles,n=this.rows.getCell(t,e),o=n&&void 0!==n.style?r[n.style]:{};return U.merge(this.defaultStyle(),o)}},{key:"getSelectedCellStyle",value:function(){var t=this.selector,e=t.ri,r=t.ci;return this.getCellStyleOrDefault(e,r)}},{key:"setCellText",value:function(t,e,r,n){var o=this.rows,i=this.history,c=this.validations;"finished"===n?(o.setCellText(t,e,""),i.add(this.getData()),o.setCellText(t,e,r)):(o.setCellText(t,e,r),this.change(this.getData())),c.validate(t,e,r)}},{key:"freezeIsActive",value:function(){var t=gt(this.freeze,2),e=t[0],r=t[1];return e>0||r>0}},{key:"setFreeze",value:function(t,e){var r=this;this.changeData((function(){r.freeze=[t,e]}))}},{key:"freezeTotalWidth",value:function(){return this.cols.sumWidth(0,this.freeze[1])}},{key:"freezeTotalHeight",value:function(){return this.rows.sumHeight(0,this.freeze[0])}},{key:"setRowHeight",value:function(t,e){var r=this;this.changeData((function(){r.rows.setHeight(t,e)}))}},{key:"setColWidth",value:function(t,e){var r=this;this.changeData((function(){r.cols.setWidth(t,e)}))}},{key:"viewHeight",value:function(){var t=this.settings,e=t.view,r=t.showToolbar,n=t.showBottomBar,o=e.height();return n&&(o-=41),r&&(o-=41),o}},{key:"viewWidth",value:function(){return this.settings.view.width()}},{key:"freezeViewRange",value:function(){var t=gt(this.freeze,2),e=t[0],r=t[1];return new O(0,0,e-1,r-1,this.freezeTotalWidth(),this.freezeTotalHeight())}},{key:"contentRange",value:function(){var t=this.rows,e=this.cols,r=gt(t.maxCell(),2),n=r[0],o=r[1],i=t.sumHeight(0,n+1),c=e.sumWidth(0,o+1);return new O(0,0,n,o,c,i)}},{key:"exceptRowTotalHeight",value:function(t,e){var r=this.exceptRowSet,n=this.rows,o=Array.from(r),i=0;return o.forEach((function(r){if(r<t||r>e){var o=n.getHeight(r);i+=o}})),i}},{key:"viewRange",value:function(){var t=this.scroll,e=this.rows,r=this.cols,n=this.freeze,o=this.exceptRowSet,i=t.ri,c=t.ci;i<=0&&(i=gt(n,1)[0]),c<=0&&(c=gt(n,2)[1]);for(var a=0,l=0,u=[e.len,r.len],f=u[0],s=u[1],h=i;h<e.len&&(o.has(h)||(l+=e.getHeight(h),f=h),!(l>this.viewHeight()));h+=1);for(var p=c;p<r.len&&(s=p,!((a+=r.getWidth(p))>this.viewWidth()));p+=1);return new O(i,c,f,s,a,l)}},{key:"eachMergesInView",value:function(t,e){this.merges.filterIntersects(t).forEach((function(t){return e(t)}))}},{key:"hideRowsOrCols",value:function(){var t=this.rows,e=this.cols,r=this.selector,n=gt(r.size(),2),o=n[0],i=n[1],c=r.range,a=c.sri,l=c.sci,u=c.eri,f=c.eci;if(o===t.len)for(var s=l;s<=f;s+=1)e.setHide(s,!0);else if(i===e.len)for(var h=a;h<=u;h+=1)t.setHide(h,!0)}},{key:"unhideRowsOrCols",value:function(t,e){this["".concat(t,"s")].unhide(e)}},{key:"rowEach",value:function(t,e,r){for(var n=0,o=this.rows,i=this.exceptRowSet,c=bt(i),a=0,l=0;l<c.length;l+=1)c[l]<t&&(a+=1);for(var u=t+a;u<=e+a;u+=1)if(i.has(u))a+=1;else{var f=o.getHeight(u);if(f>0&&(r(u,n,f),(n+=f)>this.viewHeight()))break}}},{key:"colEach",value:function(t,e,r){for(var n=0,o=this.cols,i=t;i<=e;i+=1){var c=o.getWidth(i);if(c>0&&(r(i,n,c),(n+=c)>this.viewWidth()))break}}},{key:"defaultStyle",value:function(){return this.settings.style}},{key:"addStyle",value:function(t){for(var e=this.styles,r=0;r<e.length;r+=1){var n=e[r];if(U.equals(n,t))return r}return e.push(t),e.length-1}},{key:"changeData",value:function(t){this.history.add(this.getData()),t(),this.change(this.getData())}},{key:"setData",value:function(t){var e=this;return Object.keys(t).forEach((function(r){if("merges"===r||"rows"===r||"cols"===r||"validations"===r)e[r].setData(t[r]);else if("freeze"===r){var n=gt(y(t[r]),2),o=n[0],i=n[1];e.freeze=[i,o]}else"autofilter"===r?e.autoFilter.setData(t[r]):void 0!==t[r]&&(e[r]=t[r])})),this}},{key:"getData",value:function(){var t=this.name,e=this.freeze,r=this.styles,n=this.merges,o=this.rows,i=this.cols,c=this.validations,a=this.autoFilter;return{name:t,freeze:d(e[1],e[0]),styles:r,merges:n.getData(),rows:o.getData(),cols:i.getData(),validations:c.getData(),autofilter:a.getData()}}}])&&mt(e.prototype,r),n&&mt(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function Ct(t){return function(t){if(Array.isArray(t))return It(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||At(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function At(t,e){if(t){if("string"==typeof t)return It(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?It(t,e):void 0}}function It(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function Dt(t,e,r){t.addEventListener(e,r)}function Bt(t,e,r){t.removeEventListener(e,r)}function zt(t){t.xclickoutside&&(Bt(window.document.body,"click",t.xclickoutside),delete t.xclickoutside)}function Mt(t,e){t.xclickoutside=function(r){2===r.detail||t.contains(r.target)||(e?e(t):(t.hide(),zt(t)))},Dt(window.document.body,"click",t.xclickoutside)}function Nt(t,e,r){Dt(t,"mousemove",e),t.xEvtUp=function(n){Bt(t,"mousemove",e),Bt(t,"mouseup",t.xEvtUp),r(n)},Dt(t,"mouseup",t.xEvtUp)}function Ht(t,e,r,n){Math.abs(t)>Math.abs(e)?n(t>0?"right":"left",t,r):n(e>0?"down":"up",e,r)}function Ft(){var t=new Map;function e(e,r){var n;return t.has(e)&&(n=t.get(e),Array.isArray(n)&&n.push(r)||!1)||t.set(e,[].concat(r))}function r(e,r){var n,o;return t.has(e)&&(n=t.get(e),(o=n.indexOf(r))>=0&&n.splice(o,1)&&0===t.get(e).length&&t.delete(e))}return{get current(){return t},on:e,once:function(t,n){return e(t,(function e(){for(var o=arguments.length,i=new Array(o),c=0;c<o;c++)i[c]=arguments[c];n.call.apply(n,[null].concat(i)),r(t,e)}))},fire:function(e,r){return t.has(e)&&function(){var n,o=function(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=At(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,c=!0,a=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return c=t.done,t},e:function(t){a=!0,i=t},f:function(){try{c||null==r.return||r.return()}finally{if(a)throw i}}}}(t.get(e));try{for(o.s();!(n=o.n()).done;){var i=n.value;i.call.apply(i,[null].concat(Ct(r)))}}catch(t){o.e(t)}finally{o.f()}}()},removeListener:r,removeAllListeners:function(){t.clear()}}}var Wt="x-spreadsheet";window.devicePixelRatio;function Vt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Ut(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var $t=function(){function t(){var e=this,r=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=arguments.length>1?arguments[1]:void 0;Vt(this,t),this.moving=!1,this.vertical=r,this.el=l("div","".concat(Wt,"-resizer ").concat(r?"vertical":"horizontal")).children(this.unhideHoverEl=l("div","".concat(Wt,"-resizer-hover")).on("dblclick.stop",(function(t){return e.mousedblclickHandler(t)})).css("position","absolute").hide(),this.hoverEl=l("div","".concat(Wt,"-resizer-hover")).on("mousedown.stop",(function(t){return e.mousedownHandler(t)})),this.lineEl=l("div","".concat(Wt,"-resizer-line")).hide()).hide(),this.cRect=null,this.finishedFn=null,this.minDistance=n,this.unhideFn=function(){}}var e,r,n;return e=t,(r=[{key:"showUnhide",value:function(t){this.unhideIndex=t,this.unhideHoverEl.show()}},{key:"hideUnhide",value:function(){this.unhideHoverEl.hide()}},{key:"show",value:function(t,e){var r=this.moving,n=this.vertical,o=this.hoverEl,i=this.lineEl,c=this.el,a=this.unhideHoverEl;if(!r){this.cRect=t;var l=t.left,u=t.top,f=t.width,s=t.height;c.offset({left:n?l+f-5:l,top:n?u:u+s-5}).show(),o.offset({width:n?5:f,height:n?s:5}),i.offset({width:n?0:e.width,height:n?e.height:0}),a.offset({left:n?5-f:l,top:n?u:5-s,width:n?5:f,height:n?s:5})}}},{key:"hide",value:function(){this.el.offset({left:0,top:0}).hide(),this.hideUnhide()}},{key:"mousedblclickHandler",value:function(){this.unhideIndex&&this.unhideFn(this.unhideIndex)}},{key:"mousedownHandler",value:function(t){var e=this,r=t,n=this.el,o=this.lineEl,i=this.cRect,c=this.vertical,a=this.minDistance,l=c?i.width:i.height;o.show(),Nt(window,(function(t){e.moving=!0,null!==r&&1===t.buttons&&(c?(l+=t.movementX)>a&&n.css("left","".concat(i.left+l,"px")):(l+=t.movementY)>a&&n.css("top","".concat(i.top+l,"px")),r=t)}),(function(){r=null,o.hide(),e.moving=!1,e.hide(),e.finishedFn&&(l<a&&(l=a),e.finishedFn(i,l))}))}}])&&Ut(e.prototype,r),n&&Ut(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function Lt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var qt=function(){function t(e){var r=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.vertical=e,this.moveFn=null,this.el=l("div","".concat(Wt,"-scrollbar ").concat(e?"vertical":"horizontal")).child(this.contentEl=l("div","")).on("mousemove.stop",(function(){})).on("scroll.stop",(function(t){var e=t.target,n=e.scrollTop,o=e.scrollLeft;r.moveFn&&r.moveFn(r.vertical?n:o,t)}))}var e,r,n;return e=t,(r=[{key:"move",value:function(t){return this.el.scroll(t),this}},{key:"scroll",value:function(){return this.el.scroll()}},{key:"set",value:function(t,e){var r=t-1;if(e>r){var n=this.vertical?"height":"width";this.el.css(n,"".concat(r-15,"px")).show(),this.contentEl.css(this.vertical?"width":"height","1px").css(n,"".concat(e,"px"))}else this.el.hide();return this}}])&&Lt(e.prototype,r),n&&Lt(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function Yt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Xt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Kt(t,e,r){return e&&Xt(t.prototype,e),r&&Xt(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}var Zt=10,Jt=function(){function t(){var e=this,r=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];Yt(this,t),this.useHideInput=r,this.autoFocus=n,this.inputChange=function(){},this.cornerEl=l("div","".concat(Wt,"-selector-corner")),this.areaEl=l("div","".concat(Wt,"-selector-area")).child(this.cornerEl).hide(),this.clipboardEl=l("div","".concat(Wt,"-selector-clipboard")).hide(),this.autofillEl=l("div","".concat(Wt,"-selector-autofill")).hide(),this.el=l("div","".concat(Wt,"-selector")).css("z-index","".concat(Zt)).children(this.areaEl,this.clipboardEl,this.autofillEl).hide(),r&&(this.hideInput=l("input","").on("compositionend",(function(t){e.inputChange(t.target.value)})),this.el.child(this.hideInputDiv=l("div","hide-input").child(this.hideInput)),this.el.child(this.hideInputDiv=l("div","hide-input").child(this.hideInput))),Zt+=1}return Kt(t,[{key:"setOffset",value:function(t){return this.el.offset(t).show(),this}},{key:"hide",value:function(){return this.el.hide(),this}},{key:"setAreaOffset",value:function(t){var e=t.left,r=t.top,n={width:t.width-3+.8,height:t.height-3+.8,left:e-.8,top:r-.8};this.areaEl.offset(n).show(),this.useHideInput&&(this.hideInputDiv.offset(n),this.autoFocus?this.hideInput.val("").focus():this.hideInput.val(""))}},{key:"setClipboardOffset",value:function(t){var e=t.left,r=t.top,n=t.width,o=t.height;this.clipboardEl.offset({left:e,top:r,width:n-5,height:o-5})}},{key:"showAutofill",value:function(t){var e=t.left,r=t.top,n=t.width,o=t.height;this.autofillEl.offset({width:n-3,height:o-3,left:e,top:r}).show()}},{key:"hideAutofill",value:function(){this.autofillEl.hide()}},{key:"showClipboard",value:function(){this.clipboardEl.show()}},{key:"hideClipboard",value:function(){this.clipboardEl.hide()}}]),t}();function Gt(t){var e=this.data,r=t.left,n=t.top,o=t.width,i=t.height,c=t.scroll,a=t.l,l=t.t,u=e.freezeTotalWidth(),f=e.freezeTotalHeight(),s=r-u;u>a&&(s-=c.x);var h=n-f;return f>l&&(h-=c.y),{left:s,top:h,width:o,height:i}}function Qt(t){var e=this.data,r=t.left,n=t.width,o=t.height,i=t.l,c=t.t,a=t.scroll,l=e.freezeTotalWidth(),u=r-l;return l>i&&(u-=a.x),{left:u,top:c,width:n,height:o}}function te(t){var e=this.data,r=t.top,n=t.width,o=t.height,i=t.l,c=t.t,a=t.scroll,l=e.freezeTotalHeight(),u=r-l;return l>c&&(u-=a.y),{left:i,top:u,width:n,height:o}}function ee(t){this.br.setAreaOffset(Gt.call(this,t))}function re(t){this.tl.setAreaOffset(t)}function ne(t){this.t.setAreaOffset(Qt.call(this,t))}function oe(t){this.l.setAreaOffset(te.call(this,t))}function ie(t){this.l.setClipboardOffset(te.call(this,t))}function ce(t){this.br.setClipboardOffset(Gt.call(this,t))}function ae(t){this.tl.setClipboardOffset(t)}function le(t){this.t.setClipboardOffset(Qt.call(this,t))}function ue(t){ee.call(this,t),re.call(this,t),ne.call(this,t),oe.call(this,t)}function fe(t){ce.call(this,t),ae.call(this,t),le.call(this,t),ie.call(this,t)}var se=function(){function t(e){var r=this;Yt(this,t);var n=e.settings.autoFocus;this.inputChange=function(){},this.data=e,this.br=new Jt(!0,n),this.t=new Jt,this.l=new Jt,this.tl=new Jt,this.br.inputChange=function(t){r.inputChange(t)},this.br.el.show(),this.offset=null,this.areaOffset=null,this.indexes=null,this.range=null,this.arange=null,this.el=l("div","".concat(Wt,"-selectors")).children(this.tl.el,this.t.el,this.l.el,this.br.el).hide(),this.lastri=-1,this.lastci=-1,Zt+=1}return Kt(t,[{key:"resetData",value:function(t){this.data=t,this.range=t.selector.range,this.resetAreaOffset()}},{key:"hide",value:function(){this.el.hide()}},{key:"resetOffset",value:function(){var t=this.data,e=this.tl,r=this.t,n=this.l,o=this.br,i=t.freezeTotalHeight(),c=t.freezeTotalWidth();i>0||c>0?(e.setOffset({width:c,height:i}),r.setOffset({left:c,height:i}),n.setOffset({top:i,width:c}),o.setOffset({left:c,top:i})):(e.hide(),r.hide(),n.hide(),o.setOffset({left:0,top:0}))}},{key:"resetAreaOffset",value:function(){var t=this.data.getSelectedRect(),e=this.data.getClipboardRect();ue.call(this,t),fe.call(this,e),this.resetOffset()}},{key:"resetBRTAreaOffset",value:function(){var t=this.data.getSelectedRect(),e=this.data.getClipboardRect();ee.call(this,t),ne.call(this,t),ce.call(this,e),le.call(this,e),this.resetOffset()}},{key:"resetBRLAreaOffset",value:function(){var t=this.data.getSelectedRect(),e=this.data.getClipboardRect();ee.call(this,t),oe.call(this,t),ce.call(this,e),ie.call(this,e),this.resetOffset()}},{key:"set",value:function(t,e){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=this.data,o=n.calSelectedRangeByStart(t,e),i=o.sri,c=o.sci;if(r){var a=t,l=e;t<0&&(a=0),e<0&&(l=0),n.selector.setIndexes(a,l),this.indexes=[a,l]}this.moveIndexes=[i,c],this.range=o,this.resetAreaOffset(),this.el.show()}},{key:"setEnd",value:function(t,e){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=this.data,o=this.lastri,i=this.lastci;if(r){if(t===o&&e===i)return;this.lastri=t,this.lastci=e}this.range=n.calSelectedRangeByEnd(t,e),ue.call(this,this.data.getSelectedRect())}},{key:"reset",value:function(){var t=this.data.selector.range,e=t.eri,r=t.eci;this.setEnd(e,r)}},{key:"showAutofill",value:function(t,e){if(-1!==t||-1!==e){var r=this.range,n=r.sri,o=r.sci,i=r.eri,c=r.eci,a=t,l=e,u=n-t,f=i-t,s=c-e;if(o-e>0)this.arange=new O(n,l,i,o-1);else if(u>0)this.arange=new O(a,o,n-1,c);else if(s<0)this.arange=new O(n,c+1,i,l);else{if(!(f<0))return void(this.arange=null);this.arange=new O(i+1,o,a,c)}if(null!==this.arange){var h=this.data.getRect(this.arange);h.width+=2,h.height+=2;var p=this.br,y=this.l,d=this.t,v=this.tl;p.showAutofill(Gt.call(this,h)),y.showAutofill(te.call(this,h)),d.showAutofill(Qt.call(this,h)),v.showAutofill(h)}}}},{key:"hideAutofill",value:function(){var t=this;["br","l","t","tl"].forEach((function(e){t[e].hideAutofill()}))}},{key:"showClipboard",value:function(){var t=this,e=this.data.getClipboardRect();fe.call(this,e),["br","l","t","tl"].forEach((function(e){t[e].showClipboard()}))}},{key:"hideClipboard",value:function(){var t=this;["br","l","t","tl"].forEach((function(e){t[e].hideClipboard()}))}}]),t}();function he(t){return function(t){if(Array.isArray(t))return pe(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return pe(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return pe(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function pe(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function ye(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function de(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function ve(t){t.preventDefault(),t.stopPropagation();var e=this.filterItems;e.length<=0||(this.itemIndex>=0&&e[this.itemIndex].toggle(),this.itemIndex-=1,this.itemIndex<0&&(this.itemIndex=e.length-1),e[this.itemIndex].toggle())}function be(t){t.stopPropagation();var e=this.filterItems;e.length<=0||(this.itemIndex>=0&&e[this.itemIndex].toggle(),this.itemIndex+=1,this.itemIndex>e.length-1&&(this.itemIndex=0),e[this.itemIndex].toggle())}function me(t){t.preventDefault();var e=this.filterItems;e.length<=0||(t.stopPropagation(),this.itemIndex<0&&(this.itemIndex=0),e[this.itemIndex].el.click(),this.hide())}function ge(t){var e=t.keyCode;switch(t.ctrlKey&&t.stopPropagation(),e){case 37:t.stopPropagation();break;case 38:ve.call(this,t);break;case 39:t.stopPropagation();break;case 40:be.call(this,t);break;case 13:case 9:me.call(this,t);break;default:t.stopPropagation()}}var we=function(){function t(e,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"200px";ye(this,t),this.filterItems=[],this.items=e,this.el=l("div","".concat(Wt,"-suggest")).css("width",n).hide(),this.itemClick=r,this.itemIndex=-1}var e,r,n;return e=t,(r=[{key:"setOffset",value:function(t){this.el.cssRemoveKeys("top","bottom").offset(t)}},{key:"hide",value:function(){var t=this.el;this.filterItems=[],this.itemIndex=-1,t.hide(),zt(this.el.parent())}},{key:"setItems",value:function(t){this.items=t}},{key:"search",value:function(t){var e,r=this,n=this.items;if(/^\s*$/.test(t)||(n=n.filter((function(e){return(e.key||e).startsWith(t.toUpperCase())}))),n=n.map((function(t){var e=t.title;e?"function"==typeof e&&(e=e()):e=t;var n=l("div","".concat(Wt,"-item")).child(e).on("click.stop",(function(){r.itemClick(t),r.hide()}));return t.label&&n.child(l("div","label").html(t.label)),n})),this.filterItems=n,!(n.length<=0)){var o=this.el;(e=o.html("")).children.apply(e,he(n)).show(),Mt(o.parent(),(function(){r.hide()}))}}},{key:"bindInputEvents",value:function(t){var e=this;t.on("keydown",(function(t){return ge.call(e,t)}))}}])&&de(e.prototype,r),n&&de(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function Oe(t){return(Oe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ke(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function je(t,e){return(je=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Se(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=Ee(t);if(e){var o=Ee(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return xe(this,r)}}function xe(t,e){if(e&&("object"===Oe(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Ee(t){return(Ee=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Pe=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&je(t,e)}(i,t);var e,r,n,o=Se(i);function i(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this,"div","".concat(Wt,"-icon"))).iconNameEl=l("div","".concat(Wt,"-icon-img ").concat(t)),e.child(e.iconNameEl),e}return e=i,(r=[{key:"setName",value:function(t){this.iconNameEl.className("".concat(Wt,"-icon-img ").concat(t))}}])&&ke(e.prototype,r),n&&ke(e,n),Object.defineProperty(e,"prototype",{writable:!1}),i}(a);function _e(t){return function(t){if(Array.isArray(t))return Re(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return Re(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Re(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Re(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function Te(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Ce(t,e){t.setMonth(t.getMonth()+e)}function Ae(t,e){var r=new Date(t);return r.setDate(e-t.getDay()+1),r}var Ie=function(){function t(e){var r,n=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.value=e,this.cvalue=new Date(e),this.headerLeftEl=l("div","calendar-header-left"),this.bodyEl=l("tbody",""),this.buildAll(),this.el=l("div","x-spreadsheet-calendar").children(l("div","calendar-header").children(this.headerLeftEl,l("div","calendar-header-right").children(l("a","calendar-prev").on("click.stop",(function(){return n.prev()})).child(new Pe("chevron-left")),l("a","calendar-next").on("click.stop",(function(){return n.next()})).child(new Pe("chevron-right")))),l("table","calendar-body").children(l("thead","").child((r=l("tr","")).children.apply(r,_e(et("calendar.weeks").map((function(t){return l("th","cell").child(t)}))))),this.bodyEl)),this.selectChange=function(){}}var e,r,n;return e=t,(r=[{key:"setValue",value:function(t){this.value=t,this.cvalue=new Date(t),this.buildAll()}},{key:"prev",value:function(){Ce(this.value,-1),this.buildAll()}},{key:"next",value:function(){Ce(this.value,1),this.buildAll()}},{key:"buildAll",value:function(){this.buildHeaderLeft(),this.buildBody()}},{key:"buildHeaderLeft",value:function(){var t=this.value;this.headerLeftEl.html("".concat(et("calendar.months")[t.getMonth()]," ").concat(t.getFullYear()))}},{key:"buildBody",value:function(){var t,e=this,r=this.value,n=this.cvalue,o=this.bodyEl,i=function(t,e,r){for(var n=new Date(t,e,1,23,59,59),o=[[],[],[],[],[],[]],i=0;i<6;i+=1)for(var c=0;c<7;c+=1){var a=Ae(n,7*i+c),l=a.getMonth()!==e,u=a.getMonth()===r.getMonth()&&a.getDate()===r.getDate();o[i][c]={d:a,disabled:l,active:u}}return o}(r.getFullYear(),r.getMonth(),n).map((function(t){var r,n=t.map((function(t){var r="cell";return t.disabled&&(r+=" disabled"),t.active&&(r+=" active"),l("td","").child(l("div",r).on("click.stop",(function(){e.selectChange(t.d)})).child(t.d.getDate().toString()))}));return(r=l("tr","")).children.apply(r,_e(n))}));(t=o.html("")).children.apply(t,_e(i))}}])&&Te(e.prototype,r),n&&Te(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function De(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var Be=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.calendar=new Ie(new Date),this.el=l("div","".concat(Wt,"-datepicker")).child(this.calendar.el).hide()}var e,r,n;return e=t,(r=[{key:"setValue",value:function(t){var e=this.calendar;return"string"==typeof t?/^\d{4}-\d{1,2}-\d{1,2}$/.test(t)&&e.setValue(new Date(t.replace(new RegExp("-","g"),"/"))):t instanceof Date&&e.setValue(t),this}},{key:"change",value:function(t){var e=this;this.calendar.selectChange=function(r){t(r),e.hide()}}},{key:"show",value:function(){this.el.show()}},{key:"hide",value:function(){this.el.hide()}}])&&De(e.prototype,r),n&&De(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function ze(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Me(t){return function(t){if(Array.isArray(t))return Ne(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return Ne(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Ne(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ne(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function He(){var t=this.inputText;if(!/^\s*$/.test(t)){var e=this.textlineEl,r=this.textEl,n=this.areaOffset,o=t.split("\n"),i=Math.max.apply(Math,Me(o.map((function(t){return t.length})))),c=e.offset().width/t.length,a=(i+1)*c+5,l=this.viewFn().width-n.left-c,u=o.length;if(a>n.width){var f=a;a>l&&(f=l,u+=parseInt(a/l,10),u+=a%l>0?1:0),r.css("width","".concat(f,"px"))}(u*=this.rowHeight)>n.height&&r.css("height","".concat(u,"px"))}}function Fe(t,e){var r=t.target,n=r.value,o=r.selectionEnd,i="".concat(n.slice(0,o)).concat(e).concat(n.slice(o));r.value=i,r.setSelectionRange(o+1,o+1),this.inputText=i,this.textlineEl.html(i),He.call(this)}function We(t){var e=t.keyCode,r=t.altKey;13!==e&&9!==e&&t.stopPropagation(),13===e&&r&&(Fe.call(this,t,"\n"),t.stopPropagation()),13!==e||r||t.preventDefault()}function Ve(t){var e=t.target.value,r=this.suggest,n=this.textlineEl,o=this.validator,i=this.cell;if(null!==i)if("editable"in i&&!0===i.editable||void 0===i.editable){if(this.inputText=e,o)"list"===o.type?r.search(e):r.hide();else{var c=e.lastIndexOf("=");-1!==c?r.search(e.substring(c+1)):r.hide()}n.html(e),He.call(this),this.change("input",e)}else t.target.value=i.text||"";else{if(this.inputText=e,o)"list"===o.type?r.search(e):r.hide();else{var a=e.lastIndexOf("=");-1!==a?r.search(e.substring(a+1)):r.hide()}n.html(e),He.call(this),this.change("input",e)}}function Ue(t){var e=this.textEl.el;setTimeout((function(){e.focus(),e.setSelectionRange(t,t)}),0)}function $e(t,e){var r=this.textEl,n=this.textlineEl;r.el.blur(),r.val(t),n.html(t),Ue.call(this,e)}function Le(t){var e=this.inputText,r=this.validator,n=0;if(r&&"list"===r.type)this.inputText=t,n=this.inputText.length;else{var o=e.lastIndexOf("="),i=e.substring(0,o+1),c=e.substring(o+1);c=-1!==c.indexOf(")")?c.substring(c.indexOf(")")):"",this.inputText="".concat(i+t.key,"("),n=this.inputText.length,this.inputText+=")".concat(c)}$e.call(this,this.inputText,n)}function qe(){this.suggest.setItems(this.formulas)}var Ye=function(){function t(e,r,n){var o=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.viewFn=r,this.rowHeight=n,this.formulas=e,this.suggest=new we(e,(function(t){Le.call(o,t)})),this.datepicker=new Be,this.datepicker.change((function(t){o.setText(function(t){var e=t.getMonth()+1,r=t.getDate();return e<10&&(e="0".concat(e)),r<10&&(r="0".concat(r)),"".concat(t.getFullYear(),"-").concat(e,"-").concat(r)}(t)),o.clear()})),this.areaEl=l("div","".concat(Wt,"-editor-area")).children(this.textEl=l("textarea","").on("input",(function(t){return Ve.call(o,t)})).on("paste.stop",(function(){})).on("keydown",(function(t){return We.call(o,t)})),this.textlineEl=l("div","textline"),this.suggest.el,this.datepicker.el).on("mousemove.stop",(function(){})).on("mousedown.stop",(function(){})),this.el=l("div","".concat(Wt,"-editor")).child(this.areaEl).hide(),this.suggest.bindInputEvents(this.textEl),this.areaOffset=null,this.freeze={w:0,h:0},this.cell=null,this.inputText="",this.change=function(){}}var e,r,n;return e=t,(r=[{key:"setFreezeLengths",value:function(t,e){this.freeze.w=t,this.freeze.h=e}},{key:"clear",value:function(){""!==this.inputText&&this.change("finished",this.inputText),this.cell=null,this.areaOffset=null,this.inputText="",this.el.hide(),this.textEl.val(""),this.textlineEl.html(""),qe.call(this),this.datepicker.hide()}},{key:"setOffset",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"top",r=this.textEl,n=this.areaEl,o=this.suggest,i=this.freeze,c=this.el;if(t){this.areaOffset=t;var a=t.left,l=t.top,u=t.width,f=t.height,s=t.l,h=t.t,p={left:0,top:0};i.w>s&&i.h>h||(i.w<s&&i.h<h?(p.left=i.w,p.top=i.h):i.w>s?p.top=i.h:i.h>h&&(p.left=i.w)),c.offset(p),n.offset({left:a-p.left-.8,top:l-p.top-.8}),r.offset({width:u-9+.8,height:f-3+.8});var y={left:0};y[e]=f,o.setOffset(y),o.hide()}}},{key:"setCell",value:function(t,e){var r=this.el,n=this.datepicker,o=this.suggest;r.show(),this.cell=t;var i=t&&t.text||"";if(this.setText(i),this.validator=e,e){var c=e.type;"date"===c&&(n.show(),/^\s*$/.test(i)||n.setValue(i)),"list"===c&&(o.setItems(e.values()),o.search(""))}}},{key:"setText",value:function(t){this.inputText=t,$e.call(this,t,t.length),He.call(this)}}])&&ze(e.prototype,r),n&&ze(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function Xe(t){return(Xe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ke(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Ze(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Je(t,e){return(Je=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Ge(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=tr(t);if(e){var o=tr(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return Qe(this,r)}}function Qe(t,e){if(e&&("object"===Xe(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function tr(t){return(tr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var er=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Je(t,e)}(i,t);var e,r,n,o=Ge(i);function i(t){var e,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return Ze(this,i),(e=o.call(this,"div","".concat(Wt,"-button ").concat(r))).child(et("button.".concat(t))),e}return e=i,r&&Ke(e.prototype,r),n&&Ke(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}(a);function rr(t){return function(t){if(Array.isArray(t))return ir(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||or(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function nr(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null==r)return;var n,o,i=[],c=!0,a=!1;try{for(r=r.call(t);!(c=(n=r.next()).done)&&(i.push(n.value),!e||i.length!==e);c=!0);}catch(t){a=!0,o=t}finally{try{c||null==r.return||r.return()}finally{if(a)throw o}}return i}(t,e)||or(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function or(t,e){if(t){if("string"==typeof t)return ir(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?ir(t,e):void 0}}function ir(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function cr(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ar(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function lr(t,e,r){return e&&ar(t.prototype,e),r&&ar(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function ur(){return window.devicePixelRatio||1}function fr(){return ur()-.5}function sr(t){return parseInt(t*ur(),10)}function hr(t){var e=sr(t);return e>0?e-.5:.5}var pr=function(){function t(e,r,n,o){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;cr(this,t),this.x=e,this.y=r,this.width=n,this.height=o,this.padding=i,this.bgcolor="#ffffff",this.borderTop=null,this.borderRight=null,this.borderBottom=null,this.borderLeft=null}return lr(t,[{key:"setBorders",value:function(t){var e=t.top,r=t.bottom,n=t.left,o=t.right;e&&(this.borderTop=e),o&&(this.borderRight=o),r&&(this.borderBottom=r),n&&(this.borderLeft=n)}},{key:"innerWidth",value:function(){return this.width-2*this.padding-2}},{key:"innerHeight",value:function(){return this.height-2*this.padding-2}},{key:"textx",value:function(t){var e=this.width,r=this.padding,n=this.x;return"left"===t?n+=r:"center"===t?n+=e/2:"right"===t&&(n+=e-r),n}},{key:"texty",value:function(t,e){var r=this.height,n=this.padding,o=this.y;return"top"===t?o+=n:"middle"===t?o+=r/2-e/2:"bottom"===t&&(o+=r-n-e),o}},{key:"topxys",value:function(){var t=this.x,e=this.y;return[[t,e],[t+this.width,e]]}},{key:"rightxys",value:function(){var t=this.x,e=this.y,r=this.width;return[[t+r,e],[t+r,e+this.height]]}},{key:"bottomxys",value:function(){var t=this.x,e=this.y,r=this.width,n=this.height;return[[t,e+n],[t+r,e+n]]}},{key:"leftxys",value:function(){var t=this.x,e=this.y;return[[t,e],[t,e+this.height]]}}]),t}();function yr(t,e,r,n,o,i,c){var a={x:0,y:0};"underline"===t?a.y="bottom"===o?0:"top"===o?-(i+2):-i/2:"strike"===t&&("bottom"===o?a.y=i/2:"top"===o&&(a.y=-(i/2+2))),"center"===n?a.x=c/2:"right"===n&&(a.x=c),this.line([e-a.x,r-a.y],[e-a.x+c,r-a.y])}var dr=function(){function t(e,r,n){cr(this,t),this.el=e,this.ctx=e.getContext("2d"),this.resize(r,n),this.ctx.scale(ur(),ur())}return lr(t,[{key:"resize",value:function(t,e){this.el.style.width="".concat(t,"px"),this.el.style.height="".concat(e,"px"),this.el.width=sr(t),this.el.height=sr(e)}},{key:"clear",value:function(){var t=this.el,e=t.width,r=t.height;return this.ctx.clearRect(0,0,e,r),this}},{key:"attr",value:function(t){return Object.assign(this.ctx,t),this}},{key:"save",value:function(){return this.ctx.save(),this.ctx.beginPath(),this}},{key:"restore",value:function(){return this.ctx.restore(),this}},{key:"beginPath",value:function(){return this.ctx.beginPath(),this}},{key:"translate",value:function(t,e){return this.ctx.translate(sr(t),sr(e)),this}},{key:"scale",value:function(t,e){return this.ctx.scale(t,e),this}},{key:"clearRect",value:function(t,e,r,n){return this.ctx.clearRect(t,e,r,n),this}},{key:"backGround",value:function(t,e,r,n,o){var i=new Image;i.crossOrigin="Anonymous";var c=this;return i.onload=function(){c.ctx.globalAlpha=.6,c.ctx.drawImage(i,sr(e)-.5,sr(r)-.5,sr(n),sr(o))},i.src=t,this}},{key:"fillRect",value:function(t,e,r,n){return this.ctx.fillRect(sr(t)-.5,sr(e)-.5,sr(r),sr(n)),this}},{key:"fillText",value:function(t,e,r){return this.ctx.fillText(t,sr(e),sr(r)),this}},{key:"text",value:function(t,e){var r=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=this.ctx,c=n.align,a=n.valign,l=n.font,u=n.color,f=n.strike,s=n.underline,h=e.textx(c);i.save(),i.beginPath(),this.attr({textAlign:c,textBaseline:a,font:"".concat(l.italic?"italic":""," ").concat(l.bold?"bold":""," ").concat(sr(l.size),"px ").concat(l.name),fillStyle:u,strokeStyle:u});var p="".concat(t).split("\n"),y=e.innerWidth(),d=[];p.forEach((function(t){var e=i.measureText(t).width;if(o&&e>sr(y)){for(var r={w:0,len:0,start:0},n=0;n<t.length;n+=1)r.w>=sr(y)&&(d.push(t.substr(r.start,r.len)),r={w:0,len:0,start:n}),r.len+=1,r.w+=i.measureText(t[n]).width+1;r.len>0&&d.push(t.substr(r.start,r.len))}else d.push(t)}));var v=(d.length-1)*(l.size+2),b=e.texty(a,v);return d.forEach((function(t){var e=i.measureText(t).width;r.fillText(t,h,b),f&&yr.call(r,"strike",h,b,c,a,l.size,e),s&&yr.call(r,"underline",h,b,c,a,l.size,e),b+=l.size+2})),i.restore(),this}},{key:"border",value:function(t,e){var r=this.ctx;return r.lineWidth=fr,r.strokeStyle=e,"medium"===t?r.lineWidth=sr(2)-.5:"thick"===t?r.lineWidth=sr(3):"dashed"===t?r.setLineDash([sr(3),sr(2)]):"dotted"===t?r.setLineDash([sr(1),sr(1)]):"double"===t&&r.setLineDash([sr(2),0]),this}},{key:"line",value:function(){var t=this.ctx;if(arguments.length>1){t.beginPath();var e=arguments.length<=0?void 0:arguments[0],r=nr(e,2),n=r[0],o=r[1];t.moveTo(hr(n),hr(o));for(var i=1;i<arguments.length;i+=1){var c=i<0||arguments.length<=i?void 0:arguments[i],a=nr(c,2),l=a[0],u=a[1];t.lineTo(hr(l),hr(u))}t.stroke()}return this}},{key:"strokeBorders",value:function(t){var e=this.ctx;e.save();var r=t.borderTop,n=t.borderRight,o=t.borderBottom,i=t.borderLeft;r&&(this.border.apply(this,rr(r)),this.line.apply(this,rr(t.topxys()))),n&&(this.border.apply(this,rr(n)),this.line.apply(this,rr(t.rightxys()))),o&&(this.border.apply(this,rr(o)),this.line.apply(this,rr(t.bottomxys()))),i&&(this.border.apply(this,rr(i)),this.line.apply(this,rr(t.leftxys()))),e.restore()}},{key:"dropdown",value:function(t){var e=this.ctx,r=t.x,n=t.y,o=r+t.width-15,i=n+t.height-15;e.save(),e.beginPath(),e.moveTo(sr(o),sr(i)),e.lineTo(sr(o+8),sr(i)),e.lineTo(sr(o+4),sr(i+6)),e.closePath(),e.fillStyle="rgba(0, 0, 0, .45)",e.fill(),e.restore()}},{key:"error",value:function(t){var e=this.ctx,r=t.x,n=t.y,o=r+t.width-1;e.save(),e.beginPath(),e.moveTo(sr(o-8),sr(n-1)),e.lineTo(sr(o),sr(n-1)),e.lineTo(sr(o),sr(n+8)),e.closePath(),e.fillStyle="rgba(255, 0, 0, .65)",e.fill(),e.restore()}},{key:"frozen",value:function(t){var e=this.ctx,r=t.x,n=t.y,o=r+t.width-1;e.save(),e.beginPath(),e.moveTo(sr(o-8),sr(n-1)),e.lineTo(sr(o),sr(n-1)),e.lineTo(sr(o),sr(n+8)),e.closePath(),e.fillStyle="rgba(0, 255, 0, .85)",e.fill(),e.restore()}},{key:"rect",value:function(t,e){var r=this.ctx,n=t.x,o=t.y,i=t.width,c=t.height,a=t.bgcolor;r.save(),r.beginPath(),r.fillStyle=a||"#fff",r.rect(hr(n+1),hr(o+1),sr(i-2),sr(c-2)),r.clip(),r.fill(),e(),r.restore()}}]),t}(),vr=[{key:"Arial",title:"Arial"},{key:"Helvetica",title:"Helvetica"},{key:"Source Sans Pro",title:"Source Sans Pro"},{key:"Comic Sans MS",title:"Comic Sans MS"},{key:"Courier New",title:"Courier New"},{key:"Verdana",title:"Verdana"},{key:"Lato",title:"Lato"}],br=[{pt:7.5,px:10},{pt:8,px:11},{pt:9,px:12},{pt:10,px:13},{pt:10.5,px:14},{pt:11,px:15},{pt:12,px:16},{pt:14,px:18.7},{pt:15,px:20},{pt:16,px:21.3},{pt:18,px:24},{pt:22,px:29.3},{pt:24,px:32},{pt:26,px:34.7},{pt:36,px:48},{pt:42,px:56}];function mr(t){for(var e=0;e<br.length;e+=1){var r=br[e];if(r.pt===t)return r.px}return t}function gr(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null==r)return;var n,o,i=[],c=!0,a=!1;try{for(r=r.call(t);!(c=(n=r.next()).done)&&(i.push(n.value),!e||i.length!==e);c=!0);}catch(t){a=!0,o=t}finally{try{c||null==r.return||r.return()}finally{if(a)throw o}}return i}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return wr(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return wr(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function wr(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}var Or=function(t){for(var e=[],r=[],n=[],o=0,i="",c=1,a="",l=0;l<t.length;l+=1){var u=t.charAt(l);if(" "!==u){if(u>="a"&&u<="z")n.push(u.toUpperCase());else if(u>="0"&&u<="9"||u>="A"&&u<="Z"||"."===u)n.push(u);else if('"'===u){for(l+=1;'"'!==t.charAt(l);)n.push(t.charAt(l)),l+=1;r.push('"'.concat(n.join(""))),n=[]}else if("-"===u&&/[+\-*/,(]/.test(a))n.push(u);else{if("("!==u&&n.length>0&&r.push(n.join("")),")"===u){var f=e.pop();if(2===o)try{for(var s=gr(y(r.pop()),2),h=s[0],p=s[1],v=gr(y(r.pop()),2),b=v[0],m=v[1],g=0,w=b;w<=h;w+=1)for(var O=m;O<=p;O+=1)r.push(d(w,O)),g+=1;r.push([f,g])}catch(t){}else if(1===o||3===o)3===o&&r.push(i),r.push([f,c]),c=1;else for(;"("!==f&&(r.push(f),!(e.length<=0));)f=e.pop();o=0}else if("="===u||">"===u||"<"===u){var k=t.charAt(l+1);i=u,"="!==k&&"-"!==k||(i+=k,l+=1),o=3}else if(":"===u)o=2;else if(","===u)3===o&&r.push(i),o=1,c+=1;else if("("===u&&n.length>0)e.push(n.join(""));else{if(e.length>0&&("+"===u||"-"===u)){var j=e[e.length-1];if("("!==j&&r.push(e.pop()),"*"===j||"/"===j)for(;e.length>0&&"("!==(j=e[e.length-1]);)r.push(e.pop())}else if(e.length>0){var S=e[e.length-1];"*"!==S&&"/"!==S||r.push(e.pop())}e.push(u)}n=[]}a=u}}for(n.length>0&&r.push(n.join(""));e.length>0;)r.push(e.pop());return r},kr=function(t,e){var r=gr(t,1)[0],n=t;if('"'===r)return t.substring(1);var o=1;if("-"===r&&(n=t.substring(1),o=-1),n[0]>="0"&&n[0]<="9")return o*Number(n);var i=gr(y(n),2);return o*e(i[0],i[1])},jr=function(t,e,r,n){for(var o=[],i=0;i<t.length;i+=1){var c=t[i],a=c[0];if("+"===c){var l=o.pop();o.push(V("+",o.pop(),l))}else if("-"===c)if(1===o.length){var u=o.pop();o.push(V("*",u,-1))}else{var f=o.pop();o.push(V("-",o.pop(),f))}else if("*"===c)o.push(V("*",o.pop(),o.pop()));else if("/"===c){var s=o.pop();o.push(V("/",o.pop(),s))}else if("="===a||">"===a||"<"===a){var h=o.pop();Number.isNaN(h)||(h=Number(h));var p=o.pop();Number.isNaN(p)||(p=Number(p));var y=!1;"="===a?y=p===h:">"===c?y=p>h:">="===c?y=p>=h:"<"===c?y=p<h:"<="===c&&(y=p<=h),o.push(y)}else if(Array.isArray(c)){for(var d=gr(c,2),v=d[0],b=d[1],m=[],g=0;g<b;g+=1)m.push(o.pop());o.push(e[v].render(m.reverse()))}else{if(n.includes(c))return 0;(a>="a"&&a<="z"||a>="A"&&a<="Z")&&n.push(c),o.push(kr(c,r)),n.pop()}}return o[0]},Sr=function t(e,r,n){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];if("="===e[0]){var i=Or(e.substring(1));return i.length<=0?e:jr(i,r,(function(e,i){return t(n(e,i),r,n,o)}),o)}return e};function xr(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null==r)return;var n,o,i=[],c=!0,a=!1;try{for(r=r.call(t);!(c=(n=r.next()).done)&&(i.push(n.value),!e||i.length!==e);c=!0);}catch(t){a=!0,o=t}finally{try{c||null==r.return||r.return()}finally{if(a)throw o}}return i}(t,e)||Pr(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Er(t){return function(t){if(Array.isArray(t))return _r(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||Pr(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Pr(t,e){if(t){if("string"==typeof t)return _r(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_r(t,e):void 0}}function _r(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}var Rr=[{key:"SUM",title:rt("formula.sum"),render:function(t){return t.reduce((function(t,e){return V("+",t,e)}),0)}},{key:"AVERAGE",title:rt("formula.average"),render:function(t){return t.reduce((function(t,e){return Number(t)+Number(e)}),0)/t.length}},{key:"MAX",title:rt("formula.max"),render:function(t){return Math.max.apply(Math,Er(t.map((function(t){return Number(t)}))))}},{key:"MIN",title:rt("formula.min"),render:function(t){return Math.min.apply(Math,Er(t.map((function(t){return Number(t)}))))}},{key:"IF",title:rt("formula._if"),render:function(t){var e=xr(t,3),r=e[0],n=e[1],o=e[2];return r?n:o}},{key:"AND",title:rt("formula.and"),render:function(t){return t.every((function(t){return t}))}},{key:"OR",title:rt("formula.or"),render:function(t){return t.some((function(t){return t}))}},{key:"CONCAT",title:rt("formula.concat"),render:function(t){return t.join("")}}],Tr=Rr,Cr={};function Ar(t){return function(t){if(Array.isArray(t))return Br(t)}(t)||zr(t)||Dr(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ir(t){return function(t){if(Array.isArray(t))return t}(t)||zr(t)||Dr(t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Dr(t,e){if(t){if("string"==typeof t)return Br(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Br(t,e):void 0}}function Br(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function zr(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}Rr.forEach((function(t){Cr[t.key]=t}));var Mr=function(t){return t},Nr=function(t){if(/^(-?\d*.?\d*)$/.test(t)){var e=Ir(Number(t).toFixed(2).toString().split("\\.")),r=e[0],n=e.slice(1);return[r.replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1,")].concat(Ar(n))}return t},Hr=[{key:"normal",title:rt("format.normal"),type:"string",render:Mr},{key:"text",title:rt("format.text"),type:"string",render:Mr},{key:"number",title:rt("format.number"),type:"number",label:"1,000.12",render:Nr},{key:"percent",title:rt("format.percent"),type:"number",label:"10.12%",render:function(t){return"".concat(t,"%")}},{key:"rmb",title:rt("format.rmb"),type:"number",label:"￥10.00",render:function(t){return"￥".concat(Nr(t))}},{key:"usd",title:rt("format.usd"),type:"number",label:"$10.00",render:function(t){return"$".concat(Nr(t))}},{key:"eur",title:rt("format.eur"),type:"number",label:"€10.00",render:function(t){return"€".concat(Nr(t))}},{key:"date",title:rt("format.date"),type:"date",label:"26/09/2008",render:Mr},{key:"time",title:rt("format.time"),type:"date",label:"15:59:00",render:Mr},{key:"datetime",title:rt("format.datetime"),type:"date",label:"26/09/2008 15:59:00",render:Mr},{key:"duration",title:rt("format.duration"),type:"date",label:"24:01:00",render:Mr}],Fr={};function Wr(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null==r)return;var n,o,i=[],c=!0,a=!1;try{for(r=r.call(t);!(c=(n=r.next()).done)&&(i.push(n.value),!e||i.length!==e);c=!0);}catch(t){a=!0,o=t}finally{try{c||null==r.return||r.return()}finally{if(a)throw o}}return i}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return Vr(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Vr(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Vr(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function Ur(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}Hr.forEach((function(t){Fr[t.key]=t}));var $r={fillStyle:"#f4f5f8"},Lr={fillStyle:"#fff",lineWidth:fr,strokeStyle:"#e6e6e6"};function qr(t,e,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=t.cellRect(e,r),i=o.left,c=o.top,a=o.width,l=o.height;return new pr(i,c+n,a,l,5)}function Yr(t,e,r,n){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,i=e.sortedRowMap,c=e.rows,a=e.cols;if(!c.isHide(r)&&!a.isHide(n)){var l=r;i.has(r)&&(l=i.get(r));var u=e.getCell(l,n);if(null!==u){var f=!1;"editable"in u&&!1===u.editable&&(f=!0);var s=e.getCellStyleOrDefault(l,n),h=qr(e,r,n,o);h.bgcolor=s.bgcolor,void 0!==s.border&&(h.setBorders(s.border),t.strokeBorders(h)),t.rect(h,(function(){var o="";o=e.settings.evalPaused?u.text||"":Sr(u.text||"",Cr,(function(t,r){return e.getCellTextOrDefault(r,t)})),s.format&&(o=Fr[s.format].render(o));var i=Object.assign({},s.font);i.size=mr(i.size),t.text(o,h,{align:s.align,valign:s.valign,font:i,color:s.color,strike:s.strike,underline:s.underline},s.textwrap),e.validations.getError(r,n)&&t.error(h),f&&t.frozen(h)}))}}}function Xr(t){var e=this.data,r=this.draw;if(t){var n=e.autoFilter;if(!n.active())return;var o=n.hrange();t.intersects(o)&&o.each((function(t,n){var o=qr(e,t,n);r.dropdown(o)}))}}function Kr(t,e,r,n,o){var i=this.draw,c=this.data;i.save(),i.translate(e,r).translate(n,o);var a=c.exceptRowSet,l=c.exceptRowTotalHeight(t.sri,t.eri);i.save(),i.translate(0,-l),t.each((function(t,e){Yr(i,c,t,e)}),(function(t){return function(t){var e=a.has(t);if(e){var r=c.rows.getHeight(t);i.translate(0,-r)}return!e}(t)})),i.restore();var u=new Set;i.save(),i.translate(0,-l),c.eachMergesInView(t,(function(t){var e=t.sri,r=t.sci,n=t.eri;if(a.has(e)){if(!u.has(e)){u.add(e);var o=c.rows.sumHeight(e,n+1);i.translate(0,-o)}}else Yr(i,c,e,r)})),i.restore(),Xr.call(this,t),i.restore()}function Zr(t,e,r,n){var o=this.draw;o.save(),o.attr({fillStyle:"rgba(75, 137, 255, 0.08)"}).fillRect(t,e,r,n),o.restore()}function Jr(t,e,r,n,o,i){var c=this,a=this.draw,l=this.data,u=e.h,f=e.w,s=i+n,p=o+r;a.save(),a.attr($r),"all"!==t&&"left"!==t||a.fillRect(0,s,r,u),"all"!==t&&"top"!==t||a.fillRect(p,0,f,n);var y=l.selector.range,d=y.sri,v=y.sci,b=y.eri,m=y.eci;a.attr({textAlign:"center",textBaseline:"middle",font:"500 ".concat(sr(12),"px Source Sans Pro"),fillStyle:"#585757",lineWidth:fr(),strokeStyle:"#e6e6e6"}),"all"!==t&&"left"!==t||(l.rowEach(e.sri,e.eri,(function(t,e,n){var o=s+e,i=t;a.line([0,o],[r,o]),d<=i&&i<b+1&&Zr.call(c,0,o,r,n),a.fillText(i+1,r/2,o+n/2),t>0&&l.rows.isHide(t-1)&&(a.save(),a.attr({strokeStyle:"#c6c6c6"}),a.line([5,o+5],[r-5,o+5]),a.restore())})),a.line([0,u+s],[r,u+s]),a.line([r,s],[r,u+s])),"all"!==t&&"top"!==t||(l.colEach(e.sci,e.eci,(function(t,e,r){var o=p+e,i=t;a.line([o,0],[o,n]),v<=i&&i<m+1&&Zr.call(c,o,0,r,n),a.fillText(h(i),o+r/2,n/2),t>0&&l.cols.isHide(t-1)&&(a.save(),a.attr({strokeStyle:"#c6c6c6"}),a.line([o+5,5],[o+5,n-5]),a.restore())})),a.line([f+p,0],[f+p,n]),a.line([0,n],[f+p,n])),a.restore()}function Gr(t,e){var r=this.draw;r.save(),r.attr({fillStyle:"#f4f5f8"}).fillRect(0,0,t,e),r.restore()}function Qr(t,e,r,n,o){var i=t.sri,c=t.sci,a=t.eri,l=t.eci,u=t.w,f=t.h,s=this.draw,h=this.data,p=h.settings;s.save(),s.attr(Lr).translate(e+n,r+o),p.showGrid?(h.rowEach(i,a,(function(t,e,r){t!==i&&s.line([0,e],[u,e]),t===a&&s.line([0,e+r],[u,e+r])})),h.colEach(c,l,(function(t,e,r){t!==c&&s.line([e,0],[e,f]),t===l&&s.line([e+r,0],[e+r,f])})),s.restore()):s.restore()}function tn(t,e,r,n){var o=this.draw,i=this.data,c=i.viewWidth()-t,a=i.viewHeight()-e;o.save().translate(t,e).attr({strokeStyle:"rgba(75, 137, 255, .6)"}),o.line([0,n],[c,n]),o.line([r,0],[r,a]),o.restore()}function en(t,e){var r=t.imgList;r&&r.forEach((function(t){t.isbackend&&e.backGround(t.src,t.left,t.top,t.width,t.height)}))}var rn=function(){function t(e,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.el=e,this.draw=new dr(e,r.viewWidth(),r.viewHeight()),this.data=r}var e,r,n;return e=t,(r=[{key:"resetData",value:function(t){this.data=t,this.render()}},{key:"render",value:function(){var t=this.data,e=t.rows,r=t.cols.indexWidth,n=e.height;this.draw.resize(t.viewWidth(),t.viewHeight()),this.clear();var o=t.viewRange(),i=t.freezeTotalWidth(),c=t.freezeTotalHeight(),a=t.scroll,l=a.x,u=a.y;en.call(this,t,this.draw),Qr.call(this,o,r,n,i,c),Kr.call(this,o,r,n,-l,-u),Jr.call(this,"all",o,r,n,i,c),Gr.call(this,r,n);var f=Wr(t.freeze,2),s=f[0],h=f[1];if(s>0||h>0){if(s>0){var p=o.clone();p.sri=0,p.eri=s-1,p.h=c,Qr.call(this,p,r,n,i,0),Kr.call(this,p,r,n,-l,0),Jr.call(this,"top",p,r,n,i,0)}if(h>0){var y=o.clone();y.sci=0,y.eci=h-1,y.w=i,Qr.call(this,y,r,n,0,c),Jr.call(this,"left",y,r,n,0,c),Kr.call(this,y,r,n,0,-u)}var d=t.freezeViewRange();Qr.call(this,d,r,n,0,0),Jr.call(this,"all",d,r,n,0,0),Kr.call(this,d,r,n,0,0),tn.call(this,r,n,i,c)}}},{key:"clear",value:function(){this.draw.clear()}}])&&Ur(e.prototype,r),n&&Ur(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function nn(t){return function(t){if(Array.isArray(t))return on(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return on(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return on(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function on(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function cn(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var an=[["A3",11.69,16.54],["A4",8.27,11.69],["A5",5.83,8.27],["B4",9.84,13.9],["B5",6.93,9.84]],ln=["landscape","portrait"];function un(t){return parseInt(96*t,10)}function fn(t){"cancel"===t?this.el.hide():this.toPrint()}function sn(t){var e=this.paper,r=t.target.value,n=an[r];e.w=un(n[1]),e.h=un(n[2]),this.preview()}function hn(t){var e=this.paper,r=t.target.value,n=ln[r];e.orientation=n,this.preview()}var pn=function(){function t(e){var r,n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.paper={w:un(an[0][1]),h:un(an[0][2]),padding:50,orientation:ln[0],get width(){return"landscape"===this.orientation?this.h:this.w},get height(){return"landscape"===this.orientation?this.w:this.h}},this.data=e,this.el=l("div","".concat(Wt,"-print")).children(l("div","".concat(Wt,"-print-bar")).children(l("div","-title").child("Print settings"),l("div","-right").children(l("div","".concat(Wt,"-buttons")).children(new er("cancel").on("click",fn.bind(this,"cancel")),new er("next","primary").on("click",fn.bind(this,"next"))))),l("div","".concat(Wt,"-print-content")).children(this.contentEl=l("div","-content"),l("div","-sider").child(l("form","").children(l("fieldset","").children(l("label","").child("".concat(et("print.size"))),(r=l("select","")).children.apply(r,nn(an.map((function(t,e){return l("option","").attr("value",e).child("".concat(t[0]," ( ").concat(t[1],"''x").concat(t[2],"'' )"))})))).on("change",sn.bind(this))),l("fieldset","").children(l("label","").child("".concat(et("print.orientation"))),(n=l("select","")).children.apply(n,nn(ln.map((function(t,e){return l("option","").attr("value",e).child("".concat(et("print.orientations")[e]))})))).on("change",hn.bind(this))))))).hide()}var e,r,n;return e=t,(r=[{key:"resetData",value:function(t){this.data=t}},{key:"preview",value:function(){var t=this,e=this.data,r=this.paper,n=r.width,o=r.height,i=r.padding,c=n-2*i,a=o-2*i,u=e.contentRange(),f=parseInt(u.h/a,10)+1,s=c/u.w,h=i,p=i;s>1&&(h+=(c-u.w)/2);var y=0,d=0;this.contentEl.html(""),this.canvases=[];for(var v={sri:0,sci:0,eri:0,eci:0},b=function(r){var i=0,c=0,f=l("div","".concat(Wt,"-canvas-card")),b=l("canvas","".concat(Wt,"-canvas"));t.canvases.push(b.el);var m=new dr(b.el,n,o);for(m.save(),m.translate(h,p),s<1&&m.scale(s,s);y<=u.eri;y+=1){var g=e.rows.getHeight(y);if(!((i+=g)<a)){c=-(i-g);break}for(var w=0;w<=u.eci;w+=1)Yr(m,e,y,w,d),v.eci=w}v.eri=y,m.restore(),m.save(),m.translate(h,p),s<1&&m.scale(s,s);var O=d;e.eachMergesInView(v,(function(t){var r=t.sri,n=t.sci;Yr(m,e,r,n,O)})),m.restore(),v.sri=v.eri,v.sci=v.eci,d+=c,t.contentEl.child(l("div","".concat(Wt,"-canvas-card-wraper")).child(f.child(b)))},m=0;m<f;m+=1)b();this.el.show()}},{key:"toPrint",value:function(){this.el.hide();var t=this.paper,e=l("iframe","").hide().el;window.document.body.appendChild(e);var r=e.contentWindow,n=r.document,o=document.createElement("style");o.innerHTML="\n      @page { size: ".concat(t.width,"px ").concat(t.height,"px; };\n      canvas {\n        page-break-before: auto;        \n        page-break-after: always;\n        image-rendering: pixelated;\n      };\n    "),n.head.appendChild(o),this.canvases.forEach((function(t){var e=t.cloneNode(!1);e.getContext("2d").drawImage(t,0,0),n.body.appendChild(e)})),r.print()}}])&&cn(e.prototype,r),n&&cn(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function yn(t){return function(t){if(Array.isArray(t))return dn(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return dn(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return dn(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function dn(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function vn(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function bn(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var mn=[{key:"copy",title:rt("contextmenu.copy"),label:"Ctrl+C"},{key:"cut",title:rt("contextmenu.cut"),label:"Ctrl+X"},{key:"paste",title:rt("contextmenu.paste"),label:"Ctrl+V"},{key:"paste-value",title:rt("contextmenu.pasteValue"),label:"Ctrl+Shift+V"},{key:"paste-format",title:rt("contextmenu.pasteFormat"),label:"Ctrl+Alt+V"},{key:"divider"},{key:"insert-row",title:rt("contextmenu.insertRow")},{key:"insert-column",title:rt("contextmenu.insertColumn")},{key:"divider"},{key:"delete-row",title:rt("contextmenu.deleteRow")},{key:"delete-column",title:rt("contextmenu.deleteColumn")},{key:"delete-cell-text",title:rt("contextmenu.deleteCellText")},{key:"hide",title:rt("contextmenu.hide")},{key:"divider"},{key:"validation",title:rt("contextmenu.validation")},{key:"divider"},{key:"cell-printable",title:rt("contextmenu.cellprintable")},{key:"cell-non-printable",title:rt("contextmenu.cellnonprintable")},{key:"divider"},{key:"cell-editable",title:rt("contextmenu.celleditable")},{key:"cell-non-editable",title:rt("contextmenu.cellnoneditable")}];function gn(t){var e=this;return"divider"===t.key?l("div","".concat(Wt,"-item divider")):l("div","".concat(Wt,"-item")).on("click",(function(){e.itemClick(t.key),e.hide()})).children(t.title(),l("div","label").child(t.label||""))}function wn(){var t=this;return mn.map((function(e){return gn.call(t,e)}))}var On=function(){function t(e){var r,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];vn(this,t),this.menuItems=wn.call(this),this.el=(r=l("div","".concat(Wt,"-contextmenu"))).children.apply(r,yn(this.menuItems)).hide(),this.viewFn=e,this.itemClick=function(){},this.isHide=n,this.setMode("range")}var e,r,n;return e=t,(r=[{key:"setMode",value:function(t){var e=this.menuItems[12];"row-col"===t?e.show():e.hide()}},{key:"hide",value:function(){var t=this.el;t.hide(),zt(t)}},{key:"setPosition",value:function(t,e){if(!this.isHide){var r=this.el,n=r.show().offset().width,o=this.viewFn(),i=o.height/2,c=t;o.width-t<=n&&(c-=n),r.css("left","".concat(c,"px")),e>i?r.css("bottom","".concat(o.height-e,"px")).css("max-height","".concat(e,"px")).css("top","auto"):r.css("top","".concat(e,"px")).css("max-height","".concat(o.height-e,"px")).css("bottom","auto"),Mt(r)}}}])&&bn(e.prototype,r),n&&bn(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function kn(t,e){if(!e.classList.contains("active")){var r=e.getBoundingClientRect(),n=r.left,o=r.top,i=r.width,c=r.height,a=l("div","".concat(Wt,"-tooltip")).html(t).show();document.body.appendChild(a.el);var u=a.box();a.css("left","".concat(n+i/2-u.width/2,"px")).css("top","".concat(o+c+2,"px")),Dt(e,"mouseleave",(function(){document.body.contains(a.el)&&document.body.removeChild(a.el)})),Dt(e,"click",(function(){document.body.contains(a.el)&&document.body.removeChild(a.el)}))}}function jn(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var Sn=function(){function t(e,r,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.tip="",e&&(this.tip=et("toolbar.".concat(e.replace(/-[a-z]/g,(function(t){return t[1].toUpperCase()}))))),r&&(this.tip+=" (".concat(r,")")),this.tag=e,this.shortcut=r,this.value=n,this.el=this.element(),this.change=function(){}}var e,r,n;return e=t,(r=[{key:"element",value:function(){var t=this,e=this.tip;return l("div","".concat(Wt,"-toolbar-btn")).on("mouseenter",(function(e){t.tip&&kn(t.tip,e.target)})).attr("data-tooltip",e)}},{key:"setState",value:function(){}}])&&jn(e.prototype,r),n&&jn(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function xn(t){return(xn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function En(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Pn(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function _n(){return(_n="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=Rn(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(arguments.length<3?t:r):o.value}}).apply(this,arguments)}function Rn(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=In(t)););return t}function Tn(t,e){return(Tn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Cn(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=In(t);if(e){var o=In(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return An(this,r)}}function An(t,e){if(e&&("object"===xn(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function In(t){return(In=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Dn=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Tn(t,e)}(i,t);var e,r,n,o=Cn(i);function i(){return En(this,i),o.apply(this,arguments)}return e=i,(r=[{key:"dropdown",value:function(){}},{key:"getValue",value:function(t){return t}},{key:"element",value:function(){var t=this,e=this.tag;return this.dd=this.dropdown(),this.dd.change=function(r){return t.change(e,t.getValue(r))},_n(In(i.prototype),"element",this).call(this).child(this.dd)}},{key:"setState",value:function(t){t&&(this.value=t,this.dd.setTitle(t))}}])&&Pn(e.prototype,r),n&&Pn(e,n),Object.defineProperty(e,"prototype",{writable:!1}),i}(Sn);function Bn(t){return(Bn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function zn(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Mn(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Nn(t,e){return(Nn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Hn(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=Wn(t);if(e){var o=Wn(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return Fn(this,r)}}function Fn(t,e){if(e&&("object"===Bn(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Wn(t){return(Wn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Vn=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Nn(t,e)}(i,t);var e,r,n,o=Hn(i);function i(t,e,r,n){var c,a;zn(this,i),(a=o.call(this,"div","".concat(Wt,"-dropdown ").concat(n))).title=t,a.change=function(){},a.headerClick=function(){},"string"==typeof t?a.title=l("div","".concat(Wt,"-dropdown-title")).child(t):r&&a.title.addClass("arrow-left"),a.contentEl=l("div","".concat(Wt,"-dropdown-content")).css("width",e).hide();for(var u=arguments.length,f=new Array(u>4?u-4:0),s=4;s<u;s++)f[s-4]=arguments[s];return(c=a).setContentChildren.apply(c,f),a.headerEl=l("div","".concat(Wt,"-dropdown-header")),a.headerEl.on("click",(function(){"block"!==a.contentEl.css("display")?a.show():a.hide()})).children(a.title,r?l("div","".concat(Wt,"-icon arrow-right")).child(l("div","".concat(Wt,"-icon-img arrow-down"))):""),a.children(a.headerEl,a.contentEl),a}return e=i,(r=[{key:"setContentChildren",value:function(){var t;this.contentEl.html(""),arguments.length>0&&(t=this.contentEl).children.apply(t,arguments)}},{key:"setTitle",value:function(t){this.title.html(t),this.hide()}},{key:"show",value:function(){var t=this;this.contentEl.show(),this.parent().active(),Mt(this.parent(),(function(){t.hide()}))}},{key:"hide",value:function(){this.parent().active(!1),this.contentEl.hide(),zt(this.parent())}}])&&Mn(e.prototype,r),n&&Mn(e,n),Object.defineProperty(e,"prototype",{writable:!1}),i}(a);function Un(t){return(Un="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function $n(t){return function(t){if(Array.isArray(t))return Ln(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return Ln(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Ln(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ln(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function qn(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Yn(t,e){return(Yn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Xn(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=Zn(t);if(e){var o=Zn(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return Kn(this,r)}}function Kn(t,e){if(e&&("object"===Un(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Zn(t){return(Zn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Jn=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Yn(t,e)}(i,t);var e,r,n,o=Xn(i);function i(t,e){var r;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i);var n=new Pe("align-".concat(e)),c=t.map((function(t){return(e="align-".concat(t),l("div","".concat(Wt,"-item")).child(new Pe(e))).on("click",(function(){r.setTitle(t),r.change(t)}));var e}));return r=o.call.apply(o,[this,n,"auto",!0,"bottom-left"].concat($n(c)))}return e=i,(r=[{key:"setTitle",value:function(t){this.title.setName("align-".concat(t)),this.hide()}}])&&qn(e.prototype,r),n&&qn(e,n),Object.defineProperty(e,"prototype",{writable:!1}),i}(Vn);function Gn(t){return(Gn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Qn(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function to(t,e){return(to=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function eo(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=no(t);if(e){var o=no(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return ro(this,r)}}function ro(t,e){if(e&&("object"===Gn(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function no(t){return(no=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var oo=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&to(t,e)}(i,t);var e,r,n,o=eo(i);function i(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),o.call(this,"align","",t)}return e=i,(r=[{key:"dropdown",value:function(){var t=this.value;return new Jn(["left","center","right"],t)}}])&&Qn(e.prototype,r),n&&Qn(e,n),Object.defineProperty(e,"prototype",{writable:!1}),i}(Dn);function io(t){return(io="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function co(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function ao(t,e){return(ao=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function lo(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=fo(t);if(e){var o=fo(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return uo(this,r)}}function uo(t,e){if(e&&("object"===io(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function fo(t){return(fo=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var so=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ao(t,e)}(i,t);var e,r,n,o=lo(i);function i(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),o.call(this,"valign","",t)}return e=i,(r=[{key:"dropdown",value:function(){var t=this.value;return new Jn(["top","middle","bottom"],t)}}])&&co(e.prototype,r),n&&co(e,n),Object.defineProperty(e,"prototype",{writable:!1}),i}(Dn);function ho(t){return(ho="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function po(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function yo(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function vo(){return(vo="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=bo(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(arguments.length<3?t:r):o.value}}).apply(this,arguments)}function bo(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Oo(t)););return t}function mo(t,e){return(mo=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function go(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=Oo(t);if(e){var o=Oo(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return wo(this,r)}}function wo(t,e){if(e&&("object"===ho(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Oo(t){return(Oo=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var ko=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&mo(t,e)}(i,t);var e,r,n,o=go(i);function i(){return po(this,i),o.apply(this,arguments)}return e=i,(r=[{key:"element",value:function(){var t=this,e=this.tag;return vo(Oo(i.prototype),"element",this).call(this).child(new Pe(e)).on("click",(function(){return t.click()}))}},{key:"click",value:function(){this.change(this.tag,this.toggle())}},{key:"setState",value:function(t){this.el.active(t)}},{key:"toggle",value:function(){return this.el.toggle()}},{key:"active",value:function(){return this.el.hasClass("active")}}])&&yo(e.prototype,r),n&&yo(e,n),Object.defineProperty(e,"prototype",{writable:!1}),i}(Sn);function jo(t){return(jo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function So(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function xo(t,e){return(xo=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Eo(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=_o(t);if(e){var o=_o(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return Po(this,r)}}function Po(t,e){if(e&&("object"===jo(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function _o(t){return(_o=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Ro=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&xo(t,e)}(i,t);var e,r,n,o=Eo(i);function i(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),o.call(this,"autofilter")}return e=i,(r=[{key:"setState",value:function(){}}])&&So(e.prototype,r),n&&So(e,n),Object.defineProperty(e,"prototype",{writable:!1}),i}(ko);function To(t){return(To="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Co(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Ao(t,e){return(Ao=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Io(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=Bo(t);if(e){var o=Bo(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return Do(this,r)}}function Do(t,e){if(e&&("object"===To(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Bo(t){return(Bo=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var zo=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Ao(t,e)}(i,t);var e,r,n,o=Io(i);function i(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),o.call(this,"font-bold","Ctrl+B")}return e=i,r&&Co(e.prototype,r),n&&Co(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}(ko);function Mo(t){return(Mo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function No(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Ho(t,e){return(Ho=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Fo(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=Vo(t);if(e){var o=Vo(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return Wo(this,r)}}function Wo(t,e){if(e&&("object"===Mo(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Vo(t){return(Vo=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Uo=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Ho(t,e)}(i,t);var e,r,n,o=Fo(i);function i(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),o.call(this,"font-italic","Ctrl+I")}return e=i,r&&No(e.prototype,r),n&&No(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}(ko);function $o(t){return($o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Lo(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function qo(t,e){return(qo=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Yo(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=Ko(t);if(e){var o=Ko(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return Xo(this,r)}}function Xo(t,e){if(e&&("object"===$o(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Ko(t){return(Ko=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Zo=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&qo(t,e)}(i,t);var e,r,n,o=Yo(i);function i(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),o.call(this,"strike","Ctrl+U")}return e=i,r&&Lo(e.prototype,r),n&&Lo(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}(ko);function Jo(t){return(Jo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Go(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Qo(t,e){return(Qo=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function ti(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=ri(t);if(e){var o=ri(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return ei(this,r)}}function ei(t,e){if(e&&("object"===Jo(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function ri(t){return(ri=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var ni=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Qo(t,e)}(i,t);var e,r,n,o=ti(i);function i(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),o.call(this,"underline","Ctrl+U")}return e=i,r&&Go(e.prototype,r),n&&Go(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}(ko);function oi(t){return function(t){if(Array.isArray(t))return ii(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return ii(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ii(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ii(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function ci(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function ai(t,e,r){return e&&ci(t.prototype,e),r&&ci(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}var li=["#ffffff","#000100","#e7e5e6","#445569","#5b9cd6","#ed7d31","#a5a5a5","#ffc001","#4371c6","#71ae47"],ui=[["#f2f2f2","#7f7f7f","#d0cecf","#d5dce4","#deeaf6","#fce5d5","#ededed","#fff2cd","#d9e2f3","#e3efd9"],["#d8d8d8","#595959","#afabac","#adb8ca","#bdd7ee","#f7ccac","#dbdbdb","#ffe59a","#b3c6e7","#c5e0b3"],["#bfbfbf","#3f3f3f","#756f6f","#8596b0","#9cc2e6","#f4b184","#c9c9c9","#fed964","#8eaada","#a7d08c"],["#a5a5a5","#262626","#3a3839","#333f4f","#2e75b5","#c45a10","#7b7b7b","#bf8e01","#2f5596","#538136"],["#7f7f7f","#0c0c0c","#171516","#222a35","#1f4e7a","#843c0a","#525252","#7e6000","#203864","#365624"]],fi=["#c00000","#fe0000","#fdc101","#ffff01","#93d051","#00b04e","#01b0f1","#0170c1","#012060","#7030a0"];function si(t){var e=this;return l("td","").child(l("div","".concat(Wt,"-color-palette-cell")).on("click.stop",(function(){return e.change(t)})).css("background-color",t))}var hi=ai((function t(){var e,r,n,o=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.el=l("div","".concat(Wt,"-color-palette")),this.change=function(){};var i=l("table","").children((e=l("tbody","")).children.apply(e,[(r=l("tr","".concat(Wt,"-theme-color-placeholders"))).children.apply(r,oi(li.map((function(t){return si.call(o,t)}))))].concat(oi(ui.map((function(t){var e;return(e=l("tr","".concat(Wt,"-theme-colors"))).children.apply(e,oi(t.map((function(t){return si.call(o,t)}))))}))),[(n=l("tr","".concat(Wt,"-standard-colors"))).children.apply(n,oi(fi.map((function(t){return si.call(o,t)}))))])));this.el.child(i)}));function pi(t){return(pi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function yi(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function di(t,e){return(di=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function vi(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=mi(t);if(e){var o=mi(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return bi(this,r)}}function bi(t,e){if(e&&("object"===pi(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function mi(t){return(mi=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var gi=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&di(t,e)}(i,t);var e,r,n,o=vi(i);function i(t,e){var r;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i);var n=new Pe(t).css("height","16px").css("border-bottom","3px solid ".concat(e)),c=new hi;return c.change=function(t){r.setTitle(t),r.change(t)},r=o.call(this,n,"auto",!1,"bottom-left",c.el)}return e=i,(r=[{key:"setTitle",value:function(t){this.title.css("border-color",t),this.hide()}}])&&yi(e.prototype,r),n&&yi(e,n),Object.defineProperty(e,"prototype",{writable:!1}),i}(Vn);function wi(t){return(wi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Oi(t){return function(t){if(Array.isArray(t))return ki(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return ki(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ki(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ki(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function ji(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Si(t,e){return(Si=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function xi(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=Pi(t);if(e){var o=Pi(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return Ei(this,r)}}function Ei(t,e){if(e&&("object"===wi(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Pi(t){return(Pi=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var _i=[["thin",'<svg xmlns="http://www.w3.org/2000/svg" width="50" height="1" style="user-select: none;"><line x1="0" y1="0.5" x2="50" y2="0.5" stroke-width="1" stroke="black" style="user-select: none;"></line></svg>'],["medium",'<svg xmlns="http://www.w3.org/2000/svg" width="50" height="2" style="user-select: none;"><line x1="0" y1="1.0" x2="50" y2="1.0" stroke-width="2" stroke="black" style="user-select: none;"></line></svg>'],["thick",'<svg xmlns="http://www.w3.org/2000/svg" width="50" height="3" style="user-select: none;"><line x1="0" y1="1.5" x2="50" y2="1.5" stroke-width="3" stroke="black" style="user-select: none;"></line></svg>'],["dashed",'<svg xmlns="http://www.w3.org/2000/svg" width="50" height="1" style="user-select: none;"><line x1="0" y1="0.5" x2="50" y2="0.5" stroke-width="1" stroke="black" stroke-dasharray="2" style="user-select: none;"></line></svg>'],["dotted",'<svg xmlns="http://www.w3.org/2000/svg" width="50" height="1" style="user-select: none;"><line x1="0" y1="0.5" x2="50" y2="0.5" stroke-width="1" stroke="black" stroke-dasharray="1" style="user-select: none;"></line></svg>']],Ri=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Si(t,e)}(i,t);var e,r,n,o=xi(i);function i(t){var e;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i);var r=new Pe("line-type"),n=0,c=_i.map((function(r,o){return l("div","".concat(Wt,"-item state ").concat(t===r[0]?"checked":"")).on("click",(function(){c[n].toggle("checked"),c[o].toggle("checked"),n=o,e.hide(),e.change(r)})).child(l("div","".concat(Wt,"-line-type")).html(r[1]))}));return e=o.call.apply(o,[this,r,"auto",!1,"bottom-left"].concat(Oi(c)))}return e=i,r&&ji(e.prototype,r),n&&ji(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}(Vn);function Ti(t){return function(t){if(Array.isArray(t))return Ii(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||Ai(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ci(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null==r)return;var n,o,i=[],c=!0,a=!1;try{for(r=r.call(t);!(c=(n=r.next()).done)&&(i.push(n.value),!e||i.length!==e);c=!0);}catch(t){a=!0,o=t}finally{try{c||null==r.return||r.return()}finally{if(a)throw o}}return i}(t,e)||Ai(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ai(t,e){if(t){if("string"==typeof t)return Ii(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Ii(t,e):void 0}}function Ii(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function Di(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Bi(t,e,r){return e&&Di(t.prototype,e),r&&Di(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function zi(){var t;return l("table","").child((t=l("tbody","")).children.apply(t,arguments))}function Mi(t){var e=this;return l("td","").child(l("div","".concat(Wt,"-border-palette-cell")).child(new Pe("border-".concat(t))).on("click",(function(){e.mode=t;var r=e.mode,n=e.style,o=e.color;e.change({mode:r,style:n,color:o})})))}var Ni=Bi((function t(){var e,r,n=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.color="#000",this.style="thin",this.mode="all",this.change=function(){},this.ddColor=new gi("line-color",this.color),this.ddColor.change=function(t){n.color=t},this.ddType=new Ri(this.style),this.ddType.change=function(t){var e=Ci(t,1)[0];n.style=e},this.el=l("div","".concat(Wt,"-border-palette"));var o=zi(l("tr","").children(l("td","".concat(Wt,"-border-palette-left")).child(zi((e=l("tr","")).children.apply(e,Ti(["all","inside","horizontal","vertical","outside"].map((function(t){return Mi.call(n,t)})))),(r=l("tr","")).children.apply(r,Ti(["left","top","right","bottom","none"].map((function(t){return Mi.call(n,t)})))))),l("td","".concat(Wt,"-border-palette-right")).children(l("div","".concat(Wt,"-toolbar-btn")).child(this.ddColor.el),l("div","".concat(Wt,"-toolbar-btn")).child(this.ddType.el))));this.el.child(o)}));function Hi(t){return(Hi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Fi(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Wi(t,e){return(Wi=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Vi(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=$i(t);if(e){var o=$i(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return Ui(this,r)}}function Ui(t,e){if(e&&("object"===Hi(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function $i(t){return($i=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Li=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Wi(t,e)}(i,t);var e,r,n,o=Vi(i);function i(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i);var e=new Pe("border-all"),r=new Ni;return r.change=function(e){t.change(e),t.hide()},t=o.call(this,e,"auto",!1,"bottom-left",r.el)}return e=i,r&&Fi(e.prototype,r),n&&Fi(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}(Vn);function qi(t){return(qi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Yi(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Xi(t,e){return(Xi=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Ki(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=Ji(t);if(e){var o=Ji(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return Zi(this,r)}}function Zi(t,e){if(e&&("object"===qi(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Ji(t){return(Ji=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Gi=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Xi(t,e)}(i,t);var e,r,n,o=Ki(i);function i(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),o.call(this,"border")}return e=i,(r=[{key:"dropdown",value:function(){return new Li}}])&&Yi(e.prototype,r),n&&Yi(e,n),Object.defineProperty(e,"prototype",{writable:!1}),i}(Dn);function Qi(t){return(Qi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function tc(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ec(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function rc(){return(rc="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=nc(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(arguments.length<3?t:r):o.value}}).apply(this,arguments)}function nc(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=ac(t)););return t}function oc(t,e){return(oc=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function ic(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=ac(t);if(e){var o=ac(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return cc(this,r)}}function cc(t,e){if(e&&("object"===Qi(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function ac(t){return(ac=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var lc=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&oc(t,e)}(i,t);var e,r,n,o=ic(i);function i(){return tc(this,i),o.apply(this,arguments)}return e=i,(r=[{key:"element",value:function(){var t=this;return rc(ac(i.prototype),"element",this).call(this).child(new Pe(this.tag)).on("click",(function(){return t.change(t.tag)}))}},{key:"setState",value:function(t){this.el.disabled(t)}}])&&ec(e.prototype,r),n&&ec(e,n),Object.defineProperty(e,"prototype",{writable:!1}),i}(Sn);function uc(t){return(uc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function fc(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function sc(t,e){return(sc=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function hc(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=yc(t);if(e){var o=yc(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return pc(this,r)}}function pc(t,e){if(e&&("object"===uc(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function yc(t){return(yc=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var dc=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&sc(t,e)}(i,t);var e,r,n,o=hc(i);function i(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),o.call(this,"clearformat")}return e=i,r&&fc(e.prototype,r),n&&fc(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}(lc);function vc(t){return(vc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function bc(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function mc(t,e){return(mc=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function gc(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=Oc(t);if(e){var o=Oc(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return wc(this,r)}}function wc(t,e){if(e&&("object"===vc(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Oc(t){return(Oc=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var kc=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&mc(t,e)}(i,t);var e,r,n,o=gc(i);function i(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),o.call(this,"paintformat")}return e=i,(r=[{key:"setState",value:function(){}}])&&bc(e.prototype,r),n&&bc(e,n),Object.defineProperty(e,"prototype",{writable:!1}),i}(ko);function jc(t){return(jc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Sc(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function xc(t,e){return(xc=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Ec(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=_c(t);if(e){var o=_c(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return Pc(this,r)}}function Pc(t,e){if(e&&("object"===jc(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function _c(t){return(_c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Rc=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&xc(t,e)}(i,t);var e,r,n,o=Ec(i);function i(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),o.call(this,"color",void 0,t)}return e=i,(r=[{key:"dropdown",value:function(){var t=this.tag,e=this.value;return new gi(t,e)}}])&&Sc(e.prototype,r),n&&Sc(e,n),Object.defineProperty(e,"prototype",{writable:!1}),i}(Dn);function Tc(t){return(Tc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Cc(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Ac(t,e){return(Ac=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Ic(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=Bc(t);if(e){var o=Bc(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return Dc(this,r)}}function Dc(t,e){if(e&&("object"===Tc(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Bc(t){return(Bc=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var zc=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Ac(t,e)}(i,t);var e,r,n,o=Ic(i);function i(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),o.call(this,"bgcolor",void 0,t)}return e=i,(r=[{key:"dropdown",value:function(){var t=this.tag,e=this.value;return new gi(t,e)}}])&&Cc(e.prototype,r),n&&Cc(e,n),Object.defineProperty(e,"prototype",{writable:!1}),i}(Dn);function Mc(t){return(Mc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Nc(t){return function(t){if(Array.isArray(t))return Hc(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return Hc(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Hc(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Hc(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function Fc(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Wc(t,e){return(Wc=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Vc(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=$c(t);if(e){var o=$c(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return Uc(this,r)}}function Uc(t,e){if(e&&("object"===Mc(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function $c(t){return($c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Lc=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Wc(t,e)}(i,t);var e,r,n,o=Vc(i);function i(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i);var e=br.map((function(e){return l("div","".concat(Wt,"-item")).on("click",(function(){t.setTitle("".concat(e.pt)),t.change(e)})).child("".concat(e.pt))}));return t=o.call.apply(o,[this,"10","60px",!0,"bottom-left"].concat(Nc(e)))}return e=i,r&&Fc(e.prototype,r),n&&Fc(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}(Vn);function qc(t){return(qc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Yc(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Xc(t,e){return(Xc=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Kc(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=Jc(t);if(e){var o=Jc(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return Zc(this,r)}}function Zc(t,e){if(e&&("object"===qc(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Jc(t){return(Jc=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Gc=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Xc(t,e)}(i,t);var e,r,n,o=Kc(i);function i(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),o.call(this,"font-size")}return e=i,(r=[{key:"getValue",value:function(t){return t.pt}},{key:"dropdown",value:function(){return new Lc}}])&&Yc(e.prototype,r),n&&Yc(e,n),Object.defineProperty(e,"prototype",{writable:!1}),i}(Dn);function Qc(t){return(Qc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ta(t){return function(t){if(Array.isArray(t))return ea(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return ea(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ea(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ea(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function ra(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function na(t,e){return(na=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function oa(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=ca(t);if(e){var o=ca(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return ia(this,r)}}function ia(t,e){if(e&&("object"===Qc(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function ca(t){return(ca=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var aa=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&na(t,e)}(i,t);var e,r,n,o=oa(i);function i(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i);var e=vr.map((function(e){return l("div","".concat(Wt,"-item")).on("click",(function(){t.setTitle(e.title),t.change(e)})).child(e.title)}));return t=o.call.apply(o,[this,vr[0].title,"160px",!0,"bottom-left"].concat(ta(e)))}return e=i,r&&ra(e.prototype,r),n&&ra(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}(Vn);function la(t){return(la="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ua(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function fa(t,e){return(fa=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function sa(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=pa(t);if(e){var o=pa(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return ha(this,r)}}function ha(t,e){if(e&&("object"===la(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function pa(t){return(pa=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var ya=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&fa(t,e)}(i,t);var e,r,n,o=sa(i);function i(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),o.call(this,"font-name")}return e=i,(r=[{key:"getValue",value:function(t){return t.key}},{key:"dropdown",value:function(){return new aa}}])&&ua(e.prototype,r),n&&ua(e,n),Object.defineProperty(e,"prototype",{writable:!1}),i}(Dn);function da(t){return(da="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function va(t){return function(t){if(Array.isArray(t))return ba(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return ba(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ba(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ba(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function ma(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function ga(t,e){return(ga=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function wa(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=ka(t);if(e){var o=ka(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return Oa(this,r)}}function Oa(t,e){if(e&&("object"===da(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function ka(t){return(ka=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var ja=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ga(t,e)}(i,t);var e,r,n,o=wa(i);function i(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i);var e=Hr.slice(0);return e.splice(2,0,{key:"divider"}),e.splice(8,0,{key:"divider"}),e=e.map((function(e){var r=l("div","".concat(Wt,"-item"));return"divider"===e.key?r.addClass("divider"):(r.child(e.title()).on("click",(function(){t.setTitle(e.title()),t.change(e)})),e.label&&r.child(l("div","label").html(e.label))),r})),t=o.call.apply(o,[this,"Normal","220px",!0,"bottom-left"].concat(va(e)))}return e=i,(r=[{key:"setTitle",value:function(t){for(var e=0;e<Hr.length;e+=1)Hr[e].key===t&&this.title.html(Hr[e].title());this.hide()}}])&&ma(e.prototype,r),n&&ma(e,n),Object.defineProperty(e,"prototype",{writable:!1}),i}(Vn);function Sa(t){return(Sa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function xa(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Ea(t,e){return(Ea=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Pa(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=Ra(t);if(e){var o=Ra(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return _a(this,r)}}function _a(t,e){if(e&&("object"===Sa(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Ra(t){return(Ra=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Ta=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Ea(t,e)}(i,t);var e,r,n,o=Pa(i);function i(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),o.call(this,"format")}return e=i,(r=[{key:"getValue",value:function(t){return t.key}},{key:"dropdown",value:function(){return new ja}}])&&xa(e.prototype,r),n&&xa(e,n),Object.defineProperty(e,"prototype",{writable:!1}),i}(Dn);function Ca(t){return(Ca="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Aa(t){return function(t){if(Array.isArray(t))return Ia(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return Ia(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Ia(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ia(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function Da(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Ba(t,e){return(Ba=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function za(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=Na(t);if(e){var o=Na(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return Ma(this,r)}}function Ma(t,e){if(e&&("object"===Ca(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Na(t){return(Na=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Ha=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Ba(t,e)}(i,t);var e,r,n,o=za(i);function i(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i);var e=Rr.map((function(e){return l("div","".concat(Wt,"-item")).on("click",(function(){t.hide(),t.change(e)})).child(e.key)}));return t=o.call.apply(o,[this,new Pe("formula"),"180px",!0,"bottom-left"].concat(Aa(e)))}return e=i,r&&Da(e.prototype,r),n&&Da(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}(Vn);function Fa(t){return(Fa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Wa(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Va(t,e){return(Va=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Ua(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=La(t);if(e){var o=La(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return $a(this,r)}}function $a(t,e){if(e&&("object"===Fa(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function La(t){return(La=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var qa=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Va(t,e)}(i,t);var e,r,n,o=Ua(i);function i(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),o.call(this,"formula")}return e=i,(r=[{key:"getValue",value:function(t){return t.key}},{key:"dropdown",value:function(){return new Ha}}])&&Wa(e.prototype,r),n&&Wa(e,n),Object.defineProperty(e,"prototype",{writable:!1}),i}(Dn);function Ya(t){return(Ya="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Xa(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Ka(t,e){return(Ka=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Za(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=Ga(t);if(e){var o=Ga(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return Ja(this,r)}}function Ja(t,e){if(e&&("object"===Ya(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Ga(t){return(Ga=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Qa=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Ka(t,e)}(i,t);var e,r,n,o=Za(i);function i(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),o.call(this,"freeze")}return e=i,r&&Xa(e.prototype,r),n&&Xa(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}(ko);function tl(t){return(tl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function el(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function rl(t,e){return(rl=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function nl(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=il(t);if(e){var o=il(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return ol(this,r)}}function ol(t,e){if(e&&("object"===tl(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function il(t){return(il=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var cl=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&rl(t,e)}(i,t);var e,r,n,o=nl(i);function i(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),o.call(this,"merge")}return e=i,(r=[{key:"setState",value:function(t,e){this.el.active(t).disabled(e)}}])&&el(e.prototype,r),n&&el(e,n),Object.defineProperty(e,"prototype",{writable:!1}),i}(ko);function al(t){return(al="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ll(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function ul(t,e){return(ul=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function fl(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=hl(t);if(e){var o=hl(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return sl(this,r)}}function sl(t,e){if(e&&("object"===al(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function hl(t){return(hl=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var pl=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ul(t,e)}(i,t);var e,r,n,o=fl(i);function i(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),o.call(this,"redo","Ctrl+Y")}return e=i,r&&ll(e.prototype,r),n&&ll(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}(lc);function yl(t){return(yl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function dl(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function vl(t,e){return(vl=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function bl(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=gl(t);if(e){var o=gl(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return ml(this,r)}}function ml(t,e){if(e&&("object"===yl(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function gl(t){return(gl=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var wl=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&vl(t,e)}(i,t);var e,r,n,o=bl(i);function i(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),o.call(this,"undo","Ctrl+Z")}return e=i,r&&dl(e.prototype,r),n&&dl(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}(lc);function Ol(t){return(Ol="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function kl(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function jl(t,e){return(jl=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Sl(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=El(t);if(e){var o=El(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return xl(this,r)}}function xl(t,e){if(e&&("object"===Ol(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function El(t){return(El=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Pl=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&jl(t,e)}(i,t);var e,r,n,o=Sl(i);function i(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),o.call(this,"textwrap")}return e=i,r&&kl(e.prototype,r),n&&kl(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}(ko);function _l(t){return(_l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Rl(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Tl(t,e,r){return e&&Rl(t.prototype,e),r&&Rl(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function Cl(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Al(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Il(t,e)}function Il(t,e){return(Il=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Dl(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=zl(t);if(e){var o=zl(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return Bl(this,r)}}function Bl(t,e){if(e&&("object"===_l(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function zl(t){return(zl=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Ml=function(t){Al(r,t);var e=Dl(r);function r(){var t;Cl(this,r);var n=new Pe("ellipsis"),o=l("div","".concat(Wt,"-toolbar-more"));return(t=e.call(this,n,"auto",!1,"bottom-right",o)).moreBtns=o,t.contentEl.css("max-width","420px"),t}return Tl(r)}(Vn),Nl=function(t){Al(r,t);var e=Dl(r);function r(){var t;return Cl(this,r),(t=e.call(this,"more")).el.hide(),t}return Tl(r,[{key:"dropdown",value:function(){return new Ml}},{key:"show",value:function(){this.el.show()}},{key:"hide",value:function(){this.el.hide()}}]),r}(Dn);function Hl(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Fl(t){return(Fl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Wl(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Vl(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Ul(){return(Ul="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=$l(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(arguments.length<3?t:r):o.value}}).apply(this,arguments)}function $l(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Xl(t)););return t}function Ll(t,e){return(Ll=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function ql(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=Xl(t);if(e){var o=Xl(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return Yl(this,r)}}function Yl(t,e){if(e&&("object"===Fl(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Xl(t){return(Xl=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Kl(t){return(Kl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Zl(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Jl(t,e){return(Jl=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Gl(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=tu(t);if(e){var o=tu(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return Ql(this,r)}}function Ql(t,e){if(e&&("object"===Kl(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function tu(t){return(tu=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var eu=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Jl(t,e)}(i,t);var e,r,n,o=Gl(i);function i(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),o.call(this,"background","Ctrl+I")}return e=i,r&&Zl(e.prototype,r),n&&Zl(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}(function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Ll(t,e)}(i,t);var e,r,n,o=ql(i);function i(){return Wl(this,i),o.apply(this,arguments)}return e=i,(r=[{key:"element",value:function(){var t=this,e=this.tag,r=l("div","".concat(Wt,"-icon ").concat(e)),n=l("input","").attr("type","file").attr("id","".concat(e)).hide().on("change",(function(e){t.onchange(e)}));return r.children(n),Ul(Xl(i.prototype),"element",this).call(this).child(r).on("click",(function(){return t.click()}))}},{key:"onchange",value:function(t){this.upload(this.tag,t)}},{key:"click",value:function(){this.change(this.tag,this.toggle())}},{key:"setState",value:function(t){this.el.active(t)}},{key:"toggle",value:function(){return this.el.toggle()}},{key:"active",value:function(){return this.el.hasClass("active")}}])&&Vl(e.prototype,r),n&&Vl(e,n),Object.defineProperty(e,"prototype",{writable:!1}),i}(function(){function t(e,r,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.tip="",e&&(this.tip=et("toolbar.".concat(e.replace(/-[a-z]/g,(function(t){return t[1].toUpperCase()}))))),r&&(this.tip+=" (".concat(r,")")),this.tag=e,this.shortcut=r,this.value=n,this.el=this.element(),this.upload=function(){},this.change=function(){}}var e,r,n;return e=t,(r=[{key:"element",value:function(){var t=this,e=this.tip;return l("div","".concat(Wt,"-toolbar-btn")).on("mouseenter",(function(e){t.tip&&kn(t.tip,e.target)})).attr("data-tooltip",e)}},{key:"setState",value:function(){}}])&&Hl(e.prototype,r),n&&Hl(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}()));function ru(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function nu(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function ou(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null==r)return;var n,o,i=[],c=!0,a=!1;try{for(r=r.call(t);!(c=(n=r.next()).done)&&(i.push(n.value),!e||i.length!==e);c=!0);}catch(t){a=!0,o=t}finally{try{c||null==r.return||r.return()}finally{if(a)throw o}}return i}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return iu(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return iu(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function iu(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function cu(){return l("div","".concat(Wt,"-toolbar-divider"))}function au(){var t=this;this.btns2=[],this.items.forEach((function(e){if(Array.isArray(e))e.forEach((function(e){var r=e.el,n=r.box(),o=r.computedStyle(),i=o.marginLeft,c=o.marginRight;t.btns2.push([r,n.width+parseInt(i,10)+parseInt(c,10)])}));else{var r=e.box(),n=e.computedStyle(),o=n.marginLeft,i=n.marginRight;t.btns2.push([e,r.width+parseInt(o,10)+parseInt(i,10)])}}))}function lu(){var t,e,r=this.el,n=this.btns,o=this.moreEl,i=this.btns2,c=o.dd,a=c.moreBtns,l=c.contentEl;r.css("width","".concat(this.widthFn(),"px"));var u=r.box(),f=160,s=12,h=[],p=[];i.forEach((function(t,e){var r=ou(t,2),n=r[0],o=r[1];f+=o,e===i.length-1||f<u.width?h.push(n):(s+=o,p.push(n))})),(t=n.html("")).children.apply(t,h),(e=a.html("")).children.apply(e,p),l.css("width","".concat(s,"px")),p.length>0?o.show():o.hide()}function uu(t){var e=this,r=new Sn;r.el.on("click",(function(){t.onClick&&t.onClick(e.data.getData(),e.data)})),r.tip=t.tip||"";var n=t.el;if(t.icon&&(n=l("img").attr("src",t.icon)),n){var o=l("div","".concat(Wt,"-icon"));o.child(n),r.el.child(o)}return r}var fu=function(){function t(e,r){var n=this,o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];ru(this,t),this.data=e,this.change=function(){},this.upload=function(){},this.widthFn=r,this.isHide=o;var i=e.defaultStyle();this.items=[[this.undoEl=new wl,this.redoEl=new pl,this.paintformatEl=new kc,this.clearformatEl=new dc],cu(),[this.formatEl=new Ta],cu(),[this.fontEl=new ya,this.fontSizeEl=new Gc],cu(),[this.boldEl=new zo,this.italicEl=new Uo,this.underlineEl=new ni,this.strikeEl=new Zo,this.textColorEl=new Rc(i.color)],cu(),[this.fillColorEl=new zc(i.bgcolor),this.borderEl=new Gi,this.mergeEl=new cl],cu(),[this.alignEl=new oo(i.align),this.valignEl=new so(i.valign),this.textwrapEl=new Pl],cu(),[this.freezeEl=new Qa,this.autofilterEl=new Ro,this.formulaEl=new qa],cu(),[this.backImageEl=new eu]];var c=e.settings.extendToolbar,a=void 0===c?{}:c;if(a.left&&a.left.length>0)for(var u=a.left.map(uu.bind(this)),f=0;f<u.length;f++)this.items.unshift(cu()),this.items.unshift(u[f]);if(a.right&&a.right.length>0){var s=a.right.map(uu.bind(this));for(f=0;f<s.length;f++)this.items.push(cu()),this.items.push(s)}this.items.push([this.moreEl=new Nl]),this.el=l("div","".concat(Wt,"-toolbar")),this.btns=l("div","".concat(Wt,"-toolbar-btns")),this.items.forEach((function(t){Array.isArray(t)?t.forEach((function(t){n.btns.child(t.el),t.change=function(){n.change.apply(n,arguments)},"background"===t.tag&&(t.upload=function(){n.upload.apply(n,arguments)})})):n.btns.child(t.el)})),this.el.child(this.btns),o?this.el.hide():(this.reset(),setTimeout((function(){au.call(n),lu.call(n)}),0),Dt(window,"resize",(function(){lu.call(n)})))}var e,r,n;return e=t,(r=[{key:"paintformatActive",value:function(){return this.paintformatEl.active()}},{key:"paintformatToggle",value:function(){this.paintformatEl.toggle()}},{key:"trigger",value:function(t){this["".concat(t,"El")].click()}},{key:"resetData",value:function(t){this.data=t,this.reset()}},{key:"reset",value:function(){if(!this.isHide){var t=this.data,e=t.getSelectedCellStyle();this.undoEl.setState(!t.canUndo()),this.redoEl.setState(!t.canRedo()),this.mergeEl.setState(t.canUnmerge(),!t.selector.multiple()),this.autofilterEl.setState(!t.canAutofilter());var r=e.font,n=e.format;this.formatEl.setState(n),this.fontEl.setState(r.name),this.fontSizeEl.setState(r.size),this.boldEl.setState(r.bold),this.italicEl.setState(r.italic),this.underlineEl.setState(e.underline),this.strikeEl.setState(e.strike),this.textColorEl.setState(e.color),this.fillColorEl.setState(e.bgcolor),this.alignEl.setState(e.align),this.valignEl.setState(e.valign),this.textwrapEl.setState(e.textwrap),this.freezeEl.setState(t.freezeIsActive())}}}])&&nu(e.prototype,r),n&&nu(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function su(t){return function(t){if(Array.isArray(t))return hu(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return hu(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return hu(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function hu(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function pu(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function yu(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var du=[{key:"delete",title:"删除"},{key:"divider"},{key:"fixed",title:"固定"},{key:"divider"},{key:"divider"},{key:"backend",title:"设为套打图片"}],vu=[{css:"circle top-left"},{css:"circle top-center"},{css:"circle top-right"},{css:"circle middle-left"},{css:"circle middle-right"},{css:"circle bottom-left"},{css:"circle bottom-center"},{css:"circle bottom-right"}];function bu(t){var e=this;return"divider"===t.key?l("div","menu-item divider"):l("div","menu-item").on("click",(function(){e.itemClick(t.key),e.hide()})).children(t.title)}function mu(){var t=this;return du.map((function(e){return bu.call(t,e)}))}var gu=function(){function t(e,r,n,o){var i,c,a=this,u=arguments.length>4&&void 0!==arguments[4]&&arguments[4];pu(this,t),this.menuItems=mu.call(this),this.sheet=e,this.fixed=!1,this.itemClick=function(){},this.itemDrag=function(){},this.viewFn=o,this.isHide=u,this.el=l("div","spreadsheet-drag-container img  selected").active().attr("id",r),this.dragContentEl=l("div","spreadsheet-drag-content"),this.imgEl=l("div",""),this.imgEl.css("position","absolute"),this.imgEl.css("bottom","0px"),this.imgEl.css("width","100%"),this.imgEl.css("height","100%"),this.imageEl=l("img",""),this.imageEl.attr("crossorigin","Anonymous"),this.imageEl.attr("src",n),this.imgEl.children(this.imageEl),this.fileInputEl=l("input",""),this.fileInputEl.attr("type","file"),this.fileInputEl.css("display","none"),this.dragContentEl.children(this.imgEl,this.fileInputEl),this.dragCircleEl=l("div","spreadsheet-drag-circle"),(i=this.dragCircleEl).children.apply(i,su(vu.map((function(t){return a.buildCircleItem.call(a,t)})))),this.layermenuEl=l("div","spreadsheet-layer-menu"),(c=this.layermenuEl).children.apply(c,su(this.menuItems)).hide(),this.el.children(this.dragContentEl,this.dragCircleEl,this.layermenuEl),this.elmouseX=0,this.elmouseY=0,this.eloffsetL=0,this.eloffsetT=0,this.elleft=0,this.eltop=0,this.elDowm=!1,this.move=!1,this.dragContentEl.on("mousedown",(function(t){t.preventDefault();var e=a.el.offset();a.eloffsetL=e.left,a.eloffsetT=e.top,a.elmouseX=t.clientX,a.elmouseY=t.clientY,a.elDowm=!0,a.move=!1,a.sheet.overlayerEl.on("mousemove",(function(t){if(t.preventDefault(),a.elDowm){var e=a.sheet.data.getCellRectByXY(t.offsetX,t.offsetY);a.elleft=e.left,a.eltop=e.top,-1===e.ri&&(a.eltop=25),-1===e.ci&&(a.elleft=60),a.el.css("left",a.elleft+"px"),a.el.css("top",a.eltop+"px")}}))})).on("mouseup",(function(t){t.preventDefault(),a.elDowm&&a.elleft>0&&a.eltop>0&&(a.el.css("left",a.elleft+"px"),a.el.css("top",a.eltop+"px")),a.elDowm=!1,a.move=!1})),this.dragContentEl.on("mousedown",(function(t){a.layermenuEl.hide(),2===t.buttons&&a.setPosition(t.offsetX,t.offsetY)}))}var e,r,n;return e=t,(r=[{key:"hide",value:function(){var t=this.layermenuEl;t.hide(),zt(t)}},{key:"setPosition",value:function(t,e){if(this.elDowm=!1,!this.isHide){var r=this.layermenuEl,n=this.dragContentEl,o=r.show().offset().width,i=n.offset(),c=i.height/2,a=t;i.width-t<=o&&(a-=o),r.css("left","".concat(a,"px")),e>c?r.css("bottom","".concat(i.height-e,"px")).css("max-height","".concat(e,"px")).css("top","auto"):r.css("top","".concat(e,"px")).css("max-height","".concat(i.height-e,"px")).css("bottom","auto"),Mt(r)}}},{key:"buildCircleItem",value:function(t){var e=this;this.elDowm=!1;var r=!1;return l("div",t.css).on("mousedown",(function(n){r=!0;var o=n||event,i=o.clientX,c=o.clientY,a=e.el.offset(),l=a.width,u=a.height,f=a.left,s=a.top;e.sheet.el.on("mousemove",(function(n){if(r){var o=n||window.event,a=o.clientX,h=o.clientY;"circle top-left"===t.css?(e.el.css("width",l-(a-i)+"px"),e.el.css("height",u-(h-c)+"px"),e.el.css("left",f+(a-i)+"px"),e.el.css("top",s+(h-c)+"px")):"circle top-center"===t.css?(e.el.css("height",u-(h-c)+"px"),e.el.css("top",s+(h-c)+"px")):"circle top-right"===t.css?(e.el.css("width",l+(a-i)+"px"),e.el.css("height",u-(h-c)+"px"),e.el.css("right",f-(a-i)+"px"),e.el.css("top",s+(h-c)+"px")):"circle middle-left"===t.css?(e.el.css("width",l-(a-i)+"px"),e.el.css("height",u+"px"),e.el.css("left",f+(a-i)+"px")):"circle middle-right"===t.css?(e.el.css("width",l+(a-i)+"px"),e.el.css("height",u+"px"),e.el.css("right",f-(a-i)+"px")):"circle bottom-left"===t.css?(e.el.css("width",l-(a-i)+"px"),e.el.css("height",u+(h-c)+"px"),e.el.css("left",f+(a-i)+"px"),e.el.css("bottom",s+(h+c)+"px")):"circle bottom-center"===t.css?(e.el.css("height",u+(h-c)+"px"),e.el.css("bottom",s-(h+c)+"px")):"circle bottom-right"===t.css&&(e.el.css("width",l+(a-i)+"px"),e.el.css("height",u+(h-c)+"px"),e.el.css("right",f-(a-i)+"px"),e.el.css("bottom",s+(h+c)+"px"))}})).on("mouseup",(function(t){r=!1}))})).on("mouseup",(function(){r=!1}))}}])&&yu(e.prototype,r),n&&yu(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function wu(t){return(wu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ou(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function ku(t,e){return(ku=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function ju(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=xu(t);if(e){var o=xu(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return Su(this,r)}}function Su(t,e){if(e&&("object"===wu(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function xu(t){return(xu=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Eu=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ku(t,e)}(i,t);var e,r,n,o=ju(i);function i(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this,"div","".concat(Wt,"-icon"))).iconNameEl=l("div","view-icon-img-".concat(t)),e.child(e.iconNameEl),e}return e=i,(r=[{key:"setName",value:function(t){this.iconNameEl.className("view-icon-img-".concat(t))}}])&&Ou(e.prototype,r),n&&Ou(e,n),Object.defineProperty(e,"prototype",{writable:!1}),i}(a);function Pu(t){return(Pu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _u(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Ru(t,e){return(Ru=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Tu(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=Au(t);if(e){var o=Au(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return Cu(this,r)}}function Cu(t,e){if(e&&("object"===Pu(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Au(t){return(Au=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Iu=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Ru(t,e)}(i,t);var e,r,n,o=Tu(i);function i(t,e){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),(r=o.call(this,"div","view-text")).iconNameEl=l("div","view-text-".concat(t)),r.child(r.iconNameEl.html(e)),r}return e=i,(r=[{key:"setName",value:function(t){this.iconNameEl.className("view-icon-img-".concat(t))}}])&&_u(e.prototype,r),n&&_u(e,n),Object.defineProperty(e,"prototype",{writable:!1}),i}(a);function Du(t){return(Du="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Bu(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function zu(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Mu(){return(Mu="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=Nu(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(arguments.length<3?t:r):o.value}}).apply(this,arguments)}function Nu(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Vu(t)););return t}function Hu(t,e){return(Hu=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Fu(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=Vu(t);if(e){var o=Vu(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return Wu(this,r)}}function Wu(t,e){if(e&&("object"===Du(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Vu(t){return(Vu=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Uu=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Hu(t,e)}(i,t);var e,r,n,o=Fu(i);function i(){return Bu(this,i),o.apply(this,arguments)}return e=i,(r=[{key:"element",value:function(){var t=this;return Mu(Vu(i.prototype),"element",this).call(this).child(new Eu(this.tag)).child(new Iu(this.tag,this.value)).on("click",(function(){return t.change(t.tag)}))}},{key:"setState",value:function(t){this.el.disabled(t)}}])&&zu(e.prototype,r),n&&zu(e,n),Object.defineProperty(e,"prototype",{writable:!1}),i}(Sn);function $u(t){return($u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Lu(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function qu(t,e){return(qu=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Yu(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=Ku(t);if(e){var o=Ku(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return Xu(this,r)}}function Xu(t,e){if(e&&("object"===$u(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Ku(t){return(Ku=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Zu=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&qu(t,e)}(i,t);var e,r,n,o=Yu(i);function i(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),o.call(this,"first","Ctrl+F","首页")}return e=i,r&&Lu(e.prototype,r),n&&Lu(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}(Uu);function Ju(t){return(Ju="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Gu(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Qu(t,e){return(Qu=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function tf(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=rf(t);if(e){var o=rf(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return ef(this,r)}}function ef(t,e){if(e&&("object"===Ju(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function rf(t){return(rf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var nf=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Qu(t,e)}(i,t);var e,r,n,o=tf(i);function i(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),o.call(this,"end","Ctrl+E","末页")}return e=i,r&&Gu(e.prototype,r),n&&Gu(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}(Uu);function of(t){return(of="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function cf(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function af(t,e){return(af=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function lf(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=ff(t);if(e){var o=ff(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return uf(this,r)}}function uf(t,e){if(e&&("object"===of(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function ff(t){return(ff=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var sf=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&af(t,e)}(i,t);var e,r,n,o=lf(i);function i(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),o.call(this,"next","Ctrl+N","上一页")}return e=i,r&&cf(e.prototype,r),n&&cf(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}(Uu);function hf(t){return(hf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function pf(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function yf(t,e){return(yf=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function df(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=bf(t);if(e){var o=bf(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return vf(this,r)}}function vf(t,e){if(e&&("object"===hf(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function bf(t){return(bf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var mf=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&yf(t,e)}(i,t);var e,r,n,o=df(i);function i(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),o.call(this,"last","Ctrl+L","下一页")}return e=i,r&&pf(e.prototype,r),n&&pf(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}(Uu);function gf(t){return(gf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function wf(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Of(t,e){return(Of=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function kf(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=Sf(t);if(e){var o=Sf(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return jf(this,r)}}function jf(t,e){if(e&&("object"===gf(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Sf(t){return(Sf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var xf=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Of(t,e)}(i,t);var e,r,n,o=kf(i);function i(t,e){var r;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),(r=o.call(this,"div","btn-text-input")).iconNameEl=l("div","btn-input");r.lableNameEl=l("div","btn-text"),r.child(r.iconNameEl.html("<input type='text'/>"));return r.child(r.lableNameEl.html('<span class="" style="margin-left: 8px; display: inline-block; line-height: 17px;">/</span><span class="">3</span><span class=""> &nbsp;&nbsp;(共86条)</span>')),r}return e=i,(r=[{key:"setName",value:function(t){this.iconNameEl.className("view-icon-img-".concat(t))}}])&&wf(e.prototype,r),n&&wf(e,n),Object.defineProperty(e,"prototype",{writable:!1}),i}(a);function Ef(t){return(Ef="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Pf(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _f(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Rf(){return(Rf="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=Tf(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(arguments.length<3?t:r):o.value}}).apply(this,arguments)}function Tf(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Df(t)););return t}function Cf(t,e){return(Cf=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Af(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=Df(t);if(e){var o=Df(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return If(this,r)}}function If(t,e){if(e&&("object"===Ef(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Df(t){return(Df=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Bf=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Cf(t,e)}(i,t);var e,r,n,o=Af(i);function i(){return Pf(this,i),o.apply(this,arguments)}return e=i,(r=[{key:"element",value:function(){var t=this;return Rf(Df(i.prototype),"element",this).call(this).child(new xf(this.tag)).on("click",(function(){return t.change(t.tag)}))}},{key:"setState",value:function(t){this.el.disabled(t)}}])&&_f(e.prototype,r),n&&_f(e,n),Object.defineProperty(e,"prototype",{writable:!1}),i}(Sn);function zf(t){return(zf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Mf(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Nf(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Hf(){return(Hf="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=Ff(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(arguments.length<3?t:r):o.value}}).apply(this,arguments)}function Ff(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=$f(t)););return t}function Wf(t,e){return(Wf=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Vf(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=$f(t);if(e){var o=$f(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return Uf(this,r)}}function Uf(t,e){if(e&&("object"===zf(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function $f(t){return($f=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Lf=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Wf(t,e)}(i,t);var e,r,n,o=Vf(i);function i(){return Mf(this,i),o.apply(this,arguments)}return e=i,(r=[{key:"dropdown",value:function(){}},{key:"getValue",value:function(t){return t}},{key:"element",value:function(){var t=this,e=this.tag;return this.dd=this.dropdown(),this.dd.change=function(r){return t.change(e,t.getValue(r))},Hf($f(i.prototype),"element",this).call(this).child(this.dd)}},{key:"setState",value:function(t){t&&(this.value=t,this.dd.setTitle(t))}}])&&Nf(e.prototype,r),n&&Nf(e,n),Object.defineProperty(e,"prototype",{writable:!1}),i}(Sn),qf=[{key:"10",title:"每页10条"},{key:"30",title:"每页30条"},{key:"50",title:"每页50条"}],Yf=[{key:"html",title:"html打印"},{key:"canvas",title:"canvas打印"}],Xf=[{key:"excel",title:"excel"},{key:"pdf",title:"PDF"},{key:"image",title:"图片"}];function Kf(t){return(Kf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Zf(t){return function(t){if(Array.isArray(t))return Jf(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return Jf(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Jf(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Jf(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function Gf(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Qf(t,e){return(Qf=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function ts(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=rs(t);if(e){var o=rs(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return es(this,r)}}function es(t,e){if(e&&("object"===Kf(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function rs(t){return(rs=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var ns=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Qf(t,e)}(i,t);var e,r,n,o=ts(i);function i(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i);var e=qf.map((function(e){return l("div","".concat(Wt,"-item")).on("click",(function(){t.setTitle(e.title),t.change(e)})).child(e.title)}));return t=o.call.apply(o,[this,qf[0].title,"160px",!0,"bottom-left"].concat(Zf(e)))}return e=i,r&&Gf(e.prototype,r),n&&Gf(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}(Vn);function os(t){return(os="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function is(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function cs(t,e){return(cs=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function as(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=us(t);if(e){var o=us(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return ls(this,r)}}function ls(t,e){if(e&&("object"===os(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function us(t){return(us=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var fs=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&cs(t,e)}(i,t);var e,r,n,o=as(i);function i(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),o.call(this,"record")}return e=i,(r=[{key:"getValue",value:function(t){return t.key}},{key:"dropdown",value:function(){return new ns}}])&&is(e.prototype,r),n&&is(e,n),Object.defineProperty(e,"prototype",{writable:!1}),i}(Lf);function ss(t){return(ss="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function hs(t){return function(t){if(Array.isArray(t))return ps(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return ps(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ps(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ps(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function ys(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function ds(t,e){return(ds=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function vs(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=ms(t);if(e){var o=ms(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return bs(this,r)}}function bs(t,e){if(e&&("object"===ss(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function ms(t){return(ms=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var gs=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ds(t,e)}(i,t);var e,r,n,o=vs(i);function i(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i);var e=new Eu("print"),r=Yf.map((function(e){return l("div","".concat(Wt,"-item")).on("click",(function(){t.change(e)})).child(e.title)}));return t=o.call.apply(o,[this,e,"160px",!0,"bottom-left"].concat(hs(r)))}return e=i,r&&ys(e.prototype,r),n&&ys(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}(Vn);function ws(t){return(ws="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Os(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function ks(t,e){return(ks=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function js(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=xs(t);if(e){var o=xs(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return Ss(this,r)}}function Ss(t,e){if(e&&("object"===ws(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function xs(t){return(xs=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Es=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ks(t,e)}(i,t);var e,r,n,o=js(i);function i(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),o.call(this,"print")}return e=i,(r=[{key:"getValue",value:function(t){return t.key}},{key:"dropdown",value:function(){return new gs}}])&&Os(e.prototype,r),n&&Os(e,n),Object.defineProperty(e,"prototype",{writable:!1}),i}(Lf);function Ps(t){return(Ps="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _s(t){return function(t){if(Array.isArray(t))return Rs(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return Rs(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Rs(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Rs(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function Ts(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Cs(t,e){return(Cs=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function As(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=Ds(t);if(e){var o=Ds(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return Is(this,r)}}function Is(t,e){if(e&&("object"===Ps(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Ds(t){return(Ds=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Bs=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Cs(t,e)}(i,t);var e,r,n,o=As(i);function i(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i);var e=new Eu("export"),r=Xf.map((function(e){return l("div","".concat(Wt,"-item")).on("click",(function(){t.change(e)})).child(e.title)}));return t=o.call.apply(o,[this,e,"160px",!0,"bottom-left"].concat(_s(r)))}return e=i,r&&Ts(e.prototype,r),n&&Ts(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}(Vn);function zs(t){return(zs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ms(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Ns(t,e){return(Ns=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Hs(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=Ws(t);if(e){var o=Ws(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return Fs(this,r)}}function Fs(t,e){if(e&&("object"===zs(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Ws(t){return(Ws=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Vs=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Ns(t,e)}(i,t);var e,r,n,o=Hs(i);function i(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),o.call(this,"export")}return e=i,(r=[{key:"getValue",value:function(t){return t.key}},{key:"dropdown",value:function(){return new Bs}}])&&Ms(e.prototype,r),n&&Ms(e,n),Object.defineProperty(e,"prototype",{writable:!1}),i}(Lf);function Us(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function $s(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Ls(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null==r)return;var n,o,i=[],c=!0,a=!1;try{for(r=r.call(t);!(c=(n=r.next()).done)&&(i.push(n.value),!e||i.length!==e);c=!0);}catch(t){a=!0,o=t}finally{try{c||null==r.return||r.return()}finally{if(a)throw o}}return i}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return qs(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return qs(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function qs(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function Ys(){return l("div","".concat(Wt,"-toolbar-divider"))}function Xs(){var t=this;this.btns2=[],this.items.forEach((function(e){if(Array.isArray(e))e.forEach((function(e){var r=e.el,n=r.box(),o=r.computedStyle(),i=o.marginLeft,c=o.marginRight;t.btns2.push([r,n.width+parseInt(i,10)+parseInt(c,10)])}));else{var r=e.box(),n=e.computedStyle(),o=n.marginLeft,i=n.marginRight;t.btns2.push([e,r.width+parseInt(o,10)+parseInt(i,10)])}}))}function Ks(){var t,e=this.el,r=this.btns,n=this.btns2;e.css("width","".concat(this.widthFn(),"px"));var o=e.box(),i=160,c=[],a=[];n.forEach((function(t,e){var r=Ls(t,2),l=r[0],u=r[1];i+=u,e===n.length-1||i<o.width?c.push(l):(u,a.push(l))})),(t=r.html("")).children.apply(t,c)}var Zs=function(){function t(e,r){var n=this,o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];Us(this,t),this.data=e,this.change=function(){},this.widthFn=r,this.isHide=o;e.defaultStyle();this.items=[[this.first=new Zu],Ys(),[this.next=new sf],Ys(),[this.input=new Bf],Ys(),[this.record=new fs],Ys(),[this.last=new mf],Ys(),[this.end=new nf],Ys(),[this.print=new Es],Ys(),[this.export=new Vs]],this.el=l("div","".concat(Wt,"-toolbar")),this.btns=l("div","".concat(Wt,"-toolbar-btns")),this.items.forEach((function(t){Array.isArray(t)?t.forEach((function(t){n.btns.child(t.el),t.change=function(){n.change.apply(n,arguments)}})):n.btns.child(t.el)})),this.el.child(this.btns),o?this.el.hide():(this.reset(),setTimeout((function(){Xs.call(n),Ks.call(n)}),0),Dt(window,"resize",(function(){Ks.call(n)})))}var e,r,n;return e=t,(r=[{key:"paintformatActive",value:function(){return this.paintformatEl.active()}},{key:"paintformatToggle",value:function(){this.paintformatEl.toggle()}},{key:"trigger",value:function(t){this["".concat(t,"El")].click()}},{key:"resetData",value:function(t){this.data=t,this.reset()}},{key:"reset",value:function(){if(!this.isHide){var t=this.data.getSelectedCellStyle();t.font,t.format}}}])&&$s(e.prototype,r),n&&$s(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function Js(t){return function(t){if(Array.isArray(t))return Gs(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return Gs(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Gs(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Gs(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function Qs(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function th(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var eh=function(){function t(e,r){var n,o=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"600px";Qs(this,t),this.title=e,this.el=l("div","".concat(Wt,"-modal")).css("width",i).children(l("div","".concat(Wt,"-modal-header")).children(new Pe("close").on("click.stop",(function(){return o.hide()})),this.title),(n=l("div","".concat(Wt,"-modal-content"))).children.apply(n,Js(r))).hide()}var e,r,n;return e=t,(r=[{key:"show",value:function(){var t=this;this.dimmer=l("div","".concat(Wt,"-dimmer active")),document.body.appendChild(this.dimmer.el);var e=this.el.show().box(),r=e.width,n=e.height,o=document.documentElement,i=o.clientHeight,c=o.clientWidth;this.el.offset({left:(c-r)/2,top:(i-n)/3}),window.xkeydownEsc=function(e){27===e.keyCode&&t.hide()},Dt(window,"keydown",window.xkeydownEsc)}},{key:"hide",value:function(){this.el.hide(),document.body.removeChild(this.dimmer.el),Bt(window,"keydown",window.xkeydownEsc),delete window.xkeydownEsc}}])&&th(e.prototype,r),n&&th(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function rh(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var nh=function(){function t(e,r){var n=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.vchange=function(){},this.el=l("div","".concat(Wt,"-form-input")),this.input=l("input","").css("width",e).on("input",(function(t){return n.vchange(t)})).attr("placeholder",r),this.el.child(this.input)}var e,r,n;return e=t,(r=[{key:"focus",value:function(){var t=this;setTimeout((function(){t.input.el.focus()}),10)}},{key:"hint",value:function(t){this.input.attr("placeholder",t)}},{key:"val",value:function(t){return this.input.val(t)}}])&&rh(e.prototype,r),n&&rh(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function oh(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ih(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var ch=function(){function t(e,r,n){var o=this,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(t){return t},c=arguments.length>4&&void 0!==arguments[4]?arguments[4]:function(){};oh(this,t),this.key=e,this.getTitle=i,this.vchange=function(){},this.el=l("div","".concat(Wt,"-form-select")),this.suggest=new we(r.map((function(t){return{key:t,title:o.getTitle(t)}})),(function(t){o.itemClick(t.key),c(t.key),o.vchange(t.key)}),n,this.el),this.el.children(this.itemEl=l("div","input-text").html(this.getTitle(e)),this.suggest.el).on("click",(function(){return o.show()}))}var e,r,n;return e=t,(r=[{key:"show",value:function(){this.suggest.search("")}},{key:"itemClick",value:function(t){this.key=t,this.itemEl.html(this.getTitle(t))}},{key:"val",value:function(t){return void 0!==t?(this.key=t,this.itemEl.html(this.getTitle(t)),this):this.key}}])&&ih(e.prototype,r),n&&ih(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function ah(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var lh={number:/(^\d+$)|(^\d+(\.\d{0,4})?$)/,date:/^\d{4}-\d{1,2}-\d{1,2}$/},uh=function(){function t(e,r,n,o){var i=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.label="",this.rule=r,n&&(this.label=l("label","label").css("width","".concat(o,"px")).html(n)),this.tip=l("div","tip").child("tip").hide(),this.input=e,this.input.vchange=function(){return i.validate()},this.el=l("div","".concat(Wt,"-form-field")).children(this.label,e.el,this.tip)}var e,r,n;return e=t,(r=[{key:"isShow",value:function(){return"none"!==this.el.css("display")}},{key:"show",value:function(){this.el.show()}},{key:"hide",value:function(){return this.el.hide(),this}},{key:"val",value:function(t){return this.input.val(t)}},{key:"hint",value:function(t){this.input.hint(t)}},{key:"validate",value:function(){var t=this.input,e=this.rule,r=this.tip,n=this.el,o=t.val();return e.required&&/^\s*$/.test(o)?(r.html(et("validation.required")),n.addClass("error"),!1):!e.type&&!e.pattern||(e.pattern||lh[e.type]).test(o)?(n.removeClass("error"),!0):(r.html(et("validation.notMatch")),n.addClass("error"),!1)}}])&&ah(e.prototype,r),n&&ah(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function fh(t){return(fh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function sh(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function hh(t,e){return(hh=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function ph(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=dh(t);if(e){var o=dh(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return yh(this,r)}}function yh(t,e){if(e&&("object"===fh(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function dh(t){return(dh=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var vh=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&hh(t,e)}(i,t);var e,r,n,o=ph(i);function i(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i);var e=new uh(new ch("cell",["cell"],"100%",(function(t){return et("dataValidation.modeType.".concat(t))})),{required:!0},"".concat(et("dataValidation.range"),":"),100),r=new uh(new nh("120px","E3 or E3:F12"),{required:!0,pattern:/^([A-Z]{1,2}[1-9]\d*)(:[A-Z]{1,2}[1-9]\d*)?$/}),n=new uh(new ch("list",["list","number","date","phone","email"],"100%",(function(t){return et("dataValidation.type.".concat(t))}),(function(e){return t.criteriaSelected(e)})),{required:!0},"".concat(et("dataValidation.criteria"),":"),100),c=new uh(new ch("be",["be","nbe","eq","neq","lt","lte","gt","gte"],"160px",(function(t){return et("dataValidation.operator.".concat(t))}),(function(e){return t.criteriaOperatorSelected(e)})),{required:!0}).hide(),a=new uh(new nh("70px","10"),{required:!0}).hide(),u=new uh(new nh("70px","100"),{required:!0,type:"number"}).hide(),f=new uh(new nh("120px","a,b,c"),{required:!0}),s=new uh(new nh("70px","10"),{required:!0,type:"number"}).hide();return(t=o.call(this,et("contextmenu.validation"),[l("div","".concat(Wt,"-form-fields")).children(e.el,r.el),l("div","".concat(Wt,"-form-fields")).children(n.el,c.el,a.el,u.el,s.el,f.el),l("div","".concat(Wt,"-buttons")).children(new er("cancel").on("click",(function(){return t.btnClick("cancel")})),new er("remove").on("click",(function(){return t.btnClick("remove")})),new er("save","primary").on("click",(function(){return t.btnClick("save")})))])).mf=e,t.rf=r,t.cf=n,t.of=c,t.minvf=a,t.maxvf=u,t.vf=s,t.svf=f,t.change=function(){},t}return e=i,(r=[{key:"showVf",value:function(t){var e="date"===t?"2018-11-12":"10",r=this.vf;r.input.hint(e),r.show()}},{key:"criteriaSelected",value:function(t){var e=this.of,r=this.minvf,n=this.maxvf,o=this.vf,i=this.svf;"date"===t||"number"===t?(e.show(),r.rule.type=t,n.rule.type=t,"date"===t?(r.hint("2018-11-12"),n.hint("2019-11-12")):(r.hint("10"),n.hint("100")),r.show(),n.show(),o.hide(),i.hide()):("list"===t?i.show():i.hide(),o.hide(),e.hide(),r.hide(),n.hide())}},{key:"criteriaOperatorSelected",value:function(t){if(t){var e=this.minvf,r=this.maxvf,n=this.vf;if("be"===t||"nbe"===t)e.show(),r.show(),n.hide();else{var o=this.cf.val();n.rule.type=o,"date"===o?n.hint("2018-11-12"):n.hint("10"),n.show(),e.hide(),r.hide()}}}},{key:"btnClick",value:function(t){if("cancel"===t)this.hide();else if("remove"===t)this.change("remove"),this.hide();else if("save"===t){for(var e=["mf","rf","cf","of","svf","vf","minvf","maxvf"],r=0;r<e.length;r+=1){var n=this[e[r]];if(n.isShow()&&!n.validate())return}var o=this.mf.val(),i=this.rf.val(),c=this.cf.val(),a=this.of.val(),l=this.svf.val();"number"!==c&&"date"!==c||(l="be"===a||"nbe"===a?[this.minvf.val(),this.maxvf.val()]:this.vf.val()),this.change("save",o,i,{type:c,operator:a,required:!1,value:l}),this.hide()}}},{key:"setValue",value:function(t){if(t){var e=this.mf,r=this.rf,n=this.cf,o=this.of,i=this.svf,c=this.vf,a=this.minvf,l=this.maxvf,u=t.mode,f=t.ref,s=t.validator||{type:"list"},h=s.type,p=s.operator,y=s.value;e.val(u||"cell"),r.val(f),n.val(h),o.val(p),Array.isArray(y)?(a.val(y[0]),l.val(y[1])):(i.val(y||""),c.val(y||"")),this.criteriaSelected(h),this.criteriaOperatorSelected(p)}this.show()}}])&&sh(e.prototype,r),n&&sh(e,n),Object.defineProperty(e,"prototype",{writable:!1}),i}(eh);function bh(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function mh(t){return l("div","".concat(Wt,"-item ").concat(t))}function gh(t){var e=this;return mh("state").child(et("sort.".concat(t))).on("click.stop",(function(){return e.itemClick(t)}))}function wh(t){var e=this,r=this.filterbEl,n=this.filterValues;r.html(""),Object.keys(t).forEach((function(o,i){var c=t[o],a=n.includes(o)?"checked":"";r.child(l("div","".concat(Wt,"-item state ").concat(a)).on("click.stop",(function(){return e.filterClick(i,o)})).children(""===o?et("filter.empty"):o,l("div","label").html("(".concat(c,")"))))}))}function Oh(){var t=this.filterhEl,e=this.filterValues,r=this.values;t.html("".concat(e.length," / ").concat(r.length)),t.checked(e.length===r.length)}var kh=function(){function t(){var e=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.filterbEl=l("div","".concat(Wt,"-body")),this.filterhEl=l("div","".concat(Wt,"-header state")).on("click.stop",(function(){return e.filterClick(0,"all")})),this.el=l("div","".concat(Wt,"-sort-filter")).children(this.sortAscEl=gh.call(this,"asc"),this.sortDescEl=gh.call(this,"desc"),mh("divider"),l("div","".concat(Wt,"-filter")).children(this.filterhEl,this.filterbEl),l("div","".concat(Wt,"-buttons")).children(new er("cancel").on("click",(function(){return e.btnClick("cancel")})),new er("ok","primary").on("click",(function(){return e.btnClick("ok")})))).hide(),this.ci=null,this.sortDesc=null,this.values=null,this.filterValues=[]}var e,r,n;return e=t,(r=[{key:"btnClick",value:function(t){if("ok"===t){var e=this.ci,r=this.sort,n=this.filterValues;this.ok&&this.ok(e,r,"in",n)}this.hide()}},{key:"itemClick",value:function(t){this.sort=t;var e=this.sortAscEl,r=this.sortDescEl;e.checked("asc"===t),r.checked("desc"===t)}},{key:"filterClick",value:function(t,e){var r=this.filterbEl,n=this.filterValues,o=this.values,i=r.children();"all"===e?i.length===n.length?(this.filterValues=[],i.forEach((function(t){return l(t).checked(!1)}))):(this.filterValues=Array.from(o),i.forEach((function(t){return l(t).checked(!0)}))):l(i[t]).toggle("checked")?n.push(e):n.splice(n.findIndex((function(t){return t===e})),1),Oh.call(this)}},{key:"set",value:function(t,e,r,n){this.ci=t;var o=this.sortAscEl,i=this.sortDescEl;null!==n?(this.sort=n.order,o.checked(n.asc()),i.checked(n.desc())):(this.sortDesc=null,o.checked(!1),i.checked(!1)),this.values=Object.keys(e),this.filterValues=r?Array.from(r.value):Object.keys(e),wh.call(this,e,r),Oh.call(this)}},{key:"setOffset",value:function(t){var e=this;this.el.offset(t).show();var r=1;Mt(this.el,(function(){r<=0&&e.hide(),r-=1}))}},{key:"show",value:function(){this.el.show()}},{key:"hide",value:function(){this.el.hide(),zt(this.el)}}])&&bh(e.prototype,r),n&&bh(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function jh(t,e){var r=l("div","".concat(Wt,"-toast")),n=l("div","".concat(Wt,"-dimmer active"));r.children(l("div","".concat(Wt,"-toast-header")).children(new Pe("close").on("click.stop",(function(){return document.body.removeChild(r.el),void document.body.removeChild(n.el)})),t),l("div","".concat(Wt,"-toast-content")).html(e)),document.body.appendChild(r.el),document.body.appendChild(n.el);var o=r.box(),i=o.width,c=o.height,a=document.documentElement,u=a.clientHeight,f=a.clientWidth;r.offset({left:(f-i)/2,top:(u-c)/3})}var Sh=r(1),xh=r.n(Sh);function Eh(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Ph(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null==r)return;var n,o,i=[],c=!0,a=!1;try{for(r=r.call(t);!(c=(n=r.next()).done)&&(i.push(n.value),!e||i.length!==e);c=!0);}catch(t){a=!0,o=t}finally{try{c||null==r.return||r.return()}finally{if(a)throw o}}return i}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return _h(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _h(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _h(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function Rh(t,e){var r,n=this;return function(){for(var o=n,i=arguments.length,c=new Array(i),a=0;a<i;a++)c[a]=arguments[a];var l=c;r||(r=setTimeout((function(){r=null,t.apply(o,l)}),e))}}function Th(){var t=this.data,e=this.verticalScrollbar,r=this.horizontalScrollbar,n=t.getSelectedRect(),o=n.l,i=n.t,c=n.left,a=n.top,l=n.width,u=n.height,f=this.getTableOffset();if(Math.abs(c)+l>f.width)r.move({left:o+l-f.width});else{var s=t.freezeTotalWidth();c<s&&r.move({left:o-1-s})}if(Math.abs(a)+u>f.height)e.move({top:i+u-f.height-1});else{var h=t.freezeTotalHeight();a<h&&e.move({top:i-1-h})}}function Ch(t,e,r){var n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],o=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(-1!==e||-1!==r){var i=this.table,c=this.selector,a=this.toolbar,l=this.data,u=this.vtoolbar,f=this.contextMenu,s=l.getCell(e,r);t?(c.setEnd(e,r,o),this.trigger("cells-selected",s,c.range)):(c.set(e,r,n),this.trigger("cell-selected",s,e,r)),f.setMode(-1===e||-1===r?"row-col":"range"),a.reset(),u.reset(),i.render()}}function Ah(t,e){var r=this.selector,n=this.data,o=n.rows,i=n.cols,c=Ph(r.indexes,2),a=c[0],l=c[1],u=r.range,f=u.eri,s=u.eci;if(t){var h=Ph(r.moveIndexes,2);a=h[0],l=h[1]}"left"===e?l>0&&(l-=1):"right"===e?(s!==l&&(l=s),l<i.len-1&&(l+=1)):"up"===e?a>0&&(a-=1):"down"===e?(f!==a&&(a=f),a<o.len-1&&(a+=1)):"row-first"===e?l=0:"row-last"===e?l=i.len-1:"col-first"===e?a=0:"col-last"===e&&(a=o.len-1),t&&(r.moveIndexes=[a,l]),Ch.call(this,t,a,l),Th.call(this)}function Ih(t){if(0===t.buttons&&t.target.className!=="".concat(Wt,"-resizer-hover")){var e=t.offsetX,r=t.offsetY,n=this.rowResizer,o=this.colResizer,i=this.tableEl,c=this.data,a=c.rows,l=c.cols;if(e>l.indexWidth&&r>a.height)return n.hide(),void o.hide();var u=i.box(),f=c.getCellRectByXY(t.offsetX,t.offsetY);f.ri>=0&&-1===f.ci?(f.width=l.indexWidth,n.show(f,{width:u.width}),a.isHide(f.ri-1)?n.showUnhide(f.ri):n.hideUnhide()):n.hide(),-1===f.ri&&f.ci>=0?(f.height=a.height,o.show(f,{height:u.height}),l.isHide(f.ci-1)?o.showUnhide(f.ci):o.hideUnhide()):o.hide()}}function Dh(t){var e=this.verticalScrollbar,r=this.horizontalScrollbar,n=this.data,o=e.scroll().top,i=r.scroll().left,c=n.rows,a=n.cols,l=t.deltaY,u=t.deltaX,f=function(t,e){var r=t,n=0;do{n=e(r),r+=1}while(n<=0);return n},s=function(t){if(t>0){var r=n.scroll.ri+1;if(r<c.len){var i=f(r,(function(t){return c.getHeight(t)}));e.move({top:o+i-1})}}else{var a=n.scroll.ri-1;if(a>=0){var l=f(a,(function(t){return c.getHeight(t)}));e.move({top:0===a?0:o-l})}}},h=Math.abs(l),p=Math.abs(u),y=Math.max(h,p);/Firefox/i.test(window.navigator.userAgent)&&Rh(s(t.detail),50),y===p&&Rh(function(t){if(t>0){var e=n.scroll.ci+1;if(e<a.len){var o=f(e,(function(t){return a.getWidth(t)}));r.move({left:i+o-1})}}else{var c=n.scroll.ci-1;if(c>=0){var l=f(c,(function(t){return a.getWidth(t)}));r.move({left:0===c?0:i-l})}}}(u),50),y===h&&Rh(s(l),50)}function Bh(t,e){var r=this.verticalScrollbar,n=this.horizontalScrollbar,o=r.scroll().top,i=n.scroll().left;"left"===t||"right"===t?n.move({left:i-e}):"up"!==t&&"down"!==t||r.move({top:o-e})}function zh(){var t=this.data,e=this.verticalScrollbar,r=this.getTableOffset().height,n=t.exceptRowTotalHeight(0,-1);e.set(r,t.rows.totalHeight()-n)}function Mh(){var t=this.data,e=this.horizontalScrollbar,r=this.getTableOffset().width;t&&e.set(r,t.cols.totalWidth())}function Nh(){var t=this.selector,e=this.data,r=this.editor,n=Ph(e.freeze,2),o=n[0],i=n[1];if(o>0||i>0){var c=e.freezeTotalWidth(),a=e.freezeTotalHeight();r.setFreezeLengths(c,a)}t.resetAreaOffset()}function Hh(t){var e=this,r=this.data,n=(this.overlayerEl,this.overlayerCEl,this.selector,this.vtoolbar,this.table,this.el),o=xh()();this.background=new gu(this,o,t);var i=r.selector,c=i.ri,a=i.ci,l=r.cellRect(c,a),u=l.left+58,f=l.top+25;r.getCellRectByXY(u+650,f+386);this.background.el.css("left","".concat(u,"px")),this.background.el.css("top","".concat(f,"px")),n.children(this.background.el),this.background.itemClick=function(i){if("delete"===i)document.getElementById(o).remove();else if("fixed"===i){e.background.el.active(!1,"selected").active(!1,"active");var c=e.background.el.offset();e.background.el.css("top",c.top-25+"px").css("left",c.left-60+"px").css("height",c.height+"px").css("width",c.width+"px"),e.overlayerCEl.children(e.background.el),e.background.contextmenu=!0,e.overlayerEl.on("click",(function(t){var r=e.background.el.offset(),o=e.data.getCellRectByXY(t.offsetX,t.offsetY);o.left>r.left&&o.left<r.left+r.width&&o.top>r.top&&o.top<r.top+r.height&&e.background.contextmenu&&(e.background.el.css("top",r.top+25+"px").css("left",r.left+60+"px").css("height",r.height+"px").css("width",r.width+"px"),e.background.el.active(!0,"selected").active(!0,"active"),n.children(e.background.el),e.background.contextmenu=!1)}));var a={};a.src=t,a.height=c.height,a.width=c.width,a.top=c.top,a.left=c.left,a.isbackend=!1;var l=new Array;l.push(a),r.imgList&&l.push(r.imgList),r.imgList=l,e.table.resetData(r)}else if("backend"===i){var u=e.background.el.offset(),f={};f.src=t,f.height=u.height,f.width=u.width,f.top=u.top,f.left=u.left,f.isbackend=!0;var s=new Array;s.push(f),r.imgList&&s.push(r.imgList),r.imgList=s,e.table.resetData(r),document.getElementById(o).remove()}},console.log(this),Fh.call(this)}function Fh(){var t=this.tableEl,e=this.overlayerEl,r=this.overlayerCEl,n=this.table,o=this.toolbar,i=this.vtoolbar,c=this.selector,a=this.el,l=this.getTableOffset(),u=this.getRect();t.attr(u),e.offset(u),r.offset(l),a.css("width","".concat(u.width,"px")),zh.call(this),Mh.call(this),Nh.call(this),n.render(),o.reset(),i.reset(),c.reset()}function Wh(){var t=this.data,e=this.selector;t.clearClipboard(),e.hideClipboard()}function Vh(t){var e=this.data,r=this.selector;"read"!==e.settings.mode&&(e.copy(),e.copyToSystemClipboard(t),r.showClipboard())}function Uh(){var t=this.data,e=this.selector;"read"!==t.settings.mode&&(t.cut(),e.showClipboard())}function $h(t,e){var r=this.data;if("read"!==r.settings.mode)if(r.paste(t,(function(t){return jh("Tip",t)})))Fh.call(this);else if(e){var n=e.clipboardData.getData("text/plain");this.data.pasteFromText(n),Fh.call(this)}}function Lh(){this.data.hideRowsOrCols(),Fh.call(this)}function qh(t,e){this.data.unhideRowsOrCols(t,e),Fh.call(this)}function Yh(){this.data.autofilter(),Fh.call(this)}function Xh(){var t=this.toolbar;t.paintformatActive()&&($h.call(this,"format"),Wh.call(this),t.paintformatToggle())}function Kh(t){var e=this,r=this.selector,n=this.data,o=this.table,i=this.sortFilter,c=t.offsetX,a=t.offsetY,l=t.target.className==="".concat(Wt,"-selector-corner"),u=n.getCellRectByXY(c,a),f=u.left,s=u.top,h=u.width,p=u.height,y=u.ri,d=u.ci,v=n.autoFilter;if(v.includes(y,d)&&f+h-20<c&&s+p-20<a){var b=v.items(d,(function(t,e){return n.rows.getCell(t,e)}));return i.hide(),i.set(d,b,v.getFilter(d),v.getSort(d)),void i.setOffset({left:f,top:s+p+2})}t.shiftKey||(l?r.showAutofill(y,d):Ch.call(this,!1,y,d),Nt(window,(function(t){var o=n.getCellRectByXY(t.offsetX,t.offsetY);y=o.ri,d=o.ci,l?r.showAutofill(y,d):1!==t.buttons||t.shiftKey||Ch.call(e,!0,y,d,!0,!0)}),(function(){l&&r.arange&&"read"!==n.settings.mode&&n.autofill(r.arange,"all",(function(t){return jh("Tip",t)}))&&o.render(),r.hideAutofill(),Xh.call(e)}))),l||1!==t.buttons||t.shiftKey&&Ch.call(this,!0,y,d)}function Zh(){var t=this.editor,e=this.data.getSelectedRect(),r=this.getTableOffset(),n="top";e.top>r.height/2&&(n="bottom"),t.setOffset(e,n)}function Jh(){var t=this.editor,e=this.data;"read"!==e.settings.mode&&(Zh.call(this),t.setCell(e.getSelectedCell(),e.getSelectedValidator()),Wh.call(this))}function Gh(t){var e=this,r=this.data,n=this.table,o=this.selector;r.scrolly(t,(function(){o.resetBRLAreaOffset(),Zh.call(e),n.render()}))}function Qh(t){var e=this,r=this.data,n=this.table,o=this.selector;r.scrollx(t,(function(){o.resetBRTAreaOffset(),Zh.call(e),n.render()}))}function tp(t,e){var r=t.ri,n=this.table,o=this.selector;this.data.rows.setHeight(r,e),n.render(),o.resetAreaOffset(),zh.call(this),Zh.call(this)}function ep(t,e){var r=t.ci,n=this.table,o=this.selector;this.data.cols.setWidth(r,e),n.render(),o.resetAreaOffset(),Mh.call(this),Zh.call(this)}function rp(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"finished",r=this.data,n=this.table;if("read"!==r.settings.mode){r.setSelectedCellText(t,e);var o=r.selector,i=o.ri,c=o.ci;"finished"===e?n.render():this.trigger("cell-edited",t,i,c)}}function np(t){var e=this.data;"read"!==e.settings.mode&&("insert-row"===t?e.insert("row"):"delete-row"===t?e.delete("row"):"insert-column"===t?e.insert("column"):"delete-column"===t?e.delete("column"):"delete-cell"===t?e.deleteCell():"delete-cell-format"===t?e.deleteCell("format"):"delete-cell-text"===t?e.deleteCell("text"):"cell-printable"===t?e.setSelectedCellAttr("printable",!0):"cell-non-printable"===t?e.setSelectedCellAttr("printable",!1):"cell-editable"===t?e.setSelectedCellAttr("editable",!0):"cell-non-editable"===t&&e.setSelectedCellAttr("editable",!1),Wh.call(this),Fh.call(this))}function op(t,e){var r=this.data;"print"===t&&this.print.preview(),console.log(r)}function ip(t,e){var r=this.data;this.toolbar,e.target.files[0];Hh.call(this,"http://localhost:8085/jmreport/img/excel_online/a1644654762265.jpg"),document.getElementById("background").value="",console.log(r)}function cp(t,e){var r=this.data;this.toolbar;if(console.log(t),"undo"===t)console.log(r),this.undo();else if("redo"===t)this.redo();else if("print"===t)this.print.preview();else if("paintformat"===t)!0===e?Vh.call(this):Wh.call(this);else if("clearformat"===t)np.call(this,"delete-cell-format");else if("link"===t);else if("chart"===t);else if("autofilter"===t)Yh.call(this);else if("freeze"===t)if(e){var n=r.selector,o=n.ri,i=n.ci;this.freeze(o,i)}else this.freeze(0,0);else if("background"===t){document.getElementById("background").click()}else r.setSelectedCellAttr(t,e),"formula"!==t||r.selector.multiple()||Jh.call(this),Fh.call(this)}function ap(t,e,r,n){this.data.setAutoFilter(t,e,r,n),Fh.call(this)}function lp(){var t,e,r,n,o,i,c=this,a=this.selector,l=this.overlayerEl,u=this.rowResizer,f=this.colResizer,s=this.verticalScrollbar,h=this.horizontalScrollbar,p=this.editor,y=this.contextMenu,d=this.toolbar,v=this.vtoolbar,b=this.modalValidation,m=this.sortFilter;l.on("mousemove",(function(t){Ih.call(c,t)})).on("mousedown",(function(t){p.clear(),y.hide(),2===t.buttons?(c.data.xyInSelectedRect(t.offsetX,t.offsetY)||Kh.call(c,t),y.setPosition(t.offsetX,t.offsetY),t.stopPropagation()):2===t.detail?Jh.call(c):Kh.call(c,t)})).on("mousewheel.stop",(function(t){Dh.call(c,t)})).on("mouseout",(function(t){var e=t.offsetX;t.offsetY<=0&&f.hide(),e<=0&&u.hide()})),a.inputChange=function(t){rp.call(c,t,"input"),Jh.call(c)},t=l.el,r=(e={move:function(t,e){Bh.call(c,t,e)}}).move,n=e.end,o=0,i=0,Dt(t,"touchstart",(function(t){var e=t.touches[0],r=e.pageX,n=e.pageY;o=r,i=n})),Dt(t,"touchmove",(function(t){if(r){var e=t.changedTouches[0],n=e.pageX,c=e.pageY,a=n-o,l=c-i;(Math.abs(a)>10||Math.abs(l)>10)&&(Ht(a,l,t,r),o=n,i=c),t.preventDefault()}})),Dt(t,"touchend",(function(t){if(n){var e=t.changedTouches[0],r=e.pageX,c=e.pageY;Ht(r-o,c-i,t,n)}})),d.change=function(t,e){return cp.call(c,t,e)},d.upload=function(t,e){return ip.call(c,t,e)},v.change=function(t,e){return op.call(c,t,e)},m.ok=function(t,e,r,n){return ap.call(c,t,e,r,n)},u.finishedFn=function(t,e){tp.call(c,t,e)},f.finishedFn=function(t,e){ep.call(c,t,e)},u.unhideFn=function(t){qh.call(c,"row",t)},f.unhideFn=function(t){qh.call(c,"col",t)},s.moveFn=function(t,e){Gh.call(c,t,e)},h.moveFn=function(t,e){Qh.call(c,t,e)},p.change=function(t,e){rp.call(c,e,t)},b.change=function(t){if("save"===t){for(var e,r=arguments.length,n=new Array(r>1?r-1:0),o=1;o<r;o++)n[o-1]=arguments[o];(e=c.data).addValidation.apply(e,n)}else c.data.removeValidation()},y.itemClick=function(t){"validation"===t?b.setValue(c.data.getSelectedValidation()):"copy"===t?Vh.call(c):"cut"===t?Uh.call(c):"paste"===t?$h.call(c,"all"):"paste-value"===t?$h.call(c,"text"):"paste-format"===t?$h.call(c,"format"):"hide"===t?Lh.call(c):np.call(c,t)},Dt(window,"resize",(function(){c.reload()})),Dt(window,"click",(function(t){c.focusing=l.contains(t.target)})),Dt(window,"paste",(function(t){c.focusing&&($h.call(c,"all",t),t.preventDefault())})),Dt(window,"copy",(function(t){c.focusing&&(Vh.call(c,t),t.preventDefault())})),Dt(window,"keydown",(function(t){if(c.focusing){var e=t.keyCode||t.which,r=t.key,n=t.ctrlKey,o=t.shiftKey,i=t.metaKey;if(n||i)switch(e){case 90:c.undo(),t.preventDefault();break;case 89:c.redo(),t.preventDefault();break;case 67:break;case 88:Uh.call(c),t.preventDefault();break;case 85:d.trigger("underline"),t.preventDefault();break;case 86:break;case 37:Ah.call(c,o,"row-first"),t.preventDefault();break;case 38:Ah.call(c,o,"col-first"),t.preventDefault();break;case 39:Ah.call(c,o,"row-last"),t.preventDefault();break;case 40:Ah.call(c,o,"col-last"),t.preventDefault();break;case 32:Ch.call(c,!1,-1,c.data.selector.ci,!1),t.preventDefault();break;case 66:d.trigger("bold");break;case 73:d.trigger("italic")}else{switch(e){case 32:o&&Ch.call(c,!1,c.data.selector.ri,-1,!1);break;case 27:y.hide(),Wh.call(c);break;case 37:Ah.call(c,o,"left"),t.preventDefault();break;case 38:Ah.call(c,o,"up"),t.preventDefault();break;case 39:Ah.call(c,o,"right"),t.preventDefault();break;case 40:Ah.call(c,o,"down"),t.preventDefault();break;case 9:p.clear(),Ah.call(c,!1,o?"left":"right"),t.preventDefault();break;case 13:p.clear(),Ah.call(c,!1,o?"up":"down"),t.preventDefault();break;case 8:np.call(c,"delete-cell-text"),t.preventDefault()}"Delete"===r?(np.call(c,"delete-cell-text"),t.preventDefault()):e>=65&&e<=90||e>=48&&e<=57||e>=96&&e<=105||"="===t.key?(rp.call(c,t.key,"input"),Jh.call(c)):113===e&&Jh.call(c)}}}))}var up=function(){function t(e,r){var n=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.eventMap=Ft();var o=r.settings,i=o.view,c=o.showToolbar,a=o.showContextmenu,u=o.showVtoolbar;this.el=l("div","".concat(Wt,"-sheet")),this.toolbar=new fu(r,i.width,!c),this.vtoolbar=new Zs(r,i.width,!u),this.print=new pn(r),e.children(this.toolbar.el,this.vtoolbar.el,this.el,this.print.el),this.data=r,this.tableEl=l("canvas","".concat(Wt,"-table")),this.rowResizer=new $t(!1,r.rows.height),this.colResizer=new $t(!0,r.cols.minWidth),this.verticalScrollbar=new qt(!0),this.horizontalScrollbar=new qt(!1),this.editor=new Ye(Tr,(function(){return n.getTableOffset()}),r.rows.height),this.modalValidation=new vh,this.contextMenu=new On((function(){return n.getRect()}),!a),this.selector=new se(r),this.overlayerCEl=l("div","".concat(Wt,"-overlayer-content")).children(this.editor.el,this.selector.el),this.overlayerEl=l("div","".concat(Wt,"-overlayer")).child(this.overlayerCEl),this.sortFilter=new kh,this.el.children(this.tableEl,this.overlayerEl.el,this.rowResizer.el,this.colResizer.el,this.verticalScrollbar.el,this.horizontalScrollbar.el,this.contextMenu.el,this.modalValidation.el,this.sortFilter.el),this.table=new rn(this.tableEl.el,r),lp.call(this),Fh.call(this),Ch.call(this,!1,0,0)}var e,r,n;return e=t,(r=[{key:"on",value:function(t,e){return this.eventMap.on(t,e),this}},{key:"trigger",value:function(t){for(var e=this.eventMap,r=arguments.length,n=new Array(r>1?r-1:0),o=1;o<r;o++)n[o-1]=arguments[o];e.fire(t,n)}},{key:"resetData",value:function(t){this.editor.clear(),this.data=t,zh.call(this),Mh.call(this),this.toolbar.resetData(t),this.vtoolbar.resetData(t),this.print.resetData(t),this.selector.resetData(t),this.table.resetData(t)}},{key:"loadData",value:function(t){return this.data.setData(t),Fh.call(this),this}},{key:"freeze",value:function(t,e){return this.data.setFreeze(t,e),Fh.call(this),this}},{key:"undo",value:function(){this.data.undo(),Fh.call(this)}},{key:"redo",value:function(){this.data.redo(),Fh.call(this)}},{key:"reload",value:function(){return Fh.call(this),this}},{key:"getRect",value:function(){var t=this.data;return{width:t.viewWidth(),height:t.viewHeight()}}},{key:"setPrint",value:function(t){this.print.preview()}},{key:"getTableOffset",value:function(){var t=this.data,e=t.rows,r=t.cols,n=this.getRect(),o=n.width,i=n.height;return{width:o-r.indexWidth,height:i-e.height,left:r.indexWidth,top:e.height}}}])&&Eh(e.prototype,r),n&&Eh(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function fp(t){return(fp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function sp(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null==r)return;var n,o,i=[],c=!0,a=!1;try{for(r=r.call(t);!(c=(n=r.next()).done)&&(i.push(n.value),!e||i.length!==e);c=!0);}catch(t){a=!0,o=t}finally{try{c||null==r.return||r.return()}finally{if(a)throw o}}return i}(t,e)||pp(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function hp(t){return function(t){if(Array.isArray(t))return yp(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||pp(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function pp(t,e){if(t){if("string"==typeof t)return yp(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?yp(t,e):void 0}}function yp(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function dp(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function vp(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function bp(t,e,r){return e&&vp(t.prototype,e),r&&vp(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function mp(t,e){return(mp=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function gp(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=Op(t);if(e){var o=Op(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return wp(this,r)}}function wp(t,e){if(e&&("object"===fp(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Op(t){return(Op=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var kp=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&mp(t,e)}(r,t);var e=gp(r);function r(t){var n;dp(this,r);var o=new Pe("ellipsis");return(n=e.call(this,o,"auto",!1,"top-left")).contentClick=t,n}return bp(r,[{key:"reset",value:function(t){var e=this,r=t.map((function(t,r){return l("div","".concat(Wt,"-item")).css("width","150px").css("font-weight","normal").on("click",(function(){e.contentClick(r),e.hide()})).child(t)}));this.setContentChildren.apply(this,hp(r))}},{key:"setTitle",value:function(){}}]),r}(Vn),jp=[{key:"delete",title:rt("contextmenu.deleteSheet")}];function Sp(t){var e=this;return l("div","".concat(Wt,"-item")).child(t.title()).on("click",(function(){e.itemClick(t.key),e.hide()}))}function xp(){var t=this;return jp.map((function(e){return Sp.call(t,e)}))}var Ep=function(){function t(){var e;dp(this,t),this.el=(e=l("div","".concat(Wt,"-contextmenu")).css("width","160px")).children.apply(e,hp(xp.call(this))).hide(),this.itemClick=function(){}}return bp(t,[{key:"hide",value:function(){var t=this.el;t.hide(),zt(t)}},{key:"setOffset",value:function(t){var e=this.el;e.offset(t),e.show(),Mt(e)}}]),t}(),Pp=function(){function t(){var e=this,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){},o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){},i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(){};dp(this,t),this.swapFunc=n,this.updateFunc=i,this.dataNames=[],this.activeEl=null,this.deleteEl=null,this.items=[],this.moreEl=new kp((function(t){e.clickSwap2(e.items[t])})),this.contextMenu=new Ep,this.contextMenu.itemClick=o,this.el=l("div","".concat(Wt,"-bottombar")).children(this.contextMenu.el,this.menuEl=l("ul","".concat(Wt,"-menu")).child(l("li","").children(new Pe("add").on("click",(function(){r()})),l("span","").child(this.moreEl))))}return bp(t,[{key:"addItem",value:function(t,e,r){var n=this;this.dataNames.push(t);var o=l("li",e?"active":"").child(t);o.on("click",(function(){n.clickSwap2(o)})).on("contextmenu",(function(t){if("read"!==r.mode){var e=t.target,i=e.offsetLeft,c=e.offsetHeight;n.contextMenu.setOffset({left:i,bottom:c+1}),n.deleteEl=o}})).on("dblclick",(function(){if("read"!==r.mode){var t=o.html(),e=new nh("auto","");e.val(t),e.input.on("blur",(function(e){var r=e.target.value,o=n.dataNames.findIndex((function(e){return e===t}));n.renameItem(o,r)})),o.html("").child(e.el),e.focus()}})),e&&this.clickSwap(o),this.items.push(o),this.menuEl.child(o),this.moreEl.reset(this.dataNames)}},{key:"renameItem",value:function(t,e){this.dataNames.splice(t,1,e),this.moreEl.reset(this.dataNames),this.items[t].html("").child(e),this.updateFunc(t,e)}},{key:"clear",value:function(){var t=this;this.items.forEach((function(e){t.menuEl.removeChild(e.el)})),this.items=[],this.dataNames=[],this.moreEl.reset(this.dataNames)}},{key:"deleteItem",value:function(){var t=this.activeEl,e=this.deleteEl;if(this.items.length>1){var r=this.items.findIndex((function(t){return t===e}));if(this.items.splice(r,1),this.dataNames.splice(r,1),this.menuEl.removeChild(e.el),this.moreEl.reset(this.dataNames),t===e){var n=sp(this.items,1)[0];return this.activeEl=n,this.activeEl.toggle(),[r,0]}return[r,-1]}return[-1]}},{key:"clickSwap2",value:function(t){var e=this.items.findIndex((function(e){return e===t}));this.clickSwap(t),this.activeEl.toggle(),this.swapFunc(e)}},{key:"clickSwap",value:function(t){null!==this.activeEl&&this.activeEl.toggle(),this.activeEl=t}}]),t}();r(3);function _p(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null==r)return;var n,o,i=[],c=!0,a=!1;try{for(r=r.call(t);!(c=(n=r.next()).done)&&(i.push(n.value),!e||i.length!==e);c=!0);}catch(t){a=!0,o=t}finally{try{c||null==r.return||r.return()}finally{if(a)throw o}}return i}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return Rp(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Rp(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Rp(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function Tp(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function Cp(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?Tp(Object(r),!0).forEach((function(e){Ap(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Tp(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function Ap(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Ip(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Dp(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var Bp=function(){function t(e){var r=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Ip(this,t);var o=e;this.options=Cp({showBottomBar:!0},n),this.sheetIndex=1,this.datas=[],"string"==typeof e&&(o=document.querySelector(e)),this.bottombar=this.options.showBottomBar?new Pp((function(){if("read"!==r.options.mode){var t=r.addSheet();r.sheet.resetData(t)}}),(function(t){var e=r.datas[t];r.sheet.resetData(e)}),(function(){r.deleteSheet()}),(function(t,e){r.datas[t].name=e,r.sheet.trigger("change")})):null,this.data=this.addSheet();var i=l("div","".concat(Wt)).on("contextmenu",(function(t){return t.preventDefault()}));o.appendChild(i.el),this.sheet=new up(i,this.data),null!==this.bottombar&&i.child(this.bottombar.el)}var e,r,n;return e=t,n=[{key:"locale",value:function(t,e){nt(t,e)}}],(r=[{key:"addSheet",value:function(t){var e=this,r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=t||"sheet".concat(this.sheetIndex),o=new Tt(n,this.options);return o.change=function(){for(var t,r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];(t=e.sheet).trigger.apply(t,["change"].concat(n))},this.datas.push(o),null!==this.bottombar&&this.bottombar.addItem(n,r,this.options),this.sheetIndex+=1,o}},{key:"deleteSheet",value:function(){if(null!==this.bottombar){var t=_p(this.bottombar.deleteItem(),2),e=t[0],r=t[1];e>=0&&(this.datas.splice(e,1),r>=0&&this.sheet.resetData(this.datas[r]),this.sheet.trigger("change"))}}},{key:"loadData",value:function(t){var e=Array.isArray(t)?t:[t];if(null!==this.bottombar&&this.bottombar.clear(),this.datas=[],e.length>0)for(var r=0;r<e.length;r+=1){var n=e[r],o=this.addSheet(n.name,0===r);o.setData(n),0===r&&this.sheet.resetData(o)}return this}},{key:"getData",value:function(){return this.datas.map((function(t){return t.getData()}))}},{key:"cellText",value:function(t,e,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return this.datas[n].setCellText(t,e,r,"finished"),this}},{key:"cell",value:function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return this.datas[r].getCell(t,e)}},{key:"cellStyle",value:function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return this.datas[r].getCellStyle(t,e)}},{key:"reRender",value:function(){return this.sheet.table.render(),this}},{key:"on",value:function(t,e){return this.sheet.on(t,e),this}},{key:"validate",value:function(){return this.data.validations.errors.size<=0}},{key:"onToolBar",value:function(t){return this.sheet.on("onToolBar",t),this}},{key:"change",value:function(t){return this.sheet.on("change",t),this}}])&&Dp(e.prototype,r),n&&Dp(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}(),zp=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new Bp(t,e)};window&&(window.x_spreadsheet=zp,window.x_spreadsheet.locale=function(t,e){return nt(t,e)});e.default=Bp}]);